     5	     *CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM0000.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74	      01  WS-FIELDS.
    75		  05  WS-STD-KEY-LEN			PIC S9(4) COMP VALUE 8.
    76		  05  WS-REC.
    77		      10  WS-USERID.
    78			  15  WS-USERID7		PIC X(7).
    79			  15  FILLER			PIC X(1).
    80		      10  WS-TYPE.
    81			  15  WS-REQUESTOR		PIC X.
    82			  15  WS-ADMIN			PIC X.
    83			  15  WS-APPROVER		PIC X.
    84			  15  WS-SERVICE		PIC X.
    85		      10  WS-UPDATEDBY			PIC X(8).
    86        01  WS-CURRENT-MAP  VALUE 'SM000'         PIC X(7).
    87	      01  WS-TIME				PIC 9(15) COMP-3.
    88	      01  WS-DATE				PIC 9(7).
    89	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    90	      01  WS-LENGTH				PIC S9(4) COMP.
    91	      01  WS-END				PIC X(15) VALUE
    92            'END PROCESSING'.
    93	      01  WS-ERRMSG.
    94		  05 WS-FIELD-REQ			PIC X(24) VALUE
    95               'OPTION FIELD IS REQUIRED'.
    96	      01  WS-MAPFAIL				PIC X(20) VALUE
    97            'MAPFAIL ERROR'.
    98	      01  WS-INVALID-TRNID			PIC X(15) VALUE
    99            'INVALID ACCESS'.
   100	      01  WS-INVALID-USER			PIC X(20) VALUE
   101            'INVALID USER ACCESS'.
   102	      01  WS-COMMAREA.
   103		  05 WS-PROG-STATE			PIC X(15).
   104		  05 WS-PGMID				PIC X(06).
   105		  05 USERID.
   106		     10  USERID7			PIC X(7).
   107		     10  FILLER 			PIC X(1).
   108		  05 USR-TYPE.
   109		     10 USR-REQUESTOR			PIC X.
   110		     10 USR-ADMIN			PIC X.
   111		     10 USR-APPROVER			PIC X.
   112		     10 USR-SERVICE			PIC X.
   113		  05 WS-STATE				PIC X.
   114	      77 WS-RETNCODE				PIC S9(8) COMP.
   115		  COPY SM000.
   117	     * SYMBOLIC MAP of SM000 Created by CACXBMS Version 6.0.27
   118	      01  SM00MI.
   119		  02  FILLER				     PIC X(12).
   120		  02  OPTN01L				     PIC S9(4) COMP.
   121		  02  OPTN01F				     PIC X.
   122		  02  FILLER REDEFINES OPTN01F.
   123		      03  OPTN01A			     PIC X.
   124		  02  OPTN01I				     PIC X(020).   125		  02  OPTN02L				     PIC S9(4) COMP.
   126		  02  OPTN02F				     PIC X.
   127		  02  FILLER REDEFINES OPTN02F.
   128		      03  OPTN02A			     PIC X.
   129		  02  OPTN02I				     PIC X(020).
   130		  02  OPTN03L				     PIC S9(4) COMP.
   131		  02  OPTN03F				     PIC X.
   132		  02  FILLER REDEFINES OPTN03F.
   133		      03  OPTN03A			     PIC X.
   134		  02  OPTN03I				     PIC X(020).
   135		  02  OPTN04L				     PIC S9(4) COMP.
   136		  02  OPTN04F				     PIC X.
   137		  02  FILLER REDEFINES OPTN04F.
   138		      03  OPTN04A			     PIC X.
   139		  02  OPTN04I				     PIC X(020).
   140		  02  OPTN05L				     PIC S9(4) COMP.
   141		  02  OPTN05F				     PIC X.
   142		  02  FILLER REDEFINES OPTN05F.
   143		      03  OPTN05A			     PIC X.
   144		  02  OPTN05I				     PIC X(020).
   145		  02  OPTN06L				     PIC S9(4) COMP.
   146		  02  OPTN06F				     PIC X.
   147		  02  FILLER REDEFINES OPTN06F.
   148		      03  OPTN06A			     PIC X.
   149		  02  OPTN06I				     PIC X(020).
   150		  02  OPTN07L				     PIC S9(4) COMP.
   151		  02  OPTN07F				     PIC X.
   152		  02  FILLER REDEFINES OPTN07F.
   153		      03  OPTN07A			     PIC X.
   154		  02  OPTN07I				     PIC X(020).
   155		  02  OPTIONL				     PIC S9(4) COMP.
   156		  02  OPTIONF				     PIC X.
   157		  02  FILLER REDEFINES OPTIONF.
   158		      03  OPTIONA			     PIC X.
   159		  02  OPTIONI				     PIC X(001).
   160		  02  TICKETL				     PIC S9(4) COMP.
   161		  02  TICKETF				     PIC X.
   162		  02  FILLER REDEFINES TICKETF.
   163		      03  TICKETA			     PIC X.
   164		  02  TICKETI				     PIC X(001).
   165		  02  ERRMSGL				     PIC S9(4) COMP.
   166		  02  ERRMSGF				     PIC X.
   167		  02  FILLER REDEFINES ERRMSGF.
   168		      03  ERRMSGA			     PIC X.
   169		  02  ERRMSGI				     PIC X(071).
   170		  02  DATEL				     PIC S9(4) COMP.
   171		  02  DATEF				     PIC X.
   172		  02  FILLER REDEFINES DATEF.
   173		      03  DATEA 			     PIC X.
   174		  02  DATEI				     PIC X(010).
   175		  02  TIMEL				     PIC S9(4) COMP.
   176		  02  TIMEF				     PIC X.
   177		  02  FILLER REDEFINES TIMEF.
   178		      03  TIMEA 			     PIC X.
   179		  02  TIMEI				     PIC X(008).
   180	      01  SM00MO REDEFINES SM00MI.
   181		  02  FILLER				     PIC X(12).
   182		  02  FILLER				     PIC XX.
   183		  02  FILLER				     PIC X.
   184		  02  OPTN01O				     PIC X(020).   185		  02  FILLER				     PIC XX.
   186		  02  FILLER				     PIC X.
   187		  02  OPTN02O				     PIC X(020).
   188		  02  FILLER				     PIC XX.
   189		  02  FILLER				     PIC X.
   190		  02  OPTN03O				     PIC X(020).
   191		  02  FILLER				     PIC XX.
   192		  02  FILLER				     PIC X.
   193		  02  OPTN04O				     PIC X(020).
   194		  02  FILLER				     PIC XX.
   195		  02  FILLER				     PIC X.
   196		  02  OPTN05O				     PIC X(020).
   197		  02  FILLER				     PIC XX.
   198		  02  FILLER				     PIC X.
   199		  02  OPTN06O				     PIC X(020).
   200		  02  FILLER				     PIC XX.
   201		  02  FILLER				     PIC X.
   202		  02  OPTN07O				     PIC X(020).
   203		  02  FILLER				     PIC XX.
   204		  02  FILLER				     PIC X.
   205		  02  OPTIONO				     PIC X(001).
   206		  02  FILLER				     PIC XX.
   207		  02  FILLER				     PIC X.
   208		  02  TICKETO				     PIC X(001).
   209		  02  FILLER				     PIC XX.
   210		  02  FILLER				     PIC X.
   211		  02  ERRMSGO				     PIC X(071).
   212		  02  FILLER				     PIC XX.
   213		  02  FILLER				     PIC X.
   214		  02  DATEO				     PIC X(010).
   215		  02  FILLER				     PIC XX.
   216		  02  FILLER				     PIC X.
   217		  02  TIMEO				     PIC X(008).
   219		  COPY DFHAID.
   221	      01  DFHAID.
   222	     *
   223	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   224	     *
   225	     * Revision Information
   226	     * ^{File:dfhaid.cob  }
   227	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   228	     * ^{Revision:2.0}
   229	     *
   230	     *This is the AID constants copy file
   231	     *
   232            05  DFHENTER                  PIC X VALUE ''''.
   233	     *					value APOST
   234            05  DFHCLEAR                  PIC X VALUE '_'.
   235            05  DFHPA1                    PIC X VALUE '%'.
   236            05  DFHPA2                    PIC X VALUE '>'.
   237            05  DFHPA3                    PIC X VALUE ','.
   238            05  DFHPF1                    PIC X VALUE '1'.
   239            05  DFHPF2                    PIC X VALUE '2'.
   240            05  DFHPF3                    PIC X VALUE '3'.
   241            05  DFHPF4                    PIC X VALUE '4'.
   242            05  DFHPF5                    PIC X VALUE '5'.
   243            05  DFHPF6                    PIC X VALUE '6'.
   244            05  DFHPF7                    PIC X VALUE '7'.
   245            05  DFHPF8                    PIC X VALUE '8'.
   246            05  DFHPF9                    PIC X VALUE '9'.   247            05  DFHPF10                   PIC X VALUE ':'.
   248            05  DFHPF11                   PIC X VALUE '#'.
   249            05  DFHPF12                   PIC X VALUE '@'.
   250            05  DFHPF13                   PIC X VALUE 'A'.
   251            05  DFHPF14                   PIC X VALUE 'B'.
   252            05  DFHPF15                   PIC X VALUE 'C'.
   253            05  DFHPF16                   PIC X VALUE 'D'.
   254            05  DFHPF17                   PIC X VALUE 'E'.
   255            05  DFHPF18                   PIC X VALUE 'F'.
   256            05  DFHPF19                   PIC X VALUE 'G'.
   257            05  DFHPF20                   PIC X VALUE 'H'.
   258            05  DFHPF21                   PIC X VALUE 'I'.
   259            05  DFHPF22                   PIC X VALUE '›'.
   260       *                                  EBCDIC Cent sign x'4A'
   261       *                                  ASCII  Cent sign x'9B'
   262            05  DFHPF23                   PIC X VALUE '.'.
   263            05  DFHPF24                   PIC X VALUE '<'.
   264            05  DFHOPID                   PIC X VALUE 'W'.
   265            05  DFHMSRE                   PIC X VALUE 'X'.
   266            05  DFHTRIG                   PIC X VALUE '"'.
   267       *                                        value QUOTE  "
   268            05  DFHPEN                    PIC X VALUE '='.
   269            05  DFHCLRP                   PIC X VALUE 'Ý'.
   270       *                                  EBCDIC x'6A'
   271       *                                  ASCII  x'DD'
   272            05  DFHSTRF                   PIC X VALUE 'h'.
   273	     *	  DFHQUIT is a CA-Realia CICS Extension
   274	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   275            05  DFHQUIT                   PIC X VALUE '!'.
   276		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   278		  COPY DFHBMSCA.
   280	      01  DFHBMSCA.
   281	     *
   282	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   283	     *
   284	     * Revision Information
   285	     * ^{File:dfhbmsca.cob}
   286	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   287	     * ^{Revision:2.0}
   288	     *
   289	     *	Note:This FILE is provided with most values as quoted literals
   290	     *	     so that the file can be used for both ASCII and EBCDIC
   291	     *	     programs
   292	     *
   293	     *	     The only exceptions are some 3270 Data Stream Orders
   294	     *	     They use different Hexadecimal values for ASCII and
   295	     *	     EBCDIC and they cannot be expressed as quoted literals
   296	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   297	     *	     characters in ASCII
   298	     *
   299	     *	     They have their values set up to default to the EBCDIC
   300	     *	     values.
   301	     *
   302	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   303	     *	     and SEND TEXT with imbedded format orders.
   304	     *	     If you use these values in ASCII programs the values
   305	     *	     must be changed.
   306	     *
   307	     *	     An alternative is to use REPLACING to change the values.
   308	     *   309	     *	  i.e. COPY DFHBMSCA replacing
   310	     *			    ==005== BY ==009==	*> DFHPT
   311	     *			    ==021== BY ==010==	*> DFHNL
   312	     *			    ==040== BY ==021==	*> DFHSA
   313	     *			    ==041== BY ==031==	*> DFHSFE
   314	     *			    ==044== BY ==023==	*> DFHMF
   315	     *			    ==060== BY ==020==	*> DFHRA
   316	     *			    ==063== BY ==026==. *> DFHSUB
   317	     *
   318	     ******************************************************************
   319	     *BMS and Terminal Control - Order & Attributes constants	      *
   320	     ******************************************************************
   321	     *
   322	     *	  Field Attributes
   323	     *
   324            05  DFHBMASB                          PIC X VALUE '8'.
   325            05  DFHBMASF                          PIC X VALUE '1'.
   326            05  DFHBMASK                          PIC X VALUE '0'.
   327            05  DFHBMBRY                          PIC X VALUE 'H'.
   328            05  DFHBMDAR                          PIC X VALUE '<'.
   329            05  DFHBMFSE                          PIC X VALUE 'A'.
   330            05  DFHBMPRF                          PIC X VALUE '/'.
   331            05  DFHBMPRO                          PIC X VALUE '-'.
   332            05  DFHBMUNN                          PIC X VALUE '&'.
   333            05  DFHBMUNP                          PIC X VALUE ' '.
   334            05  DFHUNNUM                          PIC X VALUE 'J'.
   335	     *
   336	     *	  partially supported
   337	     *
   338            05  DFHUNNOD                          PIC X VALUE '('.
   339            05  DFHUNIMD                          PIC X VALUE 'I'.
   340            05  DFHUNINT                          PIC X VALUE 'R'.
   341            05  DFHUNNON                          PIC X VALUE '('.
   342            05  DFHPROTI                          PIC X VALUE 'Y'.
   343            05  DFHPROTN                          PIC X VALUE '%'.
   344	     *
   345	     *	  These values are additions to mainframe constants
   346	     *
   347            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   348            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   349            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   350	     *						      VALUE APOST
   351            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   352            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   353            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   354            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   355            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   356	     *
   357	     *	  Field Flag values
   358		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   359		  05  FILLER REDEFINES DFHBMEOF-VAL.
   360		      10  FILLER			PIC X.
   361		      10  DFHBMEOF			PIC X.
   362       *                                          x'80'.
   363		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   364		  05  FILLER REDEFINES DFHBMCUR-VAL.
   365		      10  FILLER			PIC X.
   366		      10  DFHBMCUR			PIC X.
   367       *                                          x'02'.
   368		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.   369		  05  FILLER REDEFINES DFHBMMEC-VAL.
   370		      10  FILLER			PIC X.
   371		      10  DFHBMMEC			PIC X.
   372       *                                          x'82'.
   373       *                                          x'02'.
   374		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   375		      88  DFHERASE			VALUES 128 130.
   376       *                                          x'80' X'82'
   377		      88  DFHCURSR			VALUES 002 130.
   378       *                                          x'02' X'82'
   379		  05  FILLER REDEFINES DFHBMFLG-VAL.
   380		      10  FILLER			PIC X.
   381		      10  DFHBMFLG			PIC X.
   382
   383		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   384		  05  FILLER REDEFINES DFHBMDUP-VAL.
   385		      10  FILLER			PIC X.
   386		      10  DFHBMDUP			PIC X.
   387       *                                              x'1C'
   388	     *
   389	     ******************************************************************
   390	     *	  supported 327X Extended Attributes
   391	     *
   392	     *	  Extended COLOR Attributes
   393	     *
   394            05  DFHDFCOL                          PIC X VALUE '0'.
   395            05  DFHBLUE                           PIC X VALUE '1'.
   396            05  DFHRED                            PIC X VALUE '2'.
   397            05  DFHPINK                           PIC X VALUE '3'.
   398            05  DFHGREEN                          PIC X VALUE '4'.
   399            05  DFHTURQ                           PIC X VALUE '5'.
   400            05  DFHYELLO                          PIC X VALUE '6'.
   401            05  DFHNEUTR                          PIC X VALUE '7'.
   402	     *
   403	     *	  Extended HILIGHT Attributes
   404	     *
   405            05  DFHDFHI                           PIC X VALUE '0'.
   406            05  DFHBLINK                          PIC X VALUE '1'.
   407            05  DFHREVRS                          PIC X VALUE '2'.
   408            05  DFHUNDLN                          PIC X VALUE '4'.
   409	     *
   410	     ******************************************************************
   411	     *	  supported 327X Data Stream Orders
   412	     *
   413		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   414		  05  FILLER REDEFINES DFHSBA-VAL.
   415		      10  FILLER			PIC X.
   416		      10  DFHSBA			PIC X.
   417       *                                              x'11'
   418		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   419		  05  FILLER REDEFINES DFHEUA-VAL.
   420		      10  FILLER			PIC X.
   421		      10  DFHEUA			PIC X.
   422       *                                              x'12'
   423		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   424		  05  FILLER REDEFINES DFHIC-VAL.
   425		      10  FILLER			PIC X.
   426		      10  DFHIC 			PIC X.
   427       *                                              X'13'.
   428		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.   429		  05  FILLER REDEFINES DFHSF-VAL.
   430		      10  FILLER			PIC X.
   431		      10  DFHSF 			PIC X.
   432       *                                              X'1D'.
   433		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   434		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   435		      88 DFHPT-VAL-ASCII		VALUE 9.
   436		  05  FILLER REDEFINES DFHPT-VAL.
   437		      10  FILLER			PIC X.
   438		      10  DFHPT 			PIC X.
   439       *                                              EBCDIC X'05'.
   440       *                                              ASCII  X'09'.
   441		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   442		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   443		      88 DFHRA-VAL-ASCII		VALUE 20.
   444		  05  FILLER REDEFINES DFHRA-VAL.
   445		      10  FILLER			PIC X.
   446		      10  DFHRA 			PIC X.
   447       *                                              EBCDIC x'3C'
   448       *                                              ASCII  x'14'
   449		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   450		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   451		      88 DFHSFE-VAL-ASCII		VALUE 31.
   452		  05  FILLER REDEFINES DFHSFE-VAL.
   453		      10  FILLER			PIC X.
   454		      10  DFHSFE			PIC X.
   455       *                                              EBCDIC x'29'
   456       *                                              ASCII  x'1F'
   457		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   458		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   459		      88 DFHMF-VAL-ASCII		VALUE 23.
   460		  05  FILLER REDEFINES DFHMF-VAL.
   461		      10  FILLER			PIC X.
   462		      10  DFHMF 			PIC X.
   463       *                                              EBCDIC x'2C'
   464       *                                              ASCII  x'17'
   465	     *
   466	     ******************************************************************
   467	     *	  unsupported 327X Data Stream order codes
   468	     *
   469		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   470		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   471		      88 DFHSA-VAL-ASCII		VALUE 21.
   472		  05  FILLER REDEFINES DFHSA-VAL.
   473		      10  FILLER			PIC X.
   474		      10  DFHSA 			PIC X.
   475       *                                              EBCDIC x'28'
   476       *                                              ASCII  x'15'
   477		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   478		  05  FILLER REDEFINES DFHGE-VAL.
   479		      10  FILLER			PIC X.
   480		      10  DFHGE 			PIC X.
   481       *                                              X'08'.
   482	     *
   483	     ******************************************************************
   484	     *	  SFE and MF supported attribute types
   485	     *
   486            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   487       *                                              EBCDIC x'42'
   488       *                                              ASCII  x'83'   489            05  DFHHLT                            PIC X VALUE 'Ö'.
   490       *                                              EBCDIC x'41'
   491       *                                              ASCII  x'D6'
   492            05  DFH3270                           PIC X VALUE '{'.
   493	     *
   494	     *	  supported for SEND TEXT command and printer terminal
   495	     *
   496		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   497		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   498		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   499		  05  FILLER REDEFINES DFHBMPNL-VAL.
   500		      10  FILLER			PIC X.
   501		      10  DFHBMPNL			PIC X.
   502       *                                              EBCDIC X'15'.
   503       *                                              ASCII  X'0A'.
   504	     *
   505	     ******************************************************************
   506	     *	  Printer terminal data stream only
   507	     *
   508		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   509		  05  FILLER REDEFINES DFHBMPFF-VAL.
   510		      10  FILLER			PIC X.
   511		      10  DFHBMPFF			PIC X.
   512       *                                              X'0C'.
   513		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   514		  05  FILLER REDEFINES DFHBMPCR-VAL.
   515		      10  FILLER			PIC X.
   516		      10  DFHBMPCR			PIC X.
   517       *                                              X'0D'.
   518		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   519		  05  FILLER REDEFINES DFHBMPEM-VAL.
   520		      10  FILLER			PIC X.
   521		      10  DFHBMPEM			PIC X.
   522       *                                              X'19'.
   523	     *
   524	     ******************************************************************
   525	     *	  unsupported Miscellaneous attributes and constants
   526	     *
   527		  05  DFHALL				PIC X VALUE LOW-VALUES.
   528            05  DFHBASE                           PIC X VALUE '0'.
   529		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   530		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   531		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   532		      10  DFHBMPSO			PIC X.
   533       *                                              X'0E'.
   534		      10  DFHBMPSI			PIC X.
   535       *                                              X'0F'.
   536		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   537            05  DFHERROR                          PIC X VALUE '¶'.
   538       *                                              EBCDIC X'1A'.
   539       *                                              ASCII  X'B6'.
   540            05  DFHFIL                            PIC X VALUE '4'.
   541            05  DFHMENT                           PIC X VALUE '2'.
   542            05  DFHMET                            PIC X VALUE '3'.
   543            05  DFHMFE                            PIC X VALUE '6'.
   544            05  DFHMFET                           PIC X VALUE '7'.
   545            05  DFHMFT                            PIC X VALUE '5'.
   546            05  DFHMT                             PIC X VALUE '1'.
   547            05  DFHOUTLN                          PIC X VALUE 'B'.
   548            05  DFHPS                             PIC X VALUE '„'.   549       *                                              EBCDIC x'43'
   550       *                                              ASCII  x'84'
   551            05  DFHVAL                            PIC X VALUE 'A'.
   552	     *
   553		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   554		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   555		      88 DFHSUB-VAL-ASCII		VALUE 26.
   556		  05  FILLER REDEFINES DFHSUB-VAL.
   557		      10  FILLER			PIC X.
   558		      10  DFHSUB			PIC X.
   559       *                                              EBCDIC X'3F'.
   560       *                                              ASCII  X'1A'.
   561	     *
   562		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   563		  05  FILLER REDEFINES DFHFM-VAL.
   564		      10  FILLER			PIC X.
   565		      10  DFHFM 			PIC X.
   566       *                                              EBCDIC X'1E'.
   567		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   569
   570	      LINKAGE SECTION.
   572	      01  DFHEIBLK.						       R
   573		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   574		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   575		  05 EIBTRNID PIC X(4). 				       R
   576		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   577		  05 EIBTRMID PIC X(4). 				       R
   578		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   579		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   580		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   581		  05 EIBAID   PIC X.					       R
   582		  05 EIBFN    PIC X(2). 				       R
   583		  05 EIBRCODE PIC X(6). 				       R
   584		  05 EIBDS    PIC X(8). 				       R
   585		  05 EIBREQID PIC X(8). 				       R
   586		  05 EIBRSRCE PIC X(8). 				       R
   587		  05 EIBSYNC  PIC X.					       R
   588		  05 EIBFREE  PIC X.					       R
   589		  05 EIBRECV  PIC X.					       R
   590		  05 EIBSEND  PIC X.					       R
   591		  05 EIBATT   PIC X.					       R
   592		  05 EIBEOC   PIC X.					       R
   593		  05 EIBFMH   PIC X.					       R
   594		  05 EIBCOMPL PIC X.					       R
   595		  05 EIBSIG   PIC X.					       R
   596		  05 EIBCONF  PIC X.					       R
   597		  05 EIBERR   PIC X.					       R
   598		  05 EIBERRCD PIC X(4). 				       R
   599		  05 EIBSYNRB PIC X.					       R
   600		  05 EIBNODAT PIC X.					       R
   601		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   602		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   603		  05 EIBRLDBK PIC X.					       R
   604		  05 EIBCARESERVED PIC X(32).				       R
   606	      01  DFHCOMMAREA				PIC X(50).
   607	     *
   608	      PROCEDURE DIVISION					       R
   610		  USING DFHEIBLK DFHCOMMAREA.				       R
   635	      100-PROCESS.
   637		  EXEC CICS IGNORE CONDITION   638			    ERROR
   639		  END-EXEC
   654		  PERFORM 300-VERIFY-USER
   655
   656            IF EIBTRNID = 'SM00'
   657		     MOVE DFHCOMMAREA TO WS-COMMAREA
   658               MOVE 'SM0000' TO WS-PGMID
   659		     MOVE WS-TYPE TO USR-TYPE
   660		     MOVE WS-USERID TO USERID
   661		     IF EIBCALEN NOT = +0
   662			PERFORM 200-REC-MAP
   663		     ELSE
   664                  MOVE 'ENTER OPTION AND PRESS ENTER' TO ERRMSGO
   665			PERFORM 110-VERIFY-ROLE
   666		     END-IF
   667		  ELSE
   668		     MOVE SPACES TO ERRMSGO
   670		     EXEC CICS SEND TEXT
   671			     FROM (WS-INVALID-TRNID)
   672			     LENGTH (+15)
   673			     ERASE
   674			END-EXEC
   705		     EXEC CICS RETURN
   706		     END-EXEC
   719		  END-IF.
   720	      100-EXIT.
   721		  EXIT.
   722
   723	      110-VERIFY-ROLE.
   724		  EVALUATE WS-TYPE
   725            WHEN 'YYYY'
   726            WHEN 'YYYN'
   727		       PERFORM 111-NEW-MAP
   728            WHEN 'YNNN'
   729            WHEN 'YNNY'
   730                 MOVE '5 - CANCEL TICKET' TO OPTN05I
   731		       MOVE SPACE TO OPTN06I
   732		       MOVE SPACES TO OPTN07I
   733		       PERFORM 111-NEW-MAP
   734            WHEN 'YYNN'
   735            WHEN 'YYNY'
   736                 MOVE '5 - CANCEL TICKET' TO OPTN05I
   737                 MOVE '6 - USER MAINTENANCE' TO OPTN06I
   738		       MOVE SPACES TO OPTN07I
   739		       PERFORM 111-NEW-MAP
   740            WHEN 'YNYN'
   741            WHEN 'YNYY'
   742		       MOVE SPACES TO OPTN07I
   743		       PERFORM 111-NEW-MAP
   744            WHEN 'NYYY'
   745                 MOVE '2 - UPDATE TICKET' TO OPTN02I
   746                 MOVE '3 - APPROVE TICKET' TO OPTN03I
   747                 MOVE '4 - USER MAINTENANCE' TO OPTN04I
   748		       MOVE SPACES TO OPTN05I
   749		       MOVE SPACE TO OPTN06I
   750		       MOVE SPACES TO OPTN07I
   751		       PERFORM 111-NEW-MAP
   752            WHEN 'NNYY'
   753                 MOVE '2 - UPDATE TICKET' TO OPTN02I
   754                 MOVE '3 - APPROVE TICKET' TO OPTN03I   755		       MOVE SPACES TO OPTN04I
   756		       MOVE SPACES TO OPTN05I
   757		       MOVE SPACE TO OPTN06I
   758		       MOVE SPACES TO OPTN07I
   759		       PERFORM 111-NEW-MAP
   760            WHEN 'NNNY'
   761                 MOVE '2 - UPDATE TICKET' TO OPTN02I
   762		       MOVE SPACES TO OPTN03I
   763		       MOVE SPACES TO OPTN04I
   764		       MOVE SPACES TO OPTN05I
   765		       MOVE SPACE TO OPTN06I
   766		       MOVE SPACES TO OPTN07I
   767		       PERFORM 111-NEW-MAP
   768            WHEN 'NYNY'
   769                 MOVE '2 - UPDATE TICKET' TO OPTN02I
   770                 MOVE '3 - USER MAINTENANCE' TO OPTN03I
   771		       MOVE SPACES TO OPTN04I
   772		       MOVE SPACES TO OPTN05I
   773		       MOVE SPACE TO OPTN06I
   774		       MOVE SPACES TO OPTN07I
   775		       PERFORM 111-NEW-MAP
   776            WHEN 'NYYN'
   777                 MOVE '2 - APPROVE TICKET' TO OPTN02I
   778                 MOVE '3 - USER MAINTENANCE' TO OPTN03I
   779		       MOVE SPACES TO OPTN04I
   780		       MOVE SPACES TO OPTN05I
   781		       MOVE SPACE TO OPTN06I
   782		       MOVE SPACES TO OPTN07I
   783		       PERFORM 111-NEW-MAP
   784            WHEN 'NYNN'
   785                 MOVE '1 - USER MAINTENANCE' TO OPTN01I
   786		       MOVE SPACES TO OPTN02I
   787		       MOVE SPACES TO OPTN03I
   788		       MOVE SPACES TO OPTN04I
   789		       MOVE SPACES TO OPTN05I
   790		       MOVE SPACE TO OPTN06I
   791		       MOVE SPACES TO OPTN07I
   792		       PERFORM 111-NEW-MAP
   793            WHEN 'NNYN'
   794                 MOVE '2 - APPROVE TICKET' TO OPTN02I
   795		       MOVE SPACES TO OPTN03I
   796		       MOVE SPACES TO OPTN04I
   797		       MOVE SPACES TO OPTN05I
   798		       MOVE SPACE TO OPTN06I
   799		       MOVE SPACES TO OPTN07I
   800		       PERFORM 111-NEW-MAP
   801            WHEN 'NNNN'
   802		       MOVE SPACES TO OPTN01I
   803		       MOVE SPACES TO OPTN02I
   804		       MOVE SPACES TO OPTN03I
   805		       MOVE SPACES TO OPTN04I
   806		       MOVE SPACES TO OPTN05I
   807		       MOVE SPACE TO OPTN06I
   808		       MOVE SPACES TO OPTN07I
   809		       PERFORM 111-NEW-MAP
   810		  WHEN OTHER
   811		       MOVE SPACES TO ERRMSGO
   813		       EXEC CICS SEND TEXT
   814			    FROM (WS-INVALID-TRNID)
   815			    LENGTH (+15)   816			    ERASE
   817		       END-EXEC
   848		       EXEC CICS RETURN
   849		       END-EXEC
   862		  END-EVALUATE.
   863	      110-EXIT.
   864		  EXIT.
   865
   866	      112-DATE-TIME.
   867		  MOVE EIBDATE TO WS-DATE.
   868		  MOVE WS-DATE-X TO DATEO.
   870		  EXEC CICS ASKTIME
   871		       ABSTIME	  (WS-TIME)
   872		  END-EXEC
   891		  EXEC CICS FORMATTIME
   892		       ABSTIME	  (WS-TIME)
   893                 DATESEP    ('-')
   894		       MMDDYYYY   (DATEO)
   895		       TIME	  (TIMEO)
   896                 TIMESEP    (':')
   897		  END-EXEC
   937		  MOVE DFHBMASB TO TIMEA
   938		  MOVE DFHBMASB TO DATEA.
   939	      112-EXIT.
   940		  EXIT.
   941
   942	      111-NEW-MAP.
   943		  PERFORM 112-DATE-TIME
   944
   945		  MOVE DFHUNIMD TO OPTIONA
   946		  MOVE DFHUNIMD TO TICKETA
   947		  MOVE -1	TO OPTIONL
   948		  MOVE LENGTH OF SM00MO TO WS-LENGTH
   950		  EXEC CICS SEND
   951                 MAP('SM00M')
   952                 MAPSET('SM000')
   953		       FROM(SM00MO)
   954		       LENGTH(WS-LENGTH)
   955		       CURSOR
   956		       ERASE
   957		  END-EXEC
  1003		  EXEC CICS RETURN
  1004		       TRANSID(EIBTRNID)
  1005		       COMMAREA(WS-COMMAREA)
  1006		  END-EXEC.
  1031	      110-EXIT.
  1032		  EXIT.
  1033
  1034	      200-REC-MAP.
  1036		  EXEC CICS RECEIVE
  1037                 MAP('SM00M')
  1038                 MAPSET('SM000')
  1039		       INTO (SM00MI)
  1040		  END-EXEC
  1074		  IF EIBRESP = DFHRESP(MAPFAIL)
  1076		  IF EIBRESP =	       036				       R
  1077		     MOVE WS-MAPFAIL TO ERRMSGO
  1078		     PERFORM 110-VERIFY-ROLE
  1079		  END-IF.
  1080		  PERFORM 400-CHECK-EIBAID.  1081	      200-EXIT.
  1082		  EXIT.
  1083
  1084	      21A-SEARCH-SM001.
  1085		  MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1087		  EXEC CICS XCTL
  1088                 PROGRAM('SM001')
  1089		       COMMAREA(WS-COMMAREA)
  1090		       LENGTH(WS-LENGTH)
  1091		  END-EXEC.
  1122	      21A-EXIT.
  1123		  EXIT.
  1124
  1125	      21B-SUBMIT-SM002.
  1127		  EXEC CICS LINK
  1128                 PROGRAM('SM002')
  1129		       COMMAREA(WS-COMMAREA)
  1130		       LENGTH(+15)
  1131		       RESP(WS-RETNCODE)
  1132		  END-EXEC
  1169		  MOVE WS-PROG-STATE TO ERRMSGO.
  1170	      21B-EXIT.
  1171		  EXIT.
  1172
  1173	      21C-UPDATE-SM003.
  1175		  EXEC CICS LINK
  1176                 PROGRAM('SM003')
  1177		       COMMAREA(WS-COMMAREA)
  1178		       LENGTH(+15)
  1179		       RESP(WS-RETNCODE)
  1180		  END-EXEC
  1217		  MOVE WS-PROG-STATE TO ERRMSGO.
  1218	      21C-EXIT.
  1219		  EXIT.
  1220
  1221	      21D-CLOSE-SM004.
  1223		  EXEC CICS LINK
  1224                 PROGRAM('SM004')
  1225		       COMMAREA(WS-COMMAREA)
  1226		       LENGTH(+15)
  1227		       RESP(WS-RETNCODE)
  1228		  END-EXEC
  1265		  MOVE WS-PROG-STATE TO ERRMSGO.
  1266	      21D-EXIT.
  1267		  EXIT.
  1268
  1269	      21E-APPROVE-SM005.
  1271		  EXEC CICS LINK
  1272                 PROGRAM('SM005')
  1273		       COMMAREA(WS-COMMAREA)
  1274		       LENGTH(+15)
  1275		       RESP(WS-RETNCODE)
  1276		  END-EXEC
  1313		  MOVE WS-PROG-STATE TO ERRMSGO.
  1314	      21R-EXIT.
  1315		  EXIT.
  1316
  1317	      21F-CANCEL-SM006.
  1319		  EXEC CICS LINK
  1320                 PROGRAM('SM006')  1321		       COMMAREA(WS-COMMAREA)
  1322		       LENGTH(+15)
  1323		       RESP(WS-RETNCODE)
  1324		  END-EXEC
  1361		  MOVE WS-PROG-STATE TO ERRMSGO.
  1362	      21F-EXIT.
  1363		  EXIT.
  1364
  1365	      21G-ADMIN-UA001.
  1367		  EXEC CICS LINK
  1368                 PROGRAM('UA001')
  1369		       COMMAREA(WS-COMMAREA)
  1370		       LENGTH(+15)
  1371		       RESP(WS-RETNCODE)
  1372		  END-EXEC
  1409		  MOVE WS-PROG-STATE TO ERRMSGO.
  1410	      21G-EXIT.
  1411		  EXIT.
  1412
  1413	      21H-F3-EXIT.
  1414		  MOVE SPACES TO ERRMSGO
  1416		  EXEC CICS SEND TEXT
  1417		       FROM (WS-END)
  1418		       LENGTH (+15)
  1419		       ERASE
  1420		  END-EXEC
  1451		  EXEC CICS RETURN
  1452		  END-EXEC.
  1466	      21H-EXIT.
  1467		  EXIT.
  1468
  1469	      300-VERIFY-USER SECTION.
  1471		  EXEC CICS ASSIGN
  1472		      USERID(WS-USERID)
  1473		  END-EXEC
  1492		  EXEC CICS
  1493                 READ FILE('uaf001')
  1494		       INTO (WS-REC)
  1495		       RIDFLD (WS-USERID)
  1496		       KEYLENGTH (WS-STD-KEY-LEN)
  1497		       EQUAL
  1498		  END-EXEC
  1537		  IF EIBRESP = DFHRESP(NOTFND)
  1539		  IF EIBRESP =	       013				       R
  1541		      EXEC CICS SEND TEXT
  1542			   FROM (WS-INVALID-USER)
  1543			   LENGTH (+20)
  1544			   ERASE
  1545		      END-EXEC
  1576		      EXEC CICS RETURN
  1577		      END-EXEC
  1590		  END-IF.
  1591	      300-EXIT.
  1592		  EXIT.
  1593
  1594	      400-CHECK-EIBAID.
  1595		  EVALUATE WS-TYPE
  1596            WHEN 'YYYY'
  1597            WHEN 'YYYN'
  1598		       EVALUATE EIBAID  1599		       WHEN DFHPF3
  1600			    PERFORM 21H-F3-EXIT
  1601		       WHEN DFHENTER
  1602			    EVALUATE OPTIONI
  1603			    WHEN 1
  1604				 PERFORM 21A-SEARCH-SM001
  1605			    WHEN 2
  1606				 PERFORM 21B-SUBMIT-SM002
  1607			    WHEN 3
  1608				 PERFORM 21C-UPDATE-SM003
  1609			    WHEN 4
  1610				 PERFORM 21D-CLOSE-SM004
  1611			    WHEN 5
  1612				 PERFORM 21E-APPROVE-SM005
  1613			    WHEN 6
  1614				 PERFORM 21F-CANCEL-SM006
  1615			    WHEN 7
  1616				 PERFORM 21G-ADMIN-UA001
  1617			    WHEN DFHNULL
  1618				 MOVE WS-FIELD-REQ TO ERRMSGO
  1619			    WHEN OTHER
  1620                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1621			    END-EVALUATE
  1622		       WHEN OTHER
  1623                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1624		       END-EVALUATE
  1625            WHEN 'YNNN'
  1626            WHEN 'YNNY'
  1627		       EVALUATE EIBAID
  1628		       WHEN DFHPF3
  1629			    PERFORM 21H-F3-EXIT
  1630		       WHEN DFHENTER
  1631			    EVALUATE OPTIONI
  1632			    WHEN 1
  1633				 PERFORM 21A-SEARCH-SM001
  1634			    WHEN 2
  1635				 PERFORM 21B-SUBMIT-SM002
  1636			    WHEN 3
  1637				 PERFORM 21C-UPDATE-SM003
  1638			    WHEN 4
  1639				 PERFORM 21D-CLOSE-SM004
  1640			    WHEN 5
  1641				 PERFORM 21F-CANCEL-SM006
  1642			    WHEN DFHNULL
  1643				 MOVE WS-FIELD-REQ TO ERRMSGO
  1644			    WHEN OTHER
  1645                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1646			    END-EVALUATE
  1647		       WHEN OTHER
  1648                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1649		       END-EVALUATE
  1650            WHEN 'YYNN'
  1651            WHEN 'YYNY'
  1652		       EVALUATE EIBAID
  1653		       WHEN DFHPF3
  1654			    PERFORM 21H-F3-EXIT
  1655		       WHEN DFHENTER
  1656			    EVALUATE OPTIONI
  1657			    WHEN 1
  1658				 PERFORM 21A-SEARCH-SM001  1659			    WHEN 2
  1660				 PERFORM 21B-SUBMIT-SM002
  1661			    WHEN 3
  1662				 PERFORM 21C-UPDATE-SM003
  1663			    WHEN 4
  1664				 PERFORM 21D-CLOSE-SM004
  1665			    WHEN 5
  1666				 PERFORM 21F-CANCEL-SM006
  1667			    WHEN 6
  1668				 PERFORM 21G-ADMIN-UA001
  1669			    WHEN DFHNULL
  1670				 MOVE WS-FIELD-REQ TO ERRMSGO
  1671			    WHEN OTHER
  1672                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1673			    END-EVALUATE
  1674		       WHEN OTHER
  1675                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1676		       END-EVALUATE
  1677            WHEN 'YNYN'
  1678            WHEN 'YNYY'
  1679		       EVALUATE EIBAID
  1680		       WHEN DFHPF3
  1681			    PERFORM 21H-F3-EXIT
  1682		       WHEN DFHENTER
  1683			    EVALUATE OPTIONI
  1684			    WHEN 1
  1685				 PERFORM 21A-SEARCH-SM001
  1686			    WHEN 2
  1687				 PERFORM 21B-SUBMIT-SM002
  1688			    WHEN 3
  1689				 PERFORM 21C-UPDATE-SM003
  1690			    WHEN 4
  1691				 PERFORM 21D-CLOSE-SM004
  1692			    WHEN 5
  1693				 PERFORM 21E-APPROVE-SM005
  1694			    WHEN 6
  1695				 PERFORM 21F-CANCEL-SM006
  1696			    WHEN DFHNULL
  1697				 MOVE WS-FIELD-REQ TO ERRMSGO
  1698			    WHEN OTHER
  1699                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1700			    END-EVALUATE
  1701		       WHEN OTHER
  1702                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1703		       END-EVALUATE
  1704            WHEN 'NYYY'
  1705		       EVALUATE EIBAID
  1706		       WHEN DFHPF3
  1707			    PERFORM 21H-F3-EXIT
  1708		       WHEN DFHENTER
  1709			    EVALUATE OPTIONI
  1710			    WHEN 1
  1711				 PERFORM 21A-SEARCH-SM001
  1712			    WHEN 2
  1713				 PERFORM 21C-UPDATE-SM003
  1714			    WHEN 3
  1715				 PERFORM 21E-APPROVE-SM005
  1716			    WHEN 4
  1717				 PERFORM 21G-ADMIN-UA001
  1718			    WHEN DFHNULL  1719				 MOVE WS-FIELD-REQ TO ERRMSGO
  1720			    WHEN OTHER
  1721                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1722			    END-EVALUATE
  1723		       WHEN OTHER
  1724                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1725		       END-EVALUATE
  1726            WHEN 'NNYY'
  1727		       EVALUATE EIBAID
  1728		       WHEN DFHPF3
  1729			    PERFORM 21H-F3-EXIT
  1730		       WHEN DFHENTER
  1731			    EVALUATE OPTIONI
  1732			    WHEN 1
  1733				 PERFORM 21A-SEARCH-SM001
  1734			    WHEN 2
  1735				 PERFORM 21C-UPDATE-SM003
  1736			    WHEN 3
  1737				 PERFORM 21E-APPROVE-SM005
  1738			    WHEN DFHNULL
  1739				 MOVE WS-FIELD-REQ TO ERRMSGO
  1740			    WHEN OTHER
  1741                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1742			    END-EVALUATE
  1743		       WHEN OTHER
  1744                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1745		       END-EVALUATE
  1746            WHEN 'NNNY'
  1747			EVALUATE EIBAID
  1748		       WHEN DFHPF3
  1749			    PERFORM 21H-F3-EXIT
  1750		       WHEN DFHENTER
  1751			    EVALUATE OPTIONI
  1752			    WHEN 1
  1753				 PERFORM 21A-SEARCH-SM001
  1754			    WHEN 2
  1755				 PERFORM 21C-UPDATE-SM003
  1756			    WHEN DFHNULL
  1757				 MOVE WS-FIELD-REQ TO ERRMSGO
  1758			    WHEN OTHER
  1759                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1760			    END-EVALUATE
  1761		       WHEN OTHER
  1762                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1763		       END-EVALUATE
  1764            WHEN 'NYNY'
  1765		       EVALUATE EIBAID
  1766		       WHEN DFHPF3
  1767			    PERFORM 21H-F3-EXIT
  1768		       WHEN DFHENTER
  1769			    EVALUATE OPTIONI
  1770			    WHEN 1
  1771				 PERFORM 21A-SEARCH-SM001
  1772			    WHEN 2
  1773				 PERFORM 21C-UPDATE-SM003
  1774			    WHEN 3
  1775				 PERFORM 21G-ADMIN-UA001
  1776			    WHEN DFHNULL
  1777				 MOVE WS-FIELD-REQ TO ERRMSGO
  1778			    WHEN OTHER  1779                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1780			    END-EVALUATE
  1781		       WHEN OTHER
  1782                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1783		       END-EVALUATE
  1784            WHEN 'NYYN'
  1785		       EVALUATE EIBAID
  1786		       WHEN DFHPF3
  1787			    PERFORM 21H-F3-EXIT
  1788		       WHEN DFHENTER
  1789			    EVALUATE OPTIONI
  1790			    WHEN 1
  1791				 PERFORM 21A-SEARCH-SM001
  1792			    WHEN 2
  1793				 PERFORM 21E-APPROVE-SM005
  1794			    WHEN 3
  1795				 PERFORM 21G-ADMIN-UA001
  1796			    WHEN DFHNULL
  1797				 MOVE WS-FIELD-REQ TO ERRMSGO
  1798			    WHEN OTHER
  1799                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1800			    END-EVALUATE
  1801		       WHEN OTHER
  1802                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1803		       END-EVALUATE
  1804            WHEN 'NYNN'
  1805		       EVALUATE EIBAID
  1806		       WHEN DFHPF3
  1807			    PERFORM 21H-F3-EXIT
  1808		       WHEN DFHENTER
  1809			    EVALUATE OPTIONI
  1810			    WHEN 1
  1811				 PERFORM 21G-ADMIN-UA001
  1812			    WHEN DFHNULL
  1813				 MOVE WS-FIELD-REQ TO ERRMSGO
  1814			    WHEN OTHER
  1815                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1816			    END-EVALUATE
  1817		       WHEN OTHER
  1818                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1819		       END-EVALUATE
  1820            WHEN 'NNYN'
  1821		       EVALUATE EIBAID
  1822		       WHEN DFHPF3
  1823			    PERFORM 21H-F3-EXIT
  1824		       WHEN DFHENTER
  1825			    EVALUATE OPTIONI
  1826			    WHEN 1
  1827				 PERFORM 21A-SEARCH-SM001
  1828			    WHEN 2
  1829				 PERFORM 21E-APPROVE-SM005
  1830			    WHEN DFHNULL
  1831				 MOVE WS-FIELD-REQ TO ERRMSGO
  1832			    WHEN OTHER
  1833                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1834			    END-EVALUATE
  1835		       WHEN OTHER
  1836                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1837		       END-EVALUATE
  1838  1839            WHEN 'NNNN'
  1840		       EVALUATE EIBAID
  1841		       WHEN DFHPF3
  1842			    PERFORM 21H-F3-EXIT
  1843		       WHEN DFHENTER
  1844			    EVALUATE TRUE
  1845			    WHEN OPTIONI NOT = SPACES
  1846			    WHEN OPTIONI NOT = LOW-VALUES
  1847                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1848			    END-EVALUATE
  1849		       WHEN OTHER
  1850                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1851		       END-EVALUATE
  1852		  WHEN OTHER
  1853		       MOVE SPACES TO ERRMSGO
  1855		       EXEC CICS SEND TEXT
  1856			    FROM (WS-INVALID-TRNID)
  1857			    LENGTH (+15)
  1858			    ERASE
  1859		       END-EXEC
  1890		       EXEC CICS RETURN
  1891		       END-EXEC
  1904		  END-EVALUATE.
  1905	      400-EXIT.
  1906		  EXIT.
  1907CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\SM0000.cic	       PAGE   20



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    1918
			Compilation time (mm:ss.ss):  0:00.54
			Compilation speed (lines/minute): 13111

			Compilation date (yy/mm/dd): 23/11/14
			     Time of day (hh:mm:ss): 20:30:46