     5	     *	CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM002.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74        01  WS-CURRENT-MAP  VALUE 'SM002M'        PIC X(7).
    75	      01  WS-TIME				PIC 9(15).
    76	      01  WS-DATE				PIC 9(7).
    77	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    78	      01  WS-LENGTH				PIC S9(4) COMP.
    79	      01  WS-END				PIC X(15) VALUE
    80            'INVALID ACCESS'.
    81	      77 WS-RETNCODE				PIC S9(8) COMP.
    82	      77 TICKETADD				PIC 9(06).
    83        77 REQUESTOR                              PIC X(01) VALUE 'Y'.
    84
    85	      01  TICKET.
    86		  05 TICKET-KEY 			PIC X(07).
    87		  05 TICKET-KEY-NUM REDEFINES TICKET-KEY PIC 9(06).
    88		  05 TICKET-REQUESTOR			PIC X(8).
    89		  05 TICKET-STATUS			PIC X(10).
    90		  05 TICKET-TITLE			PIC X(25).
    91		  05 TICKET-DESCRIPTION 		PIC X(100).
    92		  05 TICKET-LAST-UPDATE 		PIC X(20).
    93		  05 TICKET-LAST-UPDATE-BY		PIC X(8).
    94		  05 TICKET-UPDATE-REMARKS		PIC X(50).
    95
    96	      01  NEW-TICKET.
    97		  05 NEW-TICKET-KEY			PIC X(07).
    98		  05 NEW-TICKET-KEY-NUM REDEFINES NEW-TICKET-KEY PIC 9(07).
    99		  05 NEW-TICKET-REQUESTOR		PIC X(08).
   100		  05 NEW-TICKET-STATUS			PIC X(10) VALUE
   101               'CREATED'.
   102		  05 NEW-TICKET-TITLE			PIC X(25).
   103		  05 NEW-TICKET-DESCRIPTION		PIC X(100).
   104		  05 NEW-TICKET-LAST-UPDATE		PIC X(20) VALUE SPACE.
   105		  05 NEW-TICKET-LAST-UPDATE-BY		PIC X(08) VALUE SPACE.
   106		  05 NEW-TICKET-UPDATE-REMARKS		PIC X(50) VALUE SPACE.
   107
   108	      01  WS-LOG.
   109		  05 WS-LOG-TICKET-ID	       PIC X(07).
   110		  05 WS-LOG-SEQ-NUMBER	       PIC 9(03) VALUE 1.
   111		  05 WS-LOG-LAST-UPDATE        PIC X(20) VALUE SPACE.
   112		  05 WS-LOG-LAST-UPDATE-BY     PIC X(08) VALUE SPACE.
   113		  05 WS-LOG-UPDATE-REMARKS     PIC X(50) VALUE SPACE.
   114		  05 FILLER		       PIC X(02) VALUE SPACE.
   115
   116	      01  WS-ERRMSGS.
   117		  05 WS-INVALID-ACCESS			PIC X(15) VALUE
   118               'INVALID ACCESS'.
   119		  05 WS-INVALID-PGMID			PIC X(20) VALUE
   120               'INVALID USER ACCESS'.
   121		  05 WS-MAPFAIL 			PIC X(20) VALUE
   122               'MAPFAIL ERROR'.
   123		  05 WS-INVALID-TIX-ACC 		PIC X(34) VALUE   124               'INVALID ACCESS TO SELECTED TICKET'.
   125		  05 WS-FIELD-REQ			PIC X(24) VALUE
   126               'OPTION FIELD IS REQUIRED'.
   127		  05 WS-TITLE-REQUIRED		       PIC X(24) VALUE
   128               'TICKET TITLE IS REQUIRED'.
   129		  05 WS-LAST-PAGE			PIC X(21) VALUE
   130               'THIS IS THE LAST PAGE'.
   131		  05 WS-INVALID-VALUE			PIC X(46) VALUE
   132               'INVALID VALUE. PLEASE CORRECT HIGHLIGHT FIELDS'.
   133		  05 WS-INVALID-PFKEY			PIC X(21) VALUE
   134                'INAVLID PFKEY PRESSED'.
   135
   136	      01  WS-COMMAREA.
   137		  05 WS-PGMID				PIC X(06).
   138		  05 WS-STATE				PIC X.
   139		  05 WS-TICKET-PASSED			PIC X(07).
   140		  05 USERID.
   141		     10  USERID7			PIC X(7).
   142		     10  FILLER 			PIC X(1).
   143		  05 USR-TYPE.
   144		    15 USR-REQUESTOR			PIC X.
   145		    15 USR-ADMIN			PIC X.
   146		    15 USR-APPROVER			PIC X.
   147		    15 USR-SERVICE			PIC X.
   148		  05 WS-SM012-STATE			PIC X.
   149		  05 WS-SM012-PGMID			PIC X(06).
   150		  05 WS-FLAG				PIC X(01).
   151		  05 WS-HOLDER.
   152		     10 WS-ID			       PIC X(06).
   153		     10 WS-TITLE		       PIC X(25).
   154		     10 WS-DES1 		       PIC X(50).
   155		     10 WS-DES2 		       PIC X(50).
   156
   157	      COPY SM02S.
   159	     * SYMBOLIC MAP of SM02S Created by CACXBMS Version 6.0.27
   160	      01  SM002MI.
   161		  02  FILLER				     PIC X(12).
   162		  02  DATEL				     PIC S9(4) COMP.
   163		  02  DATEF				     PIC X.
   164		  02  FILLER REDEFINES DATEF.
   165		      03  DATEA 			     PIC X.
   166		  02  DATEI				     PIC X(010).
   167		  02  TIMEL				     PIC S9(4) COMP.
   168		  02  TIMEF				     PIC X.
   169		  02  FILLER REDEFINES TIMEF.
   170		      03  TIMEA 			     PIC X.
   171		  02  TIMEI				     PIC X(008).
   172		  02  IDL				     PIC S9(4) COMP.
   173		  02  IDF				     PIC X.
   174		  02  FILLER REDEFINES IDF.
   175		      03  IDA				     PIC X.
   176		  02  IDI				     PIC X(006).
   177		  02  TICKETTL				     PIC S9(4) COMP.
   178		  02  TICKETTF				     PIC X.
   179		  02  FILLER REDEFINES TICKETTF.
   180		      03  TICKETTA			     PIC X.
   181		  02  TICKETTI				     PIC X(025).
   182		  02  TICKTD1L				     PIC S9(4) COMP.
   183		  02  TICKTD1F				     PIC X.
   184		  02  FILLER REDEFINES TICKTD1F.   185		      03  TICKTD1A			     PIC X.
   186		  02  TICKTD1I				     PIC X(040).
   187		  02  TICKTD2L				     PIC S9(4) COMP.
   188		  02  TICKTD2F				     PIC X.
   189		  02  FILLER REDEFINES TICKTD2F.
   190		      03  TICKTD2A			     PIC X.
   191		  02  TICKTD2I				     PIC X(040).
   192		  02  STL				     PIC S9(4) COMP.
   193		  02  STF				     PIC X.
   194		  02  FILLER REDEFINES STF.
   195		      03  STA				     PIC X.
   196		  02  STI				     PIC X(020).
   197		  02  STATSL				     PIC S9(4) COMP.
   198		  02  STATSF				     PIC X.
   199		  02  FILLER REDEFINES STATSF.
   200		      03  STATSA			     PIC X.
   201		  02  STATSI				     PIC X(007).
   202		  02  UPML				     PIC S9(4) COMP.
   203		  02  UPMF				     PIC X.
   204		  02  FILLER REDEFINES UPMF.
   205		      03  UPMA				     PIC X.
   206		  02  UPMI				     PIC X(020).
   207		  02  UPR1L				     PIC S9(4) COMP.
   208		  02  UPR1F				     PIC X.
   209		  02  FILLER REDEFINES UPR1F.
   210		      03  UPR1A 			     PIC X.
   211		  02  UPR1I				     PIC X(025).
   212		  02  UPR2L				     PIC S9(4) COMP.
   213		  02  UPR2F				     PIC X.
   214		  02  FILLER REDEFINES UPR2F.
   215		      03  UPR2A 			     PIC X.
   216		  02  UPR2I				     PIC X(025).
   217		  02  UPDTL				     PIC S9(4) COMP.
   218		  02  UPDTF				     PIC X.
   219		  02  FILLER REDEFINES UPDTF.
   220		      03  UPDTA 			     PIC X.
   221		  02  UPDTI				     PIC X(020).
   222		  02  UPDATEL				     PIC S9(4) COMP.
   223		  02  UPDATEF				     PIC X.
   224		  02  FILLER REDEFINES UPDATEF.
   225		      03  UPDATEA			     PIC X.
   226		  02  UPDATEI				     PIC X(010).
   227		  02  UPTIMEL				     PIC S9(4) COMP.
   228		  02  UPTIMEF				     PIC X.
   229		  02  FILLER REDEFINES UPTIMEF.
   230		      03  UPTIMEA			     PIC X.
   231		  02  UPTIMEI				     PIC X(008).
   232		  02  UPBYL				     PIC S9(4) COMP.
   233		  02  UPBYF				     PIC X.
   234		  02  FILLER REDEFINES UPBYF.
   235		      03  UPBYA 			     PIC X.
   236		  02  UPBYI				     PIC X(020).
   237		  02  UPBL				     PIC S9(4) COMP.
   238		  02  UPBF				     PIC X.
   239		  02  FILLER REDEFINES UPBF.
   240		      03  UPBA				     PIC X.
   241		  02  UPBI				     PIC X(007).
   242		  02  ERRMSGL				     PIC S9(4) COMP.
   243		  02  ERRMSGF				     PIC X.
   244		  02  FILLER REDEFINES ERRMSGF.   245		      03  ERRMSGA			     PIC X.
   246		  02  ERRMSGI				     PIC X(058).
   247	      01  SM002MO REDEFINES SM002MI.
   248		  02  FILLER				     PIC X(12).
   249		  02  FILLER				     PIC XX.
   250		  02  FILLER				     PIC X.
   251		  02  DATEO				     PIC X(010).
   252		  02  FILLER				     PIC XX.
   253		  02  FILLER				     PIC X.
   254		  02  TIMEO				     PIC X(008).
   255		  02  FILLER				     PIC XX.
   256		  02  FILLER				     PIC X.
   257		  02  IDO				     PIC X(006).
   258		  02  FILLER				     PIC XX.
   259		  02  FILLER				     PIC X.
   260		  02  TICKETTO				     PIC X(025).
   261		  02  FILLER				     PIC XX.
   262		  02  FILLER				     PIC X.
   263		  02  TICKTD1O				     PIC X(040).
   264		  02  FILLER				     PIC XX.
   265		  02  FILLER				     PIC X.
   266		  02  TICKTD2O				     PIC X(040).
   267		  02  FILLER				     PIC XX.
   268		  02  FILLER				     PIC X.
   269		  02  STO				     PIC X(020).
   270		  02  FILLER				     PIC XX.
   271		  02  FILLER				     PIC X.
   272		  02  STATSO				     PIC X(007).
   273		  02  FILLER				     PIC XX.
   274		  02  FILLER				     PIC X.
   275		  02  UPMO				     PIC X(020).
   276		  02  FILLER				     PIC XX.
   277		  02  FILLER				     PIC X.
   278		  02  UPR1O				     PIC X(025).
   279		  02  FILLER				     PIC XX.
   280		  02  FILLER				     PIC X.
   281		  02  UPR2O				     PIC X(025).
   282		  02  FILLER				     PIC XX.
   283		  02  FILLER				     PIC X.
   284		  02  UPDTO				     PIC X(020).
   285		  02  FILLER				     PIC XX.
   286		  02  FILLER				     PIC X.
   287		  02  UPDATEO				     PIC X(010).
   288		  02  FILLER				     PIC XX.
   289		  02  FILLER				     PIC X.
   290		  02  UPTIMEO				     PIC X(008).
   291		  02  FILLER				     PIC XX.
   292		  02  FILLER				     PIC X.
   293		  02  UPBYO				     PIC X(020).
   294		  02  FILLER				     PIC XX.
   295		  02  FILLER				     PIC X.
   296		  02  UPBO				     PIC X(007).
   297		  02  FILLER				     PIC XX.
   298		  02  FILLER				     PIC X.
   299		  02  ERRMSGO				     PIC X(058).
   301	      COPY DFHAID.
   303	      01  DFHAID.
   304	     *
   305	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   306	     *   307	     * Revision Information
   308	     * ^{File:dfhaid.cob  }
   309	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   310	     * ^{Revision:2.0}
   311	     *
   312	     *This is the AID constants copy file
   313	     *
   314            05  DFHENTER                  PIC X VALUE ''''.
   315	     *					value APOST
   316            05  DFHCLEAR                  PIC X VALUE '_'.
   317            05  DFHPA1                    PIC X VALUE '%'.
   318            05  DFHPA2                    PIC X VALUE '>'.
   319            05  DFHPA3                    PIC X VALUE ','.
   320            05  DFHPF1                    PIC X VALUE '1'.
   321            05  DFHPF2                    PIC X VALUE '2'.
   322            05  DFHPF3                    PIC X VALUE '3'.
   323            05  DFHPF4                    PIC X VALUE '4'.
   324            05  DFHPF5                    PIC X VALUE '5'.
   325            05  DFHPF6                    PIC X VALUE '6'.
   326            05  DFHPF7                    PIC X VALUE '7'.
   327            05  DFHPF8                    PIC X VALUE '8'.
   328            05  DFHPF9                    PIC X VALUE '9'.
   329            05  DFHPF10                   PIC X VALUE ':'.
   330            05  DFHPF11                   PIC X VALUE '#'.
   331            05  DFHPF12                   PIC X VALUE '@'.
   332            05  DFHPF13                   PIC X VALUE 'A'.
   333            05  DFHPF14                   PIC X VALUE 'B'.
   334            05  DFHPF15                   PIC X VALUE 'C'.
   335            05  DFHPF16                   PIC X VALUE 'D'.
   336            05  DFHPF17                   PIC X VALUE 'E'.
   337            05  DFHPF18                   PIC X VALUE 'F'.
   338            05  DFHPF19                   PIC X VALUE 'G'.
   339            05  DFHPF20                   PIC X VALUE 'H'.
   340            05  DFHPF21                   PIC X VALUE 'I'.
   341            05  DFHPF22                   PIC X VALUE '›'.
   342       *                                  EBCDIC Cent sign x'4A'
   343       *                                  ASCII  Cent sign x'9B'
   344            05  DFHPF23                   PIC X VALUE '.'.
   345            05  DFHPF24                   PIC X VALUE '<'.
   346            05  DFHOPID                   PIC X VALUE 'W'.
   347            05  DFHMSRE                   PIC X VALUE 'X'.
   348            05  DFHTRIG                   PIC X VALUE '"'.
   349       *                                        value QUOTE  "
   350            05  DFHPEN                    PIC X VALUE '='.
   351            05  DFHCLRP                   PIC X VALUE 'Ý'.
   352       *                                  EBCDIC x'6A'
   353       *                                  ASCII  x'DD'
   354            05  DFHSTRF                   PIC X VALUE 'h'.
   355	     *	  DFHQUIT is a CA-Realia CICS Extension
   356	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   357            05  DFHQUIT                   PIC X VALUE '!'.
   358		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   360	      COPY DFHBMSCA.
   362	      01  DFHBMSCA.
   363	     *
   364	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   365	     *
   366	     * Revision Information
   367	     * ^{File:dfhbmsca.cob}
   368	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}   369	     * ^{Revision:2.0}
   370	     *
   371	     *	Note:This FILE is provided with most values as quoted literals
   372	     *	     so that the file can be used for both ASCII and EBCDIC
   373	     *	     programs
   374	     *
   375	     *	     The only exceptions are some 3270 Data Stream Orders
   376	     *	     They use different Hexadecimal values for ASCII and
   377	     *	     EBCDIC and they cannot be expressed as quoted literals
   378	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   379	     *	     characters in ASCII
   380	     *
   381	     *	     They have their values set up to default to the EBCDIC
   382	     *	     values.
   383	     *
   384	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   385	     *	     and SEND TEXT with imbedded format orders.
   386	     *	     If you use these values in ASCII programs the values
   387	     *	     must be changed.
   388	     *
   389	     *	     An alternative is to use REPLACING to change the values.
   390	     *
   391	     *	  i.e. COPY DFHBMSCA replacing
   392	     *			    ==005== BY ==009==	*> DFHPT
   393	     *			    ==021== BY ==010==	*> DFHNL
   394	     *			    ==040== BY ==021==	*> DFHSA
   395	     *			    ==041== BY ==031==	*> DFHSFE
   396	     *			    ==044== BY ==023==	*> DFHMF
   397	     *			    ==060== BY ==020==	*> DFHRA
   398	     *			    ==063== BY ==026==. *> DFHSUB
   399	     *
   400	     ******************************************************************
   401	     *BMS and Terminal Control - Order & Attributes constants	      *
   402	     ******************************************************************
   403	     *
   404	     *	  Field Attributes
   405	     *
   406            05  DFHBMASB                          PIC X VALUE '8'.
   407            05  DFHBMASF                          PIC X VALUE '1'.
   408            05  DFHBMASK                          PIC X VALUE '0'.
   409            05  DFHBMBRY                          PIC X VALUE 'H'.
   410            05  DFHBMDAR                          PIC X VALUE '<'.
   411            05  DFHBMFSE                          PIC X VALUE 'A'.
   412            05  DFHBMPRF                          PIC X VALUE '/'.
   413            05  DFHBMPRO                          PIC X VALUE '-'.
   414            05  DFHBMUNN                          PIC X VALUE '&'.
   415            05  DFHBMUNP                          PIC X VALUE ' '.
   416            05  DFHUNNUM                          PIC X VALUE 'J'.
   417	     *
   418	     *	  partially supported
   419	     *
   420            05  DFHUNNOD                          PIC X VALUE '('.
   421            05  DFHUNIMD                          PIC X VALUE 'I'.
   422            05  DFHUNINT                          PIC X VALUE 'R'.
   423            05  DFHUNNON                          PIC X VALUE '('.
   424            05  DFHPROTI                          PIC X VALUE 'Y'.
   425            05  DFHPROTN                          PIC X VALUE '%'.
   426	     *
   427	     *	  These values are additions to mainframe constants
   428	     *   429            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   430            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   431            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   432	     *						      VALUE APOST
   433            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   434            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   435            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   436            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   437            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   438	     *
   439	     *	  Field Flag values
   440		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   441		  05  FILLER REDEFINES DFHBMEOF-VAL.
   442		      10  FILLER			PIC X.
   443		      10  DFHBMEOF			PIC X.
   444       *                                          x'80'.
   445		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   446		  05  FILLER REDEFINES DFHBMCUR-VAL.
   447		      10  FILLER			PIC X.
   448		      10  DFHBMCUR			PIC X.
   449       *                                          x'02'.
   450		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   451		  05  FILLER REDEFINES DFHBMMEC-VAL.
   452		      10  FILLER			PIC X.
   453		      10  DFHBMMEC			PIC X.
   454       *                                          x'82'.
   455       *                                          x'02'.
   456		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   457		      88  DFHERASE			VALUES 128 130.
   458       *                                          x'80' X'82'
   459		      88  DFHCURSR			VALUES 002 130.
   460       *                                          x'02' X'82'
   461		  05  FILLER REDEFINES DFHBMFLG-VAL.
   462		      10  FILLER			PIC X.
   463		      10  DFHBMFLG			PIC X.
   464
   465		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   466		  05  FILLER REDEFINES DFHBMDUP-VAL.
   467		      10  FILLER			PIC X.
   468		      10  DFHBMDUP			PIC X.
   469       *                                              x'1C'
   470	     *
   471	     ******************************************************************
   472	     *	  supported 327X Extended Attributes
   473	     *
   474	     *	  Extended COLOR Attributes
   475	     *
   476            05  DFHDFCOL                          PIC X VALUE '0'.
   477            05  DFHBLUE                           PIC X VALUE '1'.
   478            05  DFHRED                            PIC X VALUE '2'.
   479            05  DFHPINK                           PIC X VALUE '3'.
   480            05  DFHGREEN                          PIC X VALUE '4'.
   481            05  DFHTURQ                           PIC X VALUE '5'.
   482            05  DFHYELLO                          PIC X VALUE '6'.
   483            05  DFHNEUTR                          PIC X VALUE '7'.
   484	     *
   485	     *	  Extended HILIGHT Attributes
   486	     *
   487            05  DFHDFHI                           PIC X VALUE '0'.
   488            05  DFHBLINK                          PIC X VALUE '1'.   489            05  DFHREVRS                          PIC X VALUE '2'.
   490            05  DFHUNDLN                          PIC X VALUE '4'.
   491	     *
   492	     ******************************************************************
   493	     *	  supported 327X Data Stream Orders
   494	     *
   495		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   496		  05  FILLER REDEFINES DFHSBA-VAL.
   497		      10  FILLER			PIC X.
   498		      10  DFHSBA			PIC X.
   499       *                                              x'11'
   500		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   501		  05  FILLER REDEFINES DFHEUA-VAL.
   502		      10  FILLER			PIC X.
   503		      10  DFHEUA			PIC X.
   504       *                                              x'12'
   505		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   506		  05  FILLER REDEFINES DFHIC-VAL.
   507		      10  FILLER			PIC X.
   508		      10  DFHIC 			PIC X.
   509       *                                              X'13'.
   510		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   511		  05  FILLER REDEFINES DFHSF-VAL.
   512		      10  FILLER			PIC X.
   513		      10  DFHSF 			PIC X.
   514       *                                              X'1D'.
   515		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   516		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   517		      88 DFHPT-VAL-ASCII		VALUE 9.
   518		  05  FILLER REDEFINES DFHPT-VAL.
   519		      10  FILLER			PIC X.
   520		      10  DFHPT 			PIC X.
   521       *                                              EBCDIC X'05'.
   522       *                                              ASCII  X'09'.
   523		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   524		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   525		      88 DFHRA-VAL-ASCII		VALUE 20.
   526		  05  FILLER REDEFINES DFHRA-VAL.
   527		      10  FILLER			PIC X.
   528		      10  DFHRA 			PIC X.
   529       *                                              EBCDIC x'3C'
   530       *                                              ASCII  x'14'
   531		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   532		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   533		      88 DFHSFE-VAL-ASCII		VALUE 31.
   534		  05  FILLER REDEFINES DFHSFE-VAL.
   535		      10  FILLER			PIC X.
   536		      10  DFHSFE			PIC X.
   537       *                                              EBCDIC x'29'
   538       *                                              ASCII  x'1F'
   539		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   540		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   541		      88 DFHMF-VAL-ASCII		VALUE 23.
   542		  05  FILLER REDEFINES DFHMF-VAL.
   543		      10  FILLER			PIC X.
   544		      10  DFHMF 			PIC X.
   545       *                                              EBCDIC x'2C'
   546       *                                              ASCII  x'17'
   547	     *
   548	     ******************************************************************   549	     *	  unsupported 327X Data Stream order codes
   550	     *
   551		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   552		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   553		      88 DFHSA-VAL-ASCII		VALUE 21.
   554		  05  FILLER REDEFINES DFHSA-VAL.
   555		      10  FILLER			PIC X.
   556		      10  DFHSA 			PIC X.
   557       *                                              EBCDIC x'28'
   558       *                                              ASCII  x'15'
   559		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   560		  05  FILLER REDEFINES DFHGE-VAL.
   561		      10  FILLER			PIC X.
   562		      10  DFHGE 			PIC X.
   563       *                                              X'08'.
   564	     *
   565	     ******************************************************************
   566	     *	  SFE and MF supported attribute types
   567	     *
   568            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   569       *                                              EBCDIC x'42'
   570       *                                              ASCII  x'83'
   571            05  DFHHLT                            PIC X VALUE 'Ö'.
   572       *                                              EBCDIC x'41'
   573       *                                              ASCII  x'D6'
   574            05  DFH3270                           PIC X VALUE '{'.
   575	     *
   576	     *	  supported for SEND TEXT command and printer terminal
   577	     *
   578		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   579		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   580		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   581		  05  FILLER REDEFINES DFHBMPNL-VAL.
   582		      10  FILLER			PIC X.
   583		      10  DFHBMPNL			PIC X.
   584       *                                              EBCDIC X'15'.
   585       *                                              ASCII  X'0A'.
   586	     *
   587	     ******************************************************************
   588	     *	  Printer terminal data stream only
   589	     *
   590		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   591		  05  FILLER REDEFINES DFHBMPFF-VAL.
   592		      10  FILLER			PIC X.
   593		      10  DFHBMPFF			PIC X.
   594       *                                              X'0C'.
   595		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   596		  05  FILLER REDEFINES DFHBMPCR-VAL.
   597		      10  FILLER			PIC X.
   598		      10  DFHBMPCR			PIC X.
   599       *                                              X'0D'.
   600		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   601		  05  FILLER REDEFINES DFHBMPEM-VAL.
   602		      10  FILLER			PIC X.
   603		      10  DFHBMPEM			PIC X.
   604       *                                              X'19'.
   605	     *
   606	     ******************************************************************
   607	     *	  unsupported Miscellaneous attributes and constants
   608	     *   609		  05  DFHALL				PIC X VALUE LOW-VALUES.
   610            05  DFHBASE                           PIC X VALUE '0'.
   611		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   612		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   613		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   614		      10  DFHBMPSO			PIC X.
   615       *                                              X'0E'.
   616		      10  DFHBMPSI			PIC X.
   617       *                                              X'0F'.
   618		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   619            05  DFHERROR                          PIC X VALUE '¶'.
   620       *                                              EBCDIC X'1A'.
   621       *                                              ASCII  X'B6'.
   622            05  DFHFIL                            PIC X VALUE '4'.
   623            05  DFHMENT                           PIC X VALUE '2'.
   624            05  DFHMET                            PIC X VALUE '3'.
   625            05  DFHMFE                            PIC X VALUE '6'.
   626            05  DFHMFET                           PIC X VALUE '7'.
   627            05  DFHMFT                            PIC X VALUE '5'.
   628            05  DFHMT                             PIC X VALUE '1'.
   629            05  DFHOUTLN                          PIC X VALUE 'B'.
   630            05  DFHPS                             PIC X VALUE '„'.
   631       *                                              EBCDIC x'43'
   632       *                                              ASCII  x'84'
   633            05  DFHVAL                            PIC X VALUE 'A'.
   634	     *
   635		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   636		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   637		      88 DFHSUB-VAL-ASCII		VALUE 26.
   638		  05  FILLER REDEFINES DFHSUB-VAL.
   639		      10  FILLER			PIC X.
   640		      10  DFHSUB			PIC X.
   641       *                                              EBCDIC X'3F'.
   642       *                                              ASCII  X'1A'.
   643	     *
   644		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   645		  05  FILLER REDEFINES DFHFM-VAL.
   646		      10  FILLER			PIC X.
   647		      10  DFHFM 			PIC X.
   648       *                                              EBCDIC X'1E'.
   649		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   651
   652	      LINKAGE SECTION.
   654	      01  DFHEIBLK.						       R
   655		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   656		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   657		  05 EIBTRNID PIC X(4). 				       R
   658		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   659		  05 EIBTRMID PIC X(4). 				       R
   660		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   661		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   662		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   663		  05 EIBAID   PIC X.					       R
   664		  05 EIBFN    PIC X(2). 				       R
   665		  05 EIBRCODE PIC X(6). 				       R
   666		  05 EIBDS    PIC X(8). 				       R
   667		  05 EIBREQID PIC X(8). 				       R
   668		  05 EIBRSRCE PIC X(8). 				       R
   669		  05 EIBSYNC  PIC X.					       R
   670		  05 EIBFREE  PIC X.					       R   671		  05 EIBRECV  PIC X.					       R
   672		  05 EIBSEND  PIC X.					       R
   673		  05 EIBATT   PIC X.					       R
   674		  05 EIBEOC   PIC X.					       R
   675		  05 EIBFMH   PIC X.					       R
   676		  05 EIBCOMPL PIC X.					       R
   677		  05 EIBSIG   PIC X.					       R
   678		  05 EIBCONF  PIC X.					       R
   679		  05 EIBERR   PIC X.					       R
   680		  05 EIBERRCD PIC X(4). 				       R
   681		  05 EIBSYNRB PIC X.					       R
   682		  05 EIBNODAT PIC X.					       R
   683		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   684		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   685		  05 EIBRLDBK PIC X.					       R
   686		  05 EIBCARESERVED PIC X(32).				       R
   688	      01  DFHCOMMAREA.
   689		  05 DF-PGMID				PIC X(06).
   690		  05 DF-STATE				PIC X.
   691		  05 DF-TICKET-PASSED			PIC X(07).
   692		  05 DF-USERID.
   693		     10  DF-USERID7			PIC X(7).
   694		     10  FILLER 			PIC X(1).
   695		  05 DF-USR-TYPE.
   696		    15 DF-USR-REQUESTOR 		PIC X.
   697		    15 DF-USR-ADMIN			PIC X.
   698		    15 DF-USR-APPROVER			PIC X.
   699		    15 DF-USR-SERVICE			PIC X.
   700		  05 DF-SM012-STATE			PIC X.
   701		  05 DF-SM012-PGMID			PIC X(06).
   702		  05 DF-FLAG				PIC X(01).
   703		  05 HOLDER.
   704		     10 T-ID				PIC X(06).
   705		     10 T-TITLE 			PIC X(25).
   706		     10 T-DES1				PIC X(50).
   707		     10 T-DES2				PIC X(50).
   708
   709
   710	      PROCEDURE DIVISION					       R
   712		  USING DFHEIBLK DFHCOMMAREA.				       R
   737	      100-MAIN.
   739		  EXEC CICS IGNORE CONDITION
   740			    ERROR
   741		  END-EXEC
   756		  MOVE HIGH-VALUE TO TICKET-KEY
   758            EXEC CICS STARTBR FILE('STF001C')
   759		    RIDFLD (TICKET-KEY)
   760		    GTEQ
   761		  END-EXEC
   788		  IF EIBRESP = +0
   790		    EXEC CICS READPREV
   791                   FILE('STF001C')
   792			 INTO(TICKET)
   793			 RIDFLD(TICKET-KEY)
   794		    END-EXEC
   823		  END-IF
   824
   825		  MOVE DFHCOMMAREA  TO WS-COMMAREA
   826
   827             IF WS-STATE = 'A' OR   828                 WS-STATE  = 'B' OR
   829		       WS-STATE  =  SPACE
   830		       CONTINUE
   831		   ELSE
   832		     MOVE SPACE TO WS-STATE
   833		   END-IF
   834
   835            IF WS-PGMID = 'SM000' OR WS-PGMID = 'SM001' OR
   836               WS-PGMID = 'SM002'
   837                 IF USR-REQUESTOR = 'Y'
   838			  PERFORM 2000-CHECK-AID
   839			  EVALUATE TRUE
   840			    WHEN WS-STATE = SPACE
   841			      ADD  1 TO TICKET-KEY-NUM
   842			      MOVE TICKET-KEY-NUM TO IDO
   843			      MOVE SPACE TO TICKETTO
   844			      MOVE SPACE TO TICKTD1O
   845			      MOVE SPACE TO TICKTD2O
   846			      MOVE -1 TO TICKETTL
   847
   848                      WHEN WS-STATE = 'A'
   849			      PERFORM 3000-RMAP
   850
   851                      WHEN WS-STATE = 'B'
   852			      PERFORM 3000-RMAP
   853
   854                        IF WS-FLAG = 'Y'
   855				MOVE IDI TO NEW-TICKET-KEY
   856				MOVE USERID TO NEW-TICKET-REQUESTOR
   857				MOVE TICKETTI TO NEW-TICKET-TITLE
   858				MOVE USERID TO NEW-TICKET-LAST-UPDATE-BY
   859				MOVE TICKTD1I TO NEW-TICKET-DESCRIPTION(1:50)
   860				MOVE TICKTD2I TO NEW-TICKET-DESCRIPTION(51:50)
   861				PERFORM 1100-GET-DATE-TIME
   862				MOVE DATEO    TO NEW-TICKET-Last-Update(1:10)
   863				MOVE TIMEO    TO NEW-TICKET-Last-Update(11:10)
   864				MOVE IDI TO WS-LOG-TICKET-ID
   865				MOVE DATEO    TO WS-LOG-LAST-UPDATE(1:10)
   866				MOVE TIMEO    TO WS-LOG-LAST-UPDATE(12:8)
   867				MOVE USERID TO WS-LOG-LAST-UPDATE-BY
   868				PERFORM 4000-WRITE
   869			      END-IF
   870
   871			      MOVE DFHBMASK TO STA
   872			      MOVE DFHBMASK TO UPMA
   873			      MOVE DFHBMASK TO UPDTA
   874			      MOVE DFHBMASK TO UPBYA
   875			      MOVE DFHBMPRO TO STATSA
   876			      MOVE DFHBMPRO TO TICKETTA
   877			      MOVE DFHBMPRO TO TICKTD1A
   878			      MOVE DFHBMPRO TO TICKTD2A
   879
   880			  END-EVALUATE
   881			  PERFORM 2100-CHECK-AID-MSG
   882			  PERFORM 1000-NEW-MAP
   883		       ELSE
   884			 PERFORM 110-INVALID
   885		       END-IF
   886		   ELSE
   887		     PERFORM 110-INVALID   888		   END-IF.
   889	      100-EXIT. EXIT.
   890
   891	      110-INVALID.
   892		  MOVE LENGTH OF WS-INVALID-ACCESS TO WS-LENGTH
   894		  EXEC CICS SEND TEXT
   895		     FROM (WS-INVALID-ACCESS)
   896		     LENGTH (WS-LENGTH)
   897		     ERASE
   898		  END-EXEC
   929		  EXEC CICS RETURN
   930		  END-EXEC.
   944	      110-EXIT. EXIT.
   945
   946	      1100-GET-DATE-TIME.
   947		  MOVE EIBDATE TO WS-DATE
   948		  MOVE WS-DATE-X TO DATEO
   950		  EXEC CICS ASKTIME
   951		    ABSTIME    (WS-TIME)
   952		  END-EXEC
   971		  EXEC CICS FORMATTIME
   972		    ABSTIME    (WS-TIME)
   973              DATESEP    ('/')
   974		    MMDDYYYY   (DATEO)
   975		    TIME       (TIMEO)
   976              TIMESEP    (':')
   977		  END-EXEC.
  1018	      1100-EXIT.
  1019		  EXIT.
  1020
  1021	      1000-NEW-MAP.
  1022		  PERFORM 1100-GET-DATE-TIME
  1023		  MOVE DFHBMASB TO TIMEA
  1024		  MOVE DFHBMASB TO DATEA
  1025		  MOVE DFHBMASB TO ERRMSGA
  1026		  MOVE LENGTH OF SM002MO TO WS-LENGTH
  1028			      EXEC CICS SEND
  1029                 MAP('SM002M')
  1030                                   MAPSET('SM02S')
  1031					 FROM(SM002MO)
  1032					 LENGTH(WS-LENGTH)
  1033		       CURSOR
  1034		       ERASE
  1035				    END-EXEC.
  1082		  EXEC CICS RETURN
  1083                 TRANSID('SM02')
  1084		       COMMAREA(WS-COMMAREA)
  1085			END-EXEC.
  1110	      1000-EXIT. EXIT.
  1111
  1112	      2000-CHECK-AID.
  1113		   EVALUATE TRUE
  1114		     WHEN EIBAID = DFHPF2
  1115		       IF WS-STATE = SPACE
  1116                   MOVE 'A'  TO WS-STATE
  1117		       END-IF
  1118
  1119                 IF WS-STATE = 'A' AND WS-FLAG = 'Y'
  1120                   MOVE 'B'  TO WS-STATE
  1121		       END-IF  1122
  1123                 IF WS-STATE = 'B' AND WS-FLAG = 'N'
  1124			 MOVE SPACE  TO WS-STATE
  1125		       END-IF
  1126
  1127		     WHEN EIBAID = DFHPF3
  1128					EVALUATE WS-PGMID
  1129                     WHEN 'SM000'
  1131					    EXEC CICS XCTL
  1132                                              PROGRAM('SM000')
  1133				END-EXEC
  1152                     WHEN 'SM001'
  1154				EXEC CICS XCTL
  1155                                              PROGRAM('SM000')
  1156				END-EXEC
  1175			  END-EVALUATE
  1176
  1177		     WHEN EIBAID = DFHPF5
  1178				     MOVE SPACE TO WS-STATE
  1179
  1180		     WHEN EIBAID = DFHENTER
  1181                 IF WS-STATE = SPACE AND WS-FLAG = 'N'
  1182                   MOVE 'A' TO WS-STATE
  1183		       END-IF
  1184                 IF WS-STATE = 'B'
  1185			 MOVE SPACE TO WS-STATE
  1186		       END-IF
  1187		     WHEN EIBAID = DFHCLEAR
  1188		       CONTINUE
  1189		     WHEN OTHER
  1190		       CONTINUE
  1191		   END-EVALUATE.
  1192	      2000-EXIT. EXIT.
  1193
  1194	      2100-CHECK-AID-MSG.
  1195		   MOVE IDI TO NEW-TICKET-KEY
  1196		   MOVE IDI TO WS-LOG-TICKET-ID
  1197		   MOVE TICKETTI TO NEW-TICKET-TITLE
  1198		   MOVE TICKTD1I TO NEW-TICKET-DESCRIPTION(1:50)
  1199		   MOVE TICKTD2I TO NEW-TICKET-DESCRIPTION(51:50)
  1200		   EVALUATE TRUE
  1201		     WHEN EIBAID = DFHPF2
  1202
  1203                 IF WS-STATE = SPACE AND WS-FLAG = 'N'
  1204                   MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1205			  TO ERRMSGO
  1206		       END-IF
  1207
  1208                 IF WS-STATE = 'A'
  1209			 MOVE IDI  TO WS-ID
  1210			 MOVE TICKETTI TO WS-TITLE
  1211			 MOVE TICKTD1I TO WS-DES1
  1212			 MOVE TICKTD2I TO WS-DES2
  1213			 EVALUATE TRUE
  1214			   WHEN NEW-TICKET-TITLE = SPACE
  1215			     MOVE WS-TITLE-REQUIRED TO ERRMSGO
  1216			     MOVE -1 TO TICKETTL
  1217
  1218			   WHEN NEW-TICKET-DESCRIPTION = SPACE
  1219                       MOVE 'TICKET DESCRIPTION IS REQUIRED'  1220			      TO ERRMSGO
  1221			     MOVE -1 TO TICKTD1L
  1222
  1223			   WHEN OTHER
  1224                       MOVE 'Y' TO WS-FLAG
  1225			     MOVE -1 TO TICKETTL
  1226                       MOVE 'VALID INPUT PRESS PF2 TO ADD'
  1227			      TO ERRMSGO
  1228			 END-EVALUATE
  1229
  1230		       END-IF
  1231
  1232                 IF WS-STATE = 'B'
  1233                   IF WS-FLAG = 'Y'
  1234                     MOVE 'N' TO WS-FLAG
  1235			 END-IF
  1236
  1237                   IF WS-FLAG = 'N'
  1238                     MOVE 'CREATED' TO STATSO
  1239			   MOVE -1 TO TICKETTL
  1240                     MOVE 'TICKET CREATED' TO UPR1O
  1241			   MOVE NEW-TICKET-Last-Update(1:10) TO UPDATEO
  1242			   MOVE NEW-TICKET-Last-Update(11:10) TO UPTIMEO
  1243			   MOVE NEW-TICKET-Last-Update-by TO UPBO
  1244                     MOVE 'SUCCESSFULLY CREATED. PF2 TO ADD MORE'
  1245			      TO ERRMSGO
  1246			 END-IF
  1247		       END-IF
  1248
  1249		     WHEN EIBAID = DFHENTER
  1250		       MOVE IDI  TO WS-ID
  1251		       MOVE TICKETTI TO WS-TITLE
  1252		       MOVE TICKTD1I TO WS-DES1
  1253		       MOVE TICKTD2I TO WS-DES2
  1254		       EVALUATE TRUE
  1255                 WHEN WS-STATE = SPACE AND WS-FLAG NOT = 'N'
  1256                   MOVE 'N' TO WS-FLAG
  1257                   MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1258			  TO ERRMSGO
  1259
  1260                 WHEN WS-STATE = SPACE AND WS-FLAG = 'N'
  1261                   MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1262			  TO ERRMSGO
  1263
  1264		       WHEN OTHER
  1265			  EVALUATE TRUE
  1266			   WHEN NEW-TICKET-TITLE = SPACE
  1267                       MOVE 'TICKET TITLE IS REQUIRED'
  1268			      TO ERRMSGO
  1269			     MOVE -1 TO TICKETTL
  1270			     MOVE DFHUNIMD TO TICKETTA
  1271
  1272			   WHEN NEW-TICKET-DESCRIPTION = SPACE
  1273                       MOVE 'TICKET DESCRIPTION IS REQUIRED'
  1274			      TO ERRMSGO
  1275			     MOVE -1 TO TICKTD1L
  1276			     MOVE DFHUNIMD TO TICKTD1A
  1277
  1278			   WHEN OTHER
  1279                       MOVE 'Y' TO WS-FLAG  1280                       MOVE 'VALID INPUT PRESS PF2 TO ADD'
  1281			      TO ERRMSGO
  1282			 END-EVALUATE
  1283		       END-EVALUATE
  1284
  1285		     WHEN EIBAID = DFHPF5
  1286				     IF WS-STATE = SPACE
  1287                   MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1288			 TO ERRMSGO
  1289		       ELSE
  1290                   MOVE 'TRANSACTION IS ABORTED' TO ERRMSGO
  1291		       END-IF
  1292
  1293		     WHEN EIBAID = DFHCLEAR
  1294                 IF WS-STATE = 'B'
  1295			 MOVE TICKET-KEY TO IDO
  1296			 MOVE TICKET-TITLE TO TICKETTO
  1297			 MOVE TICKET-DESCRIPTION(1:50) TO TICKTD1O
  1298			 MOVE TICKET-DESCRIPTION(51:50) TO TICKTD2O
  1299                   MOVE 'CREATED' TO STATSO
  1300                   MOVE 'TICKET CREATED' TO UPR1O
  1301			 MOVE TICKET-Last-Update(1:10) TO UPDATEO
  1302			 MOVE TICKET-Last-Update(11:10) TO UPTIMEO
  1303			 MOVE TICKET-Last-Update-by TO UPBO
  1304                   MOVE 'SUCCESSFULLY CREATED. PF2 TO ADD MORE'
  1305			   TO ERRMSGO
  1306		       END-IF
  1307
  1308                 IF WS-STATE = 'A'
  1309			   MOVE T-ID	 TO IDO
  1310			   MOVE T-TITLE  TO TICKETTO
  1311			   MOVE T-DES1	 TO TICKTD1O
  1312			   MOVE T-DES2	 TO TICKTD2O
  1313			   MOVE -1 TO TICKETTL
  1314			   MOVE WS-INVALID-PFKEY TO ERRMSGO
  1315		       END-IF
  1316
  1317		       IF WS-STATE = SPACE
  1318			   MOVE TICKET-KEY-NUM TO IDO
  1319			   MOVE SPACE TO TICKETTO
  1320			   MOVE SPACE TO TICKTD1O
  1321			   MOVE SPACE TO TICKTD2O
  1322                     MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1323			       TO ERRMSGO
  1324			   MOVE -1 TO TICKETTL
  1325		       END-IF
  1326
  1327		     WHEN OTHER
  1328		       EVALUATE TRUE
  1329			 WHEN WS-STATE = SPACE
  1330			   MOVE TICKET-KEY-NUM TO IDO
  1331			   MOVE SPACE TO TICKETTO
  1332			   MOVE SPACE TO TICKTD1O
  1333			   MOVE SPACE TO TICKTD2O
  1334
  1335                   WHEN WS-STATE = 'A'
  1336			   MOVE NEW-TICKET-KEY TO IDO
  1337			   MOVE NEW-TICKET-TITLE TO TICKETTO
  1338			   MOVE NEW-TICKET-DESCRIPTION(1:50) TO TICKTD1O
  1339			   MOVE NEW-TICKET-DESCRIPTION(51:50) TO TICKTD2O  1340
  1341                   WHEN WS-STATE = 'B'
  1342			   MOVE TICKET-KEY TO IDO
  1343			   MOVE TICKET-TITLE TO TICKETTO
  1344			   MOVE TICKET-DESCRIPTION(1:50) TO TICKTD1O
  1345			   MOVE TICKET-DESCRIPTION(51:50) TO TICKTD2O
  1346                     MOVE 'CREATED' TO STATSO
  1347                     MOVE 'TICKET CREATED' TO UPR1O
  1348			   MOVE TICKET-Last-Update(1:10) TO UPDATEO
  1349			   MOVE TICKET-Last-Update(11:10) TO UPTIMEO
  1350			   MOVE TICKET-Last-Update-by TO UPBO
  1351
  1352		       END-EVALUATE
  1353		       MOVE WS-INVALID-PFKEY TO ERRMSGO
  1354		   END-EVALUATE.
  1355	      2100-EXIT. EXIT.
  1356
  1357
  1358	      3000-RMAP.
  1360		  EXEC CICS RECEIVE
  1361                 MAP('SM002M')
  1362                 MAPSET('SM02S')
  1363		       INTO (SM002MI)
  1364		  END-EXEC.
  1398	      3000-EXIT. EXIT.
  1399
  1400	      4000-WRITE.
  1402		  EXEC CICS WRITE
  1403                 FILE('STF001C')
  1404		       FROM (NEW-TICKET)
  1405		       RIDFLD (NEW-TICKET-KEY)
  1406		       RESP(WS-RETNCODE)
  1407		  END-EXEC
  1442
  1443            MOVE 'TICKET CREATED' TO WS-LOG-UPDATE-REMARKS
  1444		  MOVE USERID TO WS-LOG-LAST-UPDATE-BY
  1445		  MOVE NEW-TICKET-LAST-UPDATE TO WS-LOG-LAST-UPDATE
  1446
  1448		  EXEC CICS WRITE
  1449                 FILE('STF002D')
  1450		       FROM (WS-LOG)
  1451		       RIDFLD (WS-LOG-TICKET-ID)
  1452		       RESP(WS-RETNCODE)
  1453		  END-EXEC.
  1489	      4000-EXIT. EXIT.
  1490
  1491
  1492CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\SM002.cic	       PAGE   18



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    1503
			Compilation time (mm:ss.ss):  0:00.69
			Compilation speed (lines/minute): 30695

			Compilation date (yy/mm/dd): 23/12/05
			     Time of day (hh:mm:ss): 11:33:35