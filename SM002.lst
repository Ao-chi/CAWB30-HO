     5	     *	CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM002.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      WORKING-STORAGE SECTION.
    74        01  WS-CURRENT-MAP  VALUE 'SM002M'        PIC X(7).
    75	      01  WS-TIME				PIC 9(15).
    76	      01  WS-DATE				PIC 9(7).
    77	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    78	      01  WS-LENGTH				PIC S9(4) COMP.
    79	      01  WS-END				PIC X(15) VALUE
    80            'INVALID ACCESS'.
    81	      77 WS-RETNCODE				PIC S9(8) COMP.
    82	      77 TICKETADD				PIC 9(06).
    83        77 REQUESTOR                              PIC X(01) VALUE 'Y'.
    84
    85	      01  TICKET.
    86		  05 TICKET-KEY 			PIC X(07).
    87		  05 TICKET-KEY-NUM REDEFINES TICKET-KEY PIC 9(06).
    88		  05 TICKET-REQUESTOR			PIC X(8).
    89		  05 TICKET-STATUS			PIC X(10).
    90		  05 TICKET-TITLE			PIC X(25).
    91		  05 TICKET-DESCRIPTION 		PIC X(100).
    92		  05 TICKET-LAST-UPDATE 		PIC X(20).
    93		  05 TICKET-LAST-UPDATE-BY		PIC X(8).
    94		  05 TICKET-UPDATE-REMARKS		PIC X(50).
    95
    96	      01  NEW-TICKET.
    97		  05 NEW-TICKET-KEY			PIC X(07).
    98		  05 NEW-TICKET-KEY-NUM REDEFINES NEW-TICKET-KEY PIC 9(07).
    99		  05 NEW-TICKET-REQUESTOR		PIC X(08).
   100		  05 NEW-TICKET-STATUS			PIC X(10) VALUE
   101               'CREATED'.
   102		  05 NEW-TICKET-TITLE			PIC X(25).
   103		  05 NEW-TICKET-DESCRIPTION		PIC X(100).
   104		  05 NEW-TICKET-LAST-UPDATE		PIC X(20) VALUE SPACE.
   105		  05 NEW-TICKET-LAST-UPDATE-BY		PIC X(08) VALUE SPACE.
   106		  05 NEW-TICKET-UPDATE-REMARKS		PIC X(50) VALUE SPACE.
   107
   108	      01  WS-LOG.
   109		  05 WS-LOG-TICKET-ID	       PIC X(07).
   110		  05 WS-LOG-SEQ-NUMBER	       PIC 9(03) VALUE 1.
   111		  05 WS-LOG-LAST-UPDATE        PIC X(20) VALUE SPACE.
   112		  05 WS-LOG-LAST-UPDATE-BY     PIC X(08) VALUE SPACE.
   113		  05 WS-LOG-UPDATE-REMARKS     PIC X(50) VALUE SPACE.
   114		  05 FILLER		       PIC X(02) VALUE SPACE.
   115
   116	      01  WS-ERRMSGS.
   117		  05 WS-INVALID-ACCESS			PIC X(15) VALUE
   118               'INVALID ACCESS'.
   119		  05 WS-INVALID-PGMID			PIC X(20) VALUE
   120               'INVALID USER ACCESS'.
   121		  05 WS-MAPFAIL 			PIC X(20) VALUE
   122               'MAPFAIL ERROR'.
   123		  05 WS-INVALID-TIX-ACC 		PIC X(34) VALUE   124               'INVALID ACCESS TO SELECTED TICKET'.
   125		  05 WS-FIELD-REQ			PIC X(24) VALUE
   126               'OPTION FIELD IS REQUIRED'.
   127		  05 WS-TITLE-REQUIRED		       PIC X(24) VALUE
   128               'TICKET TITLE IS REQUIRED'.
   129		  05 WS-LAST-PAGE			PIC X(21) VALUE
   130               'THIS IS THE LAST PAGE'.
   131		  05 WS-INVALID-VALUE			PIC X(46) VALUE
   132               'INVALID VALUE. PLEASE CORRECT HIGHLIGHT FIELDS'.
   133		  05 WS-INVALID-PFKEY			PIC X(21) VALUE
   134                'INAVLID PFKEY PRESSED'.
   135
   136	      01  WS-COMMAREA.
   137		  05 WS-PGMID				PIC X(06).
   138		  05 WS-STATE				PIC X.
   139		  05 WS-TICKET-PASSED			PIC X(07).
   140		  05 USERID.
   141		     10  USERID7			PIC X(7).
   142		     10  FILLER 			PIC X(1).
   143		  05 USR-TYPE.
   144		    15 USR-REQUESTOR			PIC X.
   145		    15 USR-ADMIN			PIC X.
   146		    15 USR-APPROVER			PIC X.
   147		    15 USR-SERVICE			PIC X.
   148		  05 WS-FLAG				PIC X(01).
   149		  05 WS-HOLDER.
   150		     10 WS-ID			       PIC X(06).
   151		     10 WS-TITLE		       PIC X(25).
   152		     10 WS-DES1 		       PIC X(50).
   153		     10 WS-DES2 		       PIC X(50).
   154
   155	      COPY SM02S.
   157	     * SYMBOLIC MAP of SM02S Created by CACXBMS Version 6.0.27
   158	      01  SM002MI.
   159		  02  FILLER				     PIC X(12).
   160		  02  DATEL				     PIC S9(4) COMP.
   161		  02  DATEF				     PIC X.
   162		  02  FILLER REDEFINES DATEF.
   163		      03  DATEA 			     PIC X.
   164		  02  DATEI				     PIC X(010).
   165		  02  TIMEL				     PIC S9(4) COMP.
   166		  02  TIMEF				     PIC X.
   167		  02  FILLER REDEFINES TIMEF.
   168		      03  TIMEA 			     PIC X.
   169		  02  TIMEI				     PIC X(008).
   170		  02  IDL				     PIC S9(4) COMP.
   171		  02  IDF				     PIC X.
   172		  02  FILLER REDEFINES IDF.
   173		      03  IDA				     PIC X.
   174		  02  IDI				     PIC X(006).
   175		  02  TICKETTL				     PIC S9(4) COMP.
   176		  02  TICKETTF				     PIC X.
   177		  02  FILLER REDEFINES TICKETTF.
   178		      03  TICKETTA			     PIC X.
   179		  02  TICKETTI				     PIC X(025).
   180		  02  TICKTD1L				     PIC S9(4) COMP.
   181		  02  TICKTD1F				     PIC X.
   182		  02  FILLER REDEFINES TICKTD1F.
   183		      03  TICKTD1A			     PIC X.
   184		  02  TICKTD1I				     PIC X(040).   185		  02  TICKTD2L				     PIC S9(4) COMP.
   186		  02  TICKTD2F				     PIC X.
   187		  02  FILLER REDEFINES TICKTD2F.
   188		      03  TICKTD2A			     PIC X.
   189		  02  TICKTD2I				     PIC X(040).
   190		  02  STL				     PIC S9(4) COMP.
   191		  02  STF				     PIC X.
   192		  02  FILLER REDEFINES STF.
   193		      03  STA				     PIC X.
   194		  02  STI				     PIC X(020).
   195		  02  STATSL				     PIC S9(4) COMP.
   196		  02  STATSF				     PIC X.
   197		  02  FILLER REDEFINES STATSF.
   198		      03  STATSA			     PIC X.
   199		  02  STATSI				     PIC X(007).
   200		  02  UPML				     PIC S9(4) COMP.
   201		  02  UPMF				     PIC X.
   202		  02  FILLER REDEFINES UPMF.
   203		      03  UPMA				     PIC X.
   204		  02  UPMI				     PIC X(020).
   205		  02  UPR1L				     PIC S9(4) COMP.
   206		  02  UPR1F				     PIC X.
   207		  02  FILLER REDEFINES UPR1F.
   208		      03  UPR1A 			     PIC X.
   209		  02  UPR1I				     PIC X(025).
   210		  02  UPR2L				     PIC S9(4) COMP.
   211		  02  UPR2F				     PIC X.
   212		  02  FILLER REDEFINES UPR2F.
   213		      03  UPR2A 			     PIC X.
   214		  02  UPR2I				     PIC X(025).
   215		  02  UPDTL				     PIC S9(4) COMP.
   216		  02  UPDTF				     PIC X.
   217		  02  FILLER REDEFINES UPDTF.
   218		      03  UPDTA 			     PIC X.
   219		  02  UPDTI				     PIC X(020).
   220		  02  UPDATEL				     PIC S9(4) COMP.
   221		  02  UPDATEF				     PIC X.
   222		  02  FILLER REDEFINES UPDATEF.
   223		      03  UPDATEA			     PIC X.
   224		  02  UPDATEI				     PIC X(010).
   225		  02  UPTIMEL				     PIC S9(4) COMP.
   226		  02  UPTIMEF				     PIC X.
   227		  02  FILLER REDEFINES UPTIMEF.
   228		      03  UPTIMEA			     PIC X.
   229		  02  UPTIMEI				     PIC X(008).
   230		  02  UPBYL				     PIC S9(4) COMP.
   231		  02  UPBYF				     PIC X.
   232		  02  FILLER REDEFINES UPBYF.
   233		      03  UPBYA 			     PIC X.
   234		  02  UPBYI				     PIC X(020).
   235		  02  UPBL				     PIC S9(4) COMP.
   236		  02  UPBF				     PIC X.
   237		  02  FILLER REDEFINES UPBF.
   238		      03  UPBA				     PIC X.
   239		  02  UPBI				     PIC X(007).
   240		  02  ERRMSGL				     PIC S9(4) COMP.
   241		  02  ERRMSGF				     PIC X.
   242		  02  FILLER REDEFINES ERRMSGF.
   243		      03  ERRMSGA			     PIC X.
   244		  02  ERRMSGI				     PIC X(058).   245	      01  SM002MO REDEFINES SM002MI.
   246		  02  FILLER				     PIC X(12).
   247		  02  FILLER				     PIC XX.
   248		  02  FILLER				     PIC X.
   249		  02  DATEO				     PIC X(010).
   250		  02  FILLER				     PIC XX.
   251		  02  FILLER				     PIC X.
   252		  02  TIMEO				     PIC X(008).
   253		  02  FILLER				     PIC XX.
   254		  02  FILLER				     PIC X.
   255		  02  IDO				     PIC X(006).
   256		  02  FILLER				     PIC XX.
   257		  02  FILLER				     PIC X.
   258		  02  TICKETTO				     PIC X(025).
   259		  02  FILLER				     PIC XX.
   260		  02  FILLER				     PIC X.
   261		  02  TICKTD1O				     PIC X(040).
   262		  02  FILLER				     PIC XX.
   263		  02  FILLER				     PIC X.
   264		  02  TICKTD2O				     PIC X(040).
   265		  02  FILLER				     PIC XX.
   266		  02  FILLER				     PIC X.
   267		  02  STO				     PIC X(020).
   268		  02  FILLER				     PIC XX.
   269		  02  FILLER				     PIC X.
   270		  02  STATSO				     PIC X(007).
   271		  02  FILLER				     PIC XX.
   272		  02  FILLER				     PIC X.
   273		  02  UPMO				     PIC X(020).
   274		  02  FILLER				     PIC XX.
   275		  02  FILLER				     PIC X.
   276		  02  UPR1O				     PIC X(025).
   277		  02  FILLER				     PIC XX.
   278		  02  FILLER				     PIC X.
   279		  02  UPR2O				     PIC X(025).
   280		  02  FILLER				     PIC XX.
   281		  02  FILLER				     PIC X.
   282		  02  UPDTO				     PIC X(020).
   283		  02  FILLER				     PIC XX.
   284		  02  FILLER				     PIC X.
   285		  02  UPDATEO				     PIC X(010).
   286		  02  FILLER				     PIC XX.
   287		  02  FILLER				     PIC X.
   288		  02  UPTIMEO				     PIC X(008).
   289		  02  FILLER				     PIC XX.
   290		  02  FILLER				     PIC X.
   291		  02  UPBYO				     PIC X(020).
   292		  02  FILLER				     PIC XX.
   293		  02  FILLER				     PIC X.
   294		  02  UPBO				     PIC X(007).
   295		  02  FILLER				     PIC XX.
   296		  02  FILLER				     PIC X.
   297		  02  ERRMSGO				     PIC X(058).
   299	      COPY DFHAID.
   301	      01  DFHAID.
   302	     *
   303	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   304	     *
   305	     * Revision Information
   306	     * ^{File:dfhaid.cob  }   307	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   308	     * ^{Revision:2.0}
   309	     *
   310	     *This is the AID constants copy file
   311	     *
   312            05  DFHENTER                  PIC X VALUE ''''.
   313	     *					value APOST
   314            05  DFHCLEAR                  PIC X VALUE '_'.
   315            05  DFHPA1                    PIC X VALUE '%'.
   316            05  DFHPA2                    PIC X VALUE '>'.
   317            05  DFHPA3                    PIC X VALUE ','.
   318            05  DFHPF1                    PIC X VALUE '1'.
   319            05  DFHPF2                    PIC X VALUE '2'.
   320            05  DFHPF3                    PIC X VALUE '3'.
   321            05  DFHPF4                    PIC X VALUE '4'.
   322            05  DFHPF5                    PIC X VALUE '5'.
   323            05  DFHPF6                    PIC X VALUE '6'.
   324            05  DFHPF7                    PIC X VALUE '7'.
   325            05  DFHPF8                    PIC X VALUE '8'.
   326            05  DFHPF9                    PIC X VALUE '9'.
   327            05  DFHPF10                   PIC X VALUE ':'.
   328            05  DFHPF11                   PIC X VALUE '#'.
   329            05  DFHPF12                   PIC X VALUE '@'.
   330            05  DFHPF13                   PIC X VALUE 'A'.
   331            05  DFHPF14                   PIC X VALUE 'B'.
   332            05  DFHPF15                   PIC X VALUE 'C'.
   333            05  DFHPF16                   PIC X VALUE 'D'.
   334            05  DFHPF17                   PIC X VALUE 'E'.
   335            05  DFHPF18                   PIC X VALUE 'F'.
   336            05  DFHPF19                   PIC X VALUE 'G'.
   337            05  DFHPF20                   PIC X VALUE 'H'.
   338            05  DFHPF21                   PIC X VALUE 'I'.
   339            05  DFHPF22                   PIC X VALUE '›'.
   340       *                                  EBCDIC Cent sign x'4A'
   341       *                                  ASCII  Cent sign x'9B'
   342            05  DFHPF23                   PIC X VALUE '.'.
   343            05  DFHPF24                   PIC X VALUE '<'.
   344            05  DFHOPID                   PIC X VALUE 'W'.
   345            05  DFHMSRE                   PIC X VALUE 'X'.
   346            05  DFHTRIG                   PIC X VALUE '"'.
   347       *                                        value QUOTE  "
   348            05  DFHPEN                    PIC X VALUE '='.
   349            05  DFHCLRP                   PIC X VALUE 'Ý'.
   350       *                                  EBCDIC x'6A'
   351       *                                  ASCII  x'DD'
   352            05  DFHSTRF                   PIC X VALUE 'h'.
   353	     *	  DFHQUIT is a CA-Realia CICS Extension
   354	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   355            05  DFHQUIT                   PIC X VALUE '!'.
   356		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   358	      COPY DFHBMSCA.
   360	      01  DFHBMSCA.
   361	     *
   362	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   363	     *
   364	     * Revision Information
   365	     * ^{File:dfhbmsca.cob}
   366	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   367	     * ^{Revision:2.0}
   368	     *   369	     *	Note:This FILE is provided with most values as quoted literals
   370	     *	     so that the file can be used for both ASCII and EBCDIC
   371	     *	     programs
   372	     *
   373	     *	     The only exceptions are some 3270 Data Stream Orders
   374	     *	     They use different Hexadecimal values for ASCII and
   375	     *	     EBCDIC and they cannot be expressed as quoted literals
   376	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   377	     *	     characters in ASCII
   378	     *
   379	     *	     They have their values set up to default to the EBCDIC
   380	     *	     values.
   381	     *
   382	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   383	     *	     and SEND TEXT with imbedded format orders.
   384	     *	     If you use these values in ASCII programs the values
   385	     *	     must be changed.
   386	     *
   387	     *	     An alternative is to use REPLACING to change the values.
   388	     *
   389	     *	  i.e. COPY DFHBMSCA replacing
   390	     *			    ==005== BY ==009==	*> DFHPT
   391	     *			    ==021== BY ==010==	*> DFHNL
   392	     *			    ==040== BY ==021==	*> DFHSA
   393	     *			    ==041== BY ==031==	*> DFHSFE
   394	     *			    ==044== BY ==023==	*> DFHMF
   395	     *			    ==060== BY ==020==	*> DFHRA
   396	     *			    ==063== BY ==026==. *> DFHSUB
   397	     *
   398	     ******************************************************************
   399	     *BMS and Terminal Control - Order & Attributes constants	      *
   400	     ******************************************************************
   401	     *
   402	     *	  Field Attributes
   403	     *
   404            05  DFHBMASB                          PIC X VALUE '8'.
   405            05  DFHBMASF                          PIC X VALUE '1'.
   406            05  DFHBMASK                          PIC X VALUE '0'.
   407            05  DFHBMBRY                          PIC X VALUE 'H'.
   408            05  DFHBMDAR                          PIC X VALUE '<'.
   409            05  DFHBMFSE                          PIC X VALUE 'A'.
   410            05  DFHBMPRF                          PIC X VALUE '/'.
   411            05  DFHBMPRO                          PIC X VALUE '-'.
   412            05  DFHBMUNN                          PIC X VALUE '&'.
   413            05  DFHBMUNP                          PIC X VALUE ' '.
   414            05  DFHUNNUM                          PIC X VALUE 'J'.
   415	     *
   416	     *	  partially supported
   417	     *
   418            05  DFHUNNOD                          PIC X VALUE '('.
   419            05  DFHUNIMD                          PIC X VALUE 'I'.
   420            05  DFHUNINT                          PIC X VALUE 'R'.
   421            05  DFHUNNON                          PIC X VALUE '('.
   422            05  DFHPROTI                          PIC X VALUE 'Y'.
   423            05  DFHPROTN                          PIC X VALUE '%'.
   424	     *
   425	     *	  These values are additions to mainframe constants
   426	     *
   427            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   428            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.   429            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   430	     *						      VALUE APOST
   431            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   432            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   433            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   434            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   435            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   436	     *
   437	     *	  Field Flag values
   438		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   439		  05  FILLER REDEFINES DFHBMEOF-VAL.
   440		      10  FILLER			PIC X.
   441		      10  DFHBMEOF			PIC X.
   442       *                                          x'80'.
   443		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   444		  05  FILLER REDEFINES DFHBMCUR-VAL.
   445		      10  FILLER			PIC X.
   446		      10  DFHBMCUR			PIC X.
   447       *                                          x'02'.
   448		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   449		  05  FILLER REDEFINES DFHBMMEC-VAL.
   450		      10  FILLER			PIC X.
   451		      10  DFHBMMEC			PIC X.
   452       *                                          x'82'.
   453       *                                          x'02'.
   454		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   455		      88  DFHERASE			VALUES 128 130.
   456       *                                          x'80' X'82'
   457		      88  DFHCURSR			VALUES 002 130.
   458       *                                          x'02' X'82'
   459		  05  FILLER REDEFINES DFHBMFLG-VAL.
   460		      10  FILLER			PIC X.
   461		      10  DFHBMFLG			PIC X.
   462
   463		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   464		  05  FILLER REDEFINES DFHBMDUP-VAL.
   465		      10  FILLER			PIC X.
   466		      10  DFHBMDUP			PIC X.
   467       *                                              x'1C'
   468	     *
   469	     ******************************************************************
   470	     *	  supported 327X Extended Attributes
   471	     *
   472	     *	  Extended COLOR Attributes
   473	     *
   474            05  DFHDFCOL                          PIC X VALUE '0'.
   475            05  DFHBLUE                           PIC X VALUE '1'.
   476            05  DFHRED                            PIC X VALUE '2'.
   477            05  DFHPINK                           PIC X VALUE '3'.
   478            05  DFHGREEN                          PIC X VALUE '4'.
   479            05  DFHTURQ                           PIC X VALUE '5'.
   480            05  DFHYELLO                          PIC X VALUE '6'.
   481            05  DFHNEUTR                          PIC X VALUE '7'.
   482	     *
   483	     *	  Extended HILIGHT Attributes
   484	     *
   485            05  DFHDFHI                           PIC X VALUE '0'.
   486            05  DFHBLINK                          PIC X VALUE '1'.
   487            05  DFHREVRS                          PIC X VALUE '2'.
   488            05  DFHUNDLN                          PIC X VALUE '4'.   489	     *
   490	     ******************************************************************
   491	     *	  supported 327X Data Stream Orders
   492	     *
   493		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   494		  05  FILLER REDEFINES DFHSBA-VAL.
   495		      10  FILLER			PIC X.
   496		      10  DFHSBA			PIC X.
   497       *                                              x'11'
   498		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   499		  05  FILLER REDEFINES DFHEUA-VAL.
   500		      10  FILLER			PIC X.
   501		      10  DFHEUA			PIC X.
   502       *                                              x'12'
   503		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   504		  05  FILLER REDEFINES DFHIC-VAL.
   505		      10  FILLER			PIC X.
   506		      10  DFHIC 			PIC X.
   507       *                                              X'13'.
   508		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   509		  05  FILLER REDEFINES DFHSF-VAL.
   510		      10  FILLER			PIC X.
   511		      10  DFHSF 			PIC X.
   512       *                                              X'1D'.
   513		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   514		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   515		      88 DFHPT-VAL-ASCII		VALUE 9.
   516		  05  FILLER REDEFINES DFHPT-VAL.
   517		      10  FILLER			PIC X.
   518		      10  DFHPT 			PIC X.
   519       *                                              EBCDIC X'05'.
   520       *                                              ASCII  X'09'.
   521		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   522		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   523		      88 DFHRA-VAL-ASCII		VALUE 20.
   524		  05  FILLER REDEFINES DFHRA-VAL.
   525		      10  FILLER			PIC X.
   526		      10  DFHRA 			PIC X.
   527       *                                              EBCDIC x'3C'
   528       *                                              ASCII  x'14'
   529		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   530		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   531		      88 DFHSFE-VAL-ASCII		VALUE 31.
   532		  05  FILLER REDEFINES DFHSFE-VAL.
   533		      10  FILLER			PIC X.
   534		      10  DFHSFE			PIC X.
   535       *                                              EBCDIC x'29'
   536       *                                              ASCII  x'1F'
   537		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   538		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   539		      88 DFHMF-VAL-ASCII		VALUE 23.
   540		  05  FILLER REDEFINES DFHMF-VAL.
   541		      10  FILLER			PIC X.
   542		      10  DFHMF 			PIC X.
   543       *                                              EBCDIC x'2C'
   544       *                                              ASCII  x'17'
   545	     *
   546	     ******************************************************************
   547	     *	  unsupported 327X Data Stream order codes
   548	     *   549		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   550		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   551		      88 DFHSA-VAL-ASCII		VALUE 21.
   552		  05  FILLER REDEFINES DFHSA-VAL.
   553		      10  FILLER			PIC X.
   554		      10  DFHSA 			PIC X.
   555       *                                              EBCDIC x'28'
   556       *                                              ASCII  x'15'
   557		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   558		  05  FILLER REDEFINES DFHGE-VAL.
   559		      10  FILLER			PIC X.
   560		      10  DFHGE 			PIC X.
   561       *                                              X'08'.
   562	     *
   563	     ******************************************************************
   564	     *	  SFE and MF supported attribute types
   565	     *
   566            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   567       *                                              EBCDIC x'42'
   568       *                                              ASCII  x'83'
   569            05  DFHHLT                            PIC X VALUE 'Ö'.
   570       *                                              EBCDIC x'41'
   571       *                                              ASCII  x'D6'
   572            05  DFH3270                           PIC X VALUE '{'.
   573	     *
   574	     *	  supported for SEND TEXT command and printer terminal
   575	     *
   576		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   577		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   578		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   579		  05  FILLER REDEFINES DFHBMPNL-VAL.
   580		      10  FILLER			PIC X.
   581		      10  DFHBMPNL			PIC X.
   582       *                                              EBCDIC X'15'.
   583       *                                              ASCII  X'0A'.
   584	     *
   585	     ******************************************************************
   586	     *	  Printer terminal data stream only
   587	     *
   588		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   589		  05  FILLER REDEFINES DFHBMPFF-VAL.
   590		      10  FILLER			PIC X.
   591		      10  DFHBMPFF			PIC X.
   592       *                                              X'0C'.
   593		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   594		  05  FILLER REDEFINES DFHBMPCR-VAL.
   595		      10  FILLER			PIC X.
   596		      10  DFHBMPCR			PIC X.
   597       *                                              X'0D'.
   598		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   599		  05  FILLER REDEFINES DFHBMPEM-VAL.
   600		      10  FILLER			PIC X.
   601		      10  DFHBMPEM			PIC X.
   602       *                                              X'19'.
   603	     *
   604	     ******************************************************************
   605	     *	  unsupported Miscellaneous attributes and constants
   606	     *
   607		  05  DFHALL				PIC X VALUE LOW-VALUES.
   608            05  DFHBASE                           PIC X VALUE '0'.   609		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   610		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   611		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   612		      10  DFHBMPSO			PIC X.
   613       *                                              X'0E'.
   614		      10  DFHBMPSI			PIC X.
   615       *                                              X'0F'.
   616		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   617            05  DFHERROR                          PIC X VALUE '¶'.
   618       *                                              EBCDIC X'1A'.
   619       *                                              ASCII  X'B6'.
   620            05  DFHFIL                            PIC X VALUE '4'.
   621            05  DFHMENT                           PIC X VALUE '2'.
   622            05  DFHMET                            PIC X VALUE '3'.
   623            05  DFHMFE                            PIC X VALUE '6'.
   624            05  DFHMFET                           PIC X VALUE '7'.
   625            05  DFHMFT                            PIC X VALUE '5'.
   626            05  DFHMT                             PIC X VALUE '1'.
   627            05  DFHOUTLN                          PIC X VALUE 'B'.
   628            05  DFHPS                             PIC X VALUE '„'.
   629       *                                              EBCDIC x'43'
   630       *                                              ASCII  x'84'
   631            05  DFHVAL                            PIC X VALUE 'A'.
   632	     *
   633		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   634		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   635		      88 DFHSUB-VAL-ASCII		VALUE 26.
   636		  05  FILLER REDEFINES DFHSUB-VAL.
   637		      10  FILLER			PIC X.
   638		      10  DFHSUB			PIC X.
   639       *                                              EBCDIC X'3F'.
   640       *                                              ASCII  X'1A'.
   641	     *
   642		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   643		  05  FILLER REDEFINES DFHFM-VAL.
   644		      10  FILLER			PIC X.
   645		      10  DFHFM 			PIC X.
   646       *                                              EBCDIC X'1E'.
   647		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   649
   650	      LINKAGE SECTION.
   652	      01  DFHEIBLK.						       R
   653		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   654		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   655		  05 EIBTRNID PIC X(4). 				       R
   656		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   657		  05 EIBTRMID PIC X(4). 				       R
   658		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   659		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   660		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   661		  05 EIBAID   PIC X.					       R
   662		  05 EIBFN    PIC X(2). 				       R
   663		  05 EIBRCODE PIC X(6). 				       R
   664		  05 EIBDS    PIC X(8). 				       R
   665		  05 EIBREQID PIC X(8). 				       R
   666		  05 EIBRSRCE PIC X(8). 				       R
   667		  05 EIBSYNC  PIC X.					       R
   668		  05 EIBFREE  PIC X.					       R
   669		  05 EIBRECV  PIC X.					       R
   670		  05 EIBSEND  PIC X.					       R   671		  05 EIBATT   PIC X.					       R
   672		  05 EIBEOC   PIC X.					       R
   673		  05 EIBFMH   PIC X.					       R
   674		  05 EIBCOMPL PIC X.					       R
   675		  05 EIBSIG   PIC X.					       R
   676		  05 EIBCONF  PIC X.					       R
   677		  05 EIBERR   PIC X.					       R
   678		  05 EIBERRCD PIC X(4). 				       R
   679		  05 EIBSYNRB PIC X.					       R
   680		  05 EIBNODAT PIC X.					       R
   681		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   682		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   683		  05 EIBRLDBK PIC X.					       R
   684		  05 EIBCARESERVED PIC X(32).				       R
   686	      01  DFHCOMMAREA.
   687		  05 DF-PGMID				PIC X(06).
   688		  05 DF-STATE				PIC X.
   689		  05 DF-TICKET-PASSED			PIC X(07).
   690		  05 DF-USERID.
   691		     10  DF-USERID7			PIC X(7).
   692		     10  FILLER 			PIC X(1).
   693		  05 DF-USR-TYPE.
   694		    15 DF-USR-REQUESTOR 		PIC X.
   695		    15 DF-USR-ADMIN			PIC X.
   696		    15 DF-USR-APPROVER			PIC X.
   697		    15 DF-USR-SERVICE			PIC X.
   698		  05 DF-FLAG				PIC X(01).
   699		  05 HOLDER.
   700		     10 T-ID				PIC X(06).
   701		     10 T-TITLE 			PIC X(25).
   702		     10 T-DES1				PIC X(50).
   703		     10 T-DES2				PIC X(50).
   704
   705
   706	      PROCEDURE DIVISION					       R
   708		  USING DFHEIBLK DFHCOMMAREA.				       R
   733	      100-MAIN.
   735		  EXEC CICS IGNORE CONDITION
   736			    ERROR
   737		  END-EXEC
   752		  MOVE HIGH-VALUE TO TICKET-KEY
   754            EXEC CICS STARTBR FILE('STF001C')
   755		    RIDFLD (TICKET-KEY)
   756		    GTEQ
   757		  END-EXEC
   784		  IF EIBRESP = +0
   786		    EXEC CICS READPREV
   787                   FILE('STF001C')
   788			 INTO(TICKET)
   789			 RIDFLD(TICKET-KEY)
   790		    END-EXEC
   819		  END-IF
   820
   821		  MOVE DFHCOMMAREA  TO WS-COMMAREA
   822
   823             IF WS-STATE = 'A' OR
   824                 WS-STATE  = 'B' OR
   825		       WS-STATE  =  SPACE
   826		       CONTINUE
   827		   ELSE   828		     MOVE SPACE TO WS-STATE
   829		   END-IF
   830
   831            IF WS-PGMID = 'SM000' OR WS-PGMID = 'SM001' OR
   832               WS-PGMID = 'SM002'
   833                 IF USR-REQUESTOR = 'Y'
   834			  PERFORM 2000-CHECK-AID
   835			  EVALUATE TRUE
   836			    WHEN WS-STATE = SPACE
   837			      ADD  1 TO TICKET-KEY-NUM
   838			      MOVE TICKET-KEY-NUM TO IDO
   839			      MOVE SPACE TO TICKETTO
   840			      MOVE SPACE TO TICKTD1O
   841			      MOVE SPACE TO TICKTD2O
   842			      MOVE -1 TO TICKETTL
   843
   844                      WHEN WS-STATE = 'A'
   845			      PERFORM 3000-RMAP
   846
   847                      WHEN WS-STATE = 'B'
   848			      PERFORM 3000-RMAP
   849
   850                        IF WS-FLAG = 'Y'
   851				MOVE IDI TO NEW-TICKET-KEY
   852				MOVE USERID TO NEW-TICKET-REQUESTOR
   853				MOVE TICKETTI TO NEW-TICKET-TITLE
   854				MOVE USERID TO NEW-TICKET-LAST-UPDATE-BY
   855				MOVE TICKTD1I TO NEW-TICKET-DESCRIPTION(1:50)
   856				MOVE TICKTD2I TO NEW-TICKET-DESCRIPTION(51:50)
   857				PERFORM 1100-GET-DATE-TIME
   858				MOVE DATEO    TO NEW-TICKET-Last-Update(1:10)
   859				MOVE TIMEO    TO NEW-TICKET-Last-Update(11:10)
   860				MOVE IDI TO WS-LOG-TICKET-ID
   861				MOVE DATEO    TO WS-LOG-LAST-UPDATE(1:10)
   862				MOVE TIMEO    TO WS-LOG-LAST-UPDATE(12:8)
   863				MOVE USERID TO WS-LOG-LAST-UPDATE-BY
   864				PERFORM 4000-WRITE
   865			      END-IF
   866
   867			      MOVE DFHBMASK TO STA
   868			      MOVE DFHBMASK TO UPMA
   869			      MOVE DFHBMASK TO UPDTA
   870			      MOVE DFHBMASK TO UPBYA
   871			      MOVE DFHBMPRO TO STATSA
   872			      MOVE DFHBMPRO TO TICKETTA
   873			      MOVE DFHBMPRO TO TICKTD1A
   874			      MOVE DFHBMPRO TO TICKTD2A
   875
   876			  END-EVALUATE
   877			  PERFORM 2100-CHECK-AID-MSG
   878			  PERFORM 1000-NEW-MAP
   879		       ELSE
   880			 PERFORM 110-INVALID
   881		       END-IF
   882		   ELSE
   883		     PERFORM 110-INVALID
   884		   END-IF.
   885	      100-EXIT. EXIT.
   886
   887	      110-INVALID.   888		  MOVE LENGTH OF WS-INVALID-ACCESS TO WS-LENGTH
   890		  EXEC CICS SEND TEXT
   891		     FROM (WS-INVALID-ACCESS)
   892		     LENGTH (WS-LENGTH)
   893		     ERASE
   894		  END-EXEC
   925		  EXEC CICS RETURN
   926		  END-EXEC.
   940	      110-EXIT. EXIT.
   941
   942	      1100-GET-DATE-TIME.
   943		  MOVE EIBDATE TO WS-DATE
   944		  MOVE WS-DATE-X TO DATEO
   946		  EXEC CICS ASKTIME
   947		    ABSTIME    (WS-TIME)
   948		  END-EXEC
   967		  EXEC CICS FORMATTIME
   968		    ABSTIME    (WS-TIME)
   969              DATESEP    ('/')
   970		    MMDDYYYY   (DATEO)
   971		    TIME       (TIMEO)
   972              TIMESEP    (':')
   973		  END-EXEC.
  1014	      1100-EXIT.
  1015		  EXIT.
  1016
  1017	      1000-NEW-MAP.
  1018		  PERFORM 1100-GET-DATE-TIME
  1019		  MOVE DFHBMASB TO TIMEA
  1020		  MOVE DFHBMASB TO DATEA
  1021		  MOVE DFHBMASB TO ERRMSGA
  1022		  MOVE LENGTH OF SM002MO TO WS-LENGTH
  1024			      EXEC CICS SEND
  1025                 MAP('SM002M')
  1026                                   MAPSET('SM02S')
  1027					 FROM(SM002MO)
  1028					 LENGTH(WS-LENGTH)
  1029		       CURSOR
  1030		       ERASE
  1031				    END-EXEC.
  1078		  EXEC CICS RETURN
  1079                 TRANSID('SM02')
  1080		       COMMAREA(WS-COMMAREA)
  1081			END-EXEC.
  1106	      1000-EXIT. EXIT.
  1107
  1108	      2000-CHECK-AID.
  1109		   EVALUATE TRUE
  1110		     WHEN EIBAID = DFHPF2
  1111		       IF WS-STATE = SPACE
  1112                   MOVE 'A'  TO WS-STATE
  1113		       END-IF
  1114
  1115                 IF WS-STATE = 'A' AND WS-FLAG = 'Y'
  1116                   MOVE 'B'  TO WS-STATE
  1117		       END-IF
  1118
  1119                 IF WS-STATE = 'B' AND WS-FLAG = 'N'
  1120			 MOVE SPACE  TO WS-STATE
  1121		       END-IF  1122
  1123		     WHEN EIBAID = DFHPF3
  1124					EVALUATE WS-PGMID
  1125                     WHEN 'SM000'
  1127					    EXEC CICS XCTL
  1128                                              PROGRAM('SM000')
  1129				END-EXEC
  1148                     WHEN 'SM001'
  1150				EXEC CICS XCTL
  1151                                              PROGRAM('SM000')
  1152				END-EXEC
  1171			  END-EVALUATE
  1172
  1173		     WHEN EIBAID = DFHPF5
  1174				     MOVE SPACE TO WS-STATE
  1175
  1176		     WHEN EIBAID = DFHENTER
  1177                 IF WS-STATE = SPACE AND WS-FLAG = 'N'
  1178                   MOVE 'A' TO WS-STATE
  1179		       END-IF
  1180                 IF WS-STATE = 'B'
  1181			 MOVE SPACE TO WS-STATE
  1182		       END-IF
  1183		     WHEN EIBAID = DFHCLEAR
  1184		       CONTINUE
  1185		     WHEN OTHER
  1186		       CONTINUE
  1187		   END-EVALUATE.
  1188	      2000-EXIT. EXIT.
  1189
  1190	      2100-CHECK-AID-MSG.
  1191		   MOVE IDI TO NEW-TICKET-KEY
  1192		   MOVE IDI TO WS-LOG-TICKET-ID
  1193		   MOVE TICKETTI TO NEW-TICKET-TITLE
  1194		   MOVE TICKTD1I TO NEW-TICKET-DESCRIPTION(1:50)
  1195		   MOVE TICKTD2I TO NEW-TICKET-DESCRIPTION(51:50)
  1196		   EVALUATE TRUE
  1197		     WHEN EIBAID = DFHPF2
  1198
  1199                 IF WS-STATE = SPACE AND WS-FLAG = 'N'
  1200                   MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1201			  TO ERRMSGO
  1202		       END-IF
  1203
  1204                 IF WS-STATE = 'A'
  1205			 MOVE IDI  TO WS-ID
  1206			 MOVE TICKETTI TO WS-TITLE
  1207			 MOVE TICKTD1I TO WS-DES1
  1208			 MOVE TICKTD2I TO WS-DES2
  1209			 EVALUATE TRUE
  1210			   WHEN NEW-TICKET-TITLE = SPACE
  1211			     MOVE WS-TITLE-REQUIRED TO ERRMSGO
  1212			     MOVE -1 TO TICKETTL
  1213
  1214			   WHEN NEW-TICKET-DESCRIPTION = SPACE
  1215                       MOVE 'TICKET DESCRIPTION IS REQUIRED'
  1216			      TO ERRMSGO
  1217			     MOVE -1 TO TICKTD1L
  1218
  1219			   WHEN OTHER  1220                       MOVE 'Y' TO WS-FLAG
  1221			     MOVE -1 TO TICKETTL
  1222                       MOVE 'VALID INPUT PRESS PF2 TO ADD'
  1223			      TO ERRMSGO
  1224			 END-EVALUATE
  1225
  1226		       END-IF
  1227
  1228                 IF WS-STATE = 'B'
  1229                   IF WS-FLAG = 'Y'
  1230                     MOVE 'N' TO WS-FLAG
  1231			 END-IF
  1232
  1233                   IF WS-FLAG = 'N'
  1234                     MOVE 'CREATED' TO STATSO
  1235			   MOVE -1 TO TICKETTL
  1236                     MOVE 'TICKET CREATED' TO UPR1O
  1237			   MOVE NEW-TICKET-Last-Update(1:10) TO UPDATEO
  1238			   MOVE NEW-TICKET-Last-Update(11:10) TO UPTIMEO
  1239			   MOVE NEW-TICKET-Last-Update-by TO UPBO
  1240                     MOVE 'SUCCESSFULLY CREATED. PF2 TO ADD MORE'
  1241			      TO ERRMSGO
  1242			 END-IF
  1243		       END-IF
  1244
  1245		     WHEN EIBAID = DFHENTER
  1246		       MOVE IDI  TO WS-ID
  1247		       MOVE TICKETTI TO WS-TITLE
  1248		       MOVE TICKTD1I TO WS-DES1
  1249		       MOVE TICKTD2I TO WS-DES2
  1250		       EVALUATE TRUE
  1251                 WHEN WS-STATE = SPACE AND WS-FLAG NOT = 'N'
  1252                   MOVE 'N' TO WS-FLAG
  1253                   MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1254			  TO ERRMSGO
  1255
  1256                 WHEN WS-STATE = SPACE AND WS-FLAG = 'N'
  1257                   MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1258			  TO ERRMSGO
  1259
  1260		       WHEN OTHER
  1261			  EVALUATE TRUE
  1262			   WHEN NEW-TICKET-TITLE = SPACE
  1263                       MOVE 'TICKET TITLE IS REQUIRED'
  1264			      TO ERRMSGO
  1265			     MOVE -1 TO TICKETTL
  1266			     MOVE DFHUNIMD TO TICKETTA
  1267
  1268			   WHEN NEW-TICKET-DESCRIPTION = SPACE
  1269                       MOVE 'TICKET DESCRIPTION IS REQUIRED'
  1270			      TO ERRMSGO
  1271			     MOVE -1 TO TICKTD1L
  1272			     MOVE DFHUNIMD TO TICKTD1A
  1273
  1274			   WHEN OTHER
  1275                       MOVE 'Y' TO WS-FLAG
  1276                       MOVE 'VALID INPUT PRESS PF2 TO ADD'
  1277			      TO ERRMSGO
  1278			 END-EVALUATE
  1279		       END-EVALUATE  1280
  1281		     WHEN EIBAID = DFHPF5
  1282				     IF WS-STATE = SPACE
  1283                   MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1284			 TO ERRMSGO
  1285		       ELSE
  1286                   MOVE 'TRANSACTION IS ABORTED' TO ERRMSGO
  1287		       END-IF
  1288
  1289		     WHEN EIBAID = DFHCLEAR
  1290                 IF WS-STATE = 'B'
  1291			 MOVE TICKET-KEY TO IDO
  1292			 MOVE TICKET-TITLE TO TICKETTO
  1293			 MOVE TICKET-DESCRIPTION(1:50) TO TICKTD1O
  1294			 MOVE TICKET-DESCRIPTION(51:50) TO TICKTD2O
  1295                   MOVE 'CREATED' TO STATSO
  1296                   MOVE 'TICKET CREATED' TO UPR1O
  1297			 MOVE TICKET-Last-Update(1:10) TO UPDATEO
  1298			 MOVE TICKET-Last-Update(11:10) TO UPTIMEO
  1299			 MOVE TICKET-Last-Update-by TO UPBO
  1300                   MOVE 'SUCCESSFULLY CREATED. PF2 TO ADD MORE'
  1301			   TO ERRMSGO
  1302		       END-IF
  1303
  1304                 IF WS-STATE = 'A'
  1305			   MOVE T-ID	 TO IDO
  1306			   MOVE T-TITLE  TO TICKETTO
  1307			   MOVE T-DES1	 TO TICKTD1O
  1308			   MOVE T-DES2	 TO TICKTD2O
  1309			   MOVE -1 TO TICKETTL
  1310			   MOVE WS-INVALID-PFKEY TO ERRMSGO
  1311		       END-IF
  1312
  1313		       IF WS-STATE = SPACE
  1314			   MOVE TICKET-KEY-NUM TO IDO
  1315			   MOVE SPACE TO TICKETTO
  1316			   MOVE SPACE TO TICKTD1O
  1317			   MOVE SPACE TO TICKTD2O
  1318                     MOVE 'ENTER TICKET DETAILS AND PRESS PF2'
  1319			       TO ERRMSGO
  1320			   MOVE -1 TO TICKETTL
  1321		       END-IF
  1322
  1323		     WHEN OTHER
  1324		       EVALUATE TRUE
  1325			 WHEN WS-STATE = SPACE
  1326			   MOVE TICKET-KEY-NUM TO IDO
  1327			   MOVE SPACE TO TICKETTO
  1328			   MOVE SPACE TO TICKTD1O
  1329			   MOVE SPACE TO TICKTD2O
  1330
  1331                   WHEN WS-STATE = 'A'
  1332			   MOVE NEW-TICKET-KEY TO IDO
  1333			   MOVE NEW-TICKET-TITLE TO TICKETTO
  1334			   MOVE NEW-TICKET-DESCRIPTION(1:50) TO TICKTD1O
  1335			   MOVE NEW-TICKET-DESCRIPTION(51:50) TO TICKTD2O
  1336
  1337                   WHEN WS-STATE = 'B'
  1338			   MOVE TICKET-KEY TO IDO
  1339			   MOVE TICKET-TITLE TO TICKETTO  1340			   MOVE TICKET-DESCRIPTION(1:50) TO TICKTD1O
  1341			   MOVE TICKET-DESCRIPTION(51:50) TO TICKTD2O
  1342                     MOVE 'CREATED' TO STATSO
  1343                     MOVE 'TICKET CREATED' TO UPR1O
  1344			   MOVE TICKET-Last-Update(1:10) TO UPDATEO
  1345			   MOVE TICKET-Last-Update(11:10) TO UPTIMEO
  1346			   MOVE TICKET-Last-Update-by TO UPBO
  1347
  1348		       END-EVALUATE
  1349		       MOVE WS-INVALID-PFKEY TO ERRMSGO
  1350		   END-EVALUATE.
  1351	      2100-EXIT. EXIT.
  1352
  1353
  1354	      3000-RMAP.
  1356		  EXEC CICS RECEIVE
  1357                 MAP('SM002M')
  1358                 MAPSET('SM02S')
  1359		       INTO (SM002MI)
  1360		  END-EXEC.
  1394	      3000-EXIT. EXIT.
  1395
  1396	      4000-WRITE.
  1398		  EXEC CICS WRITE
  1399                 FILE('STF001C')
  1400		       FROM (NEW-TICKET)
  1401		       RIDFLD (NEW-TICKET-KEY)
  1402		       RESP(WS-RETNCODE)
  1403		  END-EXEC
  1438
  1439            MOVE 'TICKET CREATED' TO WS-LOG-UPDATE-REMARKS
  1440		  MOVE USERID TO WS-LOG-LAST-UPDATE-BY
  1441		  MOVE NEW-TICKET-LAST-UPDATE TO WS-LOG-LAST-UPDATE
  1442
  1444		  EXEC CICS WRITE
  1445                 FILE('STF002D')
  1446		       FROM (WS-LOG)
  1447		       RIDFLD (WS-LOG-TICKET-ID)
  1448		       RESP(WS-RETNCODE)
  1449		  END-EXEC.
  1485	      4000-EXIT. EXIT.
  1486
  1487
  1488CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\SM002.cic	       PAGE   18



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    1499
			Compilation time (mm:ss.ss):  0:00.73
			Compilation speed (lines/minute): 23205

			Compilation date (yy/mm/dd): 23/12/02
			     Time of day (hh:mm:ss): 16:16:32