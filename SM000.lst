     5	     *CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM000.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	     *----------------------------------------------------------------*
    29	     *			      WORKING STORAGE			      *
    30	     *----------------------------------------------------------------*
    31	      WORKING-STORAGE SECTION.
    77	      01  WS-FIELDS.
    78		  05  WS-STD-KEY-LEN			PIC S9(4) COMP VALUE 8.
    79		  05  WS-REC.
    80		      10  WS-USERID.
    81			  15  WS-USERID7		PIC X(7).
    82			  15  FILLER			PIC X(1).
    83		      10  WS-TYPE.
    84			  15  WS-REQUESTOR		PIC X.
    85			  15  WS-ADMIN			PIC X.
    86			  15  WS-APPROVER		PIC X.
    87			  15  WS-SERVICE		PIC X.
    88		      10  WS-UPDATEDBY			PIC X(8).
    89	      01  WS-STF-KEY-LEN			PIC S9(4) COMP VALUE 7.
    90	      01  WS-TICKET-REC.
    91		  05 WS-TICKET-ID			PIC 9(07).
    92		  05 WS-TICKET-KEY-NUM REDEFINES WS-TICKET-ID PIC X(07).
    93		  05 WS-TICKET-REQUESTOR		   PIC X(08).
    94		  05 WS-TICKET-STATUS			   PIC X(10).
    95		  05 WS-TICKET-TITLE			   PIC X(25).
    96		  05 WS-TICKET-DESC			   PIC X(100).
    97		  05 WS-TICKET-LAST-UPD 		   PIC X(20).
    98		  05 WS-TICKET-LAST-UPD-BY		   PIC X(08).
    99		  05 WS-TICKET-UPD-REMARKS		   PIC X(50).
   100
   101        01  WS-CURRENT-MAP  VALUE 'SM00S'         PIC X(7).
   102	      01  WS-TIME				PIC 9(15) COMP-3.
   103	      01  WS-DATE				PIC 9(7).
   104	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
   105	      01  WS-LENGTH				PIC S9(4) COMP.
   106	      01  WS-END				PIC X(15) VALUE
   107            'END PROCESSING'.
   108	      01  WS-ERRMSG.
   109		  05 WS-FIELD-REQ			PIC X(24) VALUE
   110               'OPTION FIELD IS REQUIRED'.
   111		  05 WS-INVALID-PFKEY			PIC X(21) VALUE
   112                'INAVLID PFKEY PRESSED'.
   113	      01  WS-MAPFAIL				PIC X(20) VALUE
   114            'MAPFAIL ERROR'.
   115	      01  WS-INVALID-TRNID			PIC X(15) VALUE
   116            'INVALID ACCESS'.
   117	      01  WS-INVALID-USER			PIC X(20) VALUE
   118            'INVALID USER ACCESS'.
   119
   120	      01  WS-COMMAREA.
   121		  05 WS-PGMID				PIC X(06).
   122		  05 WS-STATE				PIC X.
   123		  05 WS-TICKET-PASSED			PIC X(07).   124		  05 USERID.
   125		     10  USERID7			PIC X(7).
   126		     10  FILLER 			PIC X(1).
   127		  05 USR-TYPE.
   128		     15 USR-REQUESTOR			PIC X.
   129		     15 USR-ADMIN			PIC X.
   130		     15 USR-APPROVER			PIC X.
   131		     15 USR-SERVICE			PIC X.
   132		  05 WS-SM012-STATE			PIC X.
   133		  05 WS-SM012-PGMID			PIC X(06).
   134	     *	  05 COMM-TICKET-REC.
   135	     *	     10 COMM-TICKET-ID			     PIC 9(07).
   136	     *	     10 COMM-TICKET-KEY-NUM REDEFINES COMM-TICKET-ID PIC X(07).
   137	     *	     10 COMM-TICKET-REQUESTOR			PIC X(08).
   138	     *	     10 COMM-TICKET-STATUS			PIC X(10).
   139	     *	     10 COMM-TICKET-TITLE			PIC X(25).
   140	     *	     10 COMM-TICKET-DESC			PIC X(100).
   141	     *	     10 COMM-TICKET-LAST-UPD			PIC X(20).
   142	     *	     10 COMM-TICKET-LAST-UPD-BY 		PIC X(08).
   143	     *	     10 COMM-TICKET-UPD-REMARKS 		PIC X(50).
   144
   145	      77 WS-RETNCODE				PIC S9(8) COMP.
   146		  COPY SM00S.
   148	     * SYMBOLIC MAP of SM00S Created by CACXBMS Version 6.0.27
   149	      01  SM00MI.
   150		  02  FILLER				     PIC X(12).
   151		  02  OPTN01L				     PIC S9(4) COMP.
   152		  02  OPTN01F				     PIC X.
   153		  02  FILLER REDEFINES OPTN01F.
   154		      03  OPTN01A			     PIC X.
   155		  02  OPTN01I				     PIC X(020).
   156		  02  OPTN02L				     PIC S9(4) COMP.
   157		  02  OPTN02F				     PIC X.
   158		  02  FILLER REDEFINES OPTN02F.
   159		      03  OPTN02A			     PIC X.
   160		  02  OPTN02I				     PIC X(020).
   161		  02  OPTN03L				     PIC S9(4) COMP.
   162		  02  OPTN03F				     PIC X.
   163		  02  FILLER REDEFINES OPTN03F.
   164		      03  OPTN03A			     PIC X.
   165		  02  OPTN03I				     PIC X(020).
   166		  02  OPTN04L				     PIC S9(4) COMP.
   167		  02  OPTN04F				     PIC X.
   168		  02  FILLER REDEFINES OPTN04F.
   169		      03  OPTN04A			     PIC X.
   170		  02  OPTN04I				     PIC X(020).
   171		  02  OPTN05L				     PIC S9(4) COMP.
   172		  02  OPTN05F				     PIC X.
   173		  02  FILLER REDEFINES OPTN05F.
   174		      03  OPTN05A			     PIC X.
   175		  02  OPTN05I				     PIC X(020).
   176		  02  OPTN06L				     PIC S9(4) COMP.
   177		  02  OPTN06F				     PIC X.
   178		  02  FILLER REDEFINES OPTN06F.
   179		      03  OPTN06A			     PIC X.
   180		  02  OPTN06I				     PIC X(020).
   181		  02  OPTN07L				     PIC S9(4) COMP.
   182		  02  OPTN07F				     PIC X.
   183		  02  FILLER REDEFINES OPTN07F.
   184		      03  OPTN07A			     PIC X.   185		  02  OPTN07I				     PIC X(020).
   186		  02  OPTIONL				     PIC S9(4) COMP.
   187		  02  OPTIONF				     PIC X.
   188		  02  FILLER REDEFINES OPTIONF.
   189		      03  OPTIONA			     PIC X.
   190		  02  OPTIONI				     PIC X(001).
   191		  02  TICKETL				     PIC S9(4) COMP.
   192		  02  TICKETF				     PIC X.
   193		  02  FILLER REDEFINES TICKETF.
   194		      03  TICKETA			     PIC X.
   195		  02  TICKETI				     PIC X(006).
   196		  02  ERRMSGL				     PIC S9(4) COMP.
   197		  02  ERRMSGF				     PIC X.
   198		  02  FILLER REDEFINES ERRMSGF.
   199		      03  ERRMSGA			     PIC X.
   200		  02  ERRMSGI				     PIC X(071).
   201		  02  DATEL				     PIC S9(4) COMP.
   202		  02  DATEF				     PIC X.
   203		  02  FILLER REDEFINES DATEF.
   204		      03  DATEA 			     PIC X.
   205		  02  DATEI				     PIC X(010).
   206		  02  TIMEL				     PIC S9(4) COMP.
   207		  02  TIMEF				     PIC X.
   208		  02  FILLER REDEFINES TIMEF.
   209		      03  TIMEA 			     PIC X.
   210		  02  TIMEI				     PIC X(008).
   211	      01  SM00MO REDEFINES SM00MI.
   212		  02  FILLER				     PIC X(12).
   213		  02  FILLER				     PIC XX.
   214		  02  FILLER				     PIC X.
   215		  02  OPTN01O				     PIC X(020).
   216		  02  FILLER				     PIC XX.
   217		  02  FILLER				     PIC X.
   218		  02  OPTN02O				     PIC X(020).
   219		  02  FILLER				     PIC XX.
   220		  02  FILLER				     PIC X.
   221		  02  OPTN03O				     PIC X(020).
   222		  02  FILLER				     PIC XX.
   223		  02  FILLER				     PIC X.
   224		  02  OPTN04O				     PIC X(020).
   225		  02  FILLER				     PIC XX.
   226		  02  FILLER				     PIC X.
   227		  02  OPTN05O				     PIC X(020).
   228		  02  FILLER				     PIC XX.
   229		  02  FILLER				     PIC X.
   230		  02  OPTN06O				     PIC X(020).
   231		  02  FILLER				     PIC XX.
   232		  02  FILLER				     PIC X.
   233		  02  OPTN07O				     PIC X(020).
   234		  02  FILLER				     PIC XX.
   235		  02  FILLER				     PIC X.
   236		  02  OPTIONO				     PIC X(001).
   237		  02  FILLER				     PIC XX.
   238		  02  FILLER				     PIC X.
   239		  02  TICKETO				     PIC X(006).
   240		  02  FILLER				     PIC XX.
   241		  02  FILLER				     PIC X.
   242		  02  ERRMSGO				     PIC X(071).
   243		  02  FILLER				     PIC XX.
   244		  02  FILLER				     PIC X.   245		  02  DATEO				     PIC X(010).
   246		  02  FILLER				     PIC XX.
   247		  02  FILLER				     PIC X.
   248		  02  TIMEO				     PIC X(008).
   250		  COPY DFHAID.
   252	      01  DFHAID.
   253	     *
   254	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   255	     *
   256	     * Revision Information
   257	     * ^{File:dfhaid.cob  }
   258	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   259	     * ^{Revision:2.0}
   260	     *
   261	     *This is the AID constants copy file
   262	     *
   263            05  DFHENTER                  PIC X VALUE ''''.
   264	     *					value APOST
   265            05  DFHCLEAR                  PIC X VALUE '_'.
   266            05  DFHPA1                    PIC X VALUE '%'.
   267            05  DFHPA2                    PIC X VALUE '>'.
   268            05  DFHPA3                    PIC X VALUE ','.
   269            05  DFHPF1                    PIC X VALUE '1'.
   270            05  DFHPF2                    PIC X VALUE '2'.
   271            05  DFHPF3                    PIC X VALUE '3'.
   272            05  DFHPF4                    PIC X VALUE '4'.
   273            05  DFHPF5                    PIC X VALUE '5'.
   274            05  DFHPF6                    PIC X VALUE '6'.
   275            05  DFHPF7                    PIC X VALUE '7'.
   276            05  DFHPF8                    PIC X VALUE '8'.
   277            05  DFHPF9                    PIC X VALUE '9'.
   278            05  DFHPF10                   PIC X VALUE ':'.
   279            05  DFHPF11                   PIC X VALUE '#'.
   280            05  DFHPF12                   PIC X VALUE '@'.
   281            05  DFHPF13                   PIC X VALUE 'A'.
   282            05  DFHPF14                   PIC X VALUE 'B'.
   283            05  DFHPF15                   PIC X VALUE 'C'.
   284            05  DFHPF16                   PIC X VALUE 'D'.
   285            05  DFHPF17                   PIC X VALUE 'E'.
   286            05  DFHPF18                   PIC X VALUE 'F'.
   287            05  DFHPF19                   PIC X VALUE 'G'.
   288            05  DFHPF20                   PIC X VALUE 'H'.
   289            05  DFHPF21                   PIC X VALUE 'I'.
   290            05  DFHPF22                   PIC X VALUE '›'.
   291       *                                  EBCDIC Cent sign x'4A'
   292       *                                  ASCII  Cent sign x'9B'
   293            05  DFHPF23                   PIC X VALUE '.'.
   294            05  DFHPF24                   PIC X VALUE '<'.
   295            05  DFHOPID                   PIC X VALUE 'W'.
   296            05  DFHMSRE                   PIC X VALUE 'X'.
   297            05  DFHTRIG                   PIC X VALUE '"'.
   298       *                                        value QUOTE  "
   299            05  DFHPEN                    PIC X VALUE '='.
   300            05  DFHCLRP                   PIC X VALUE 'Ý'.
   301       *                                  EBCDIC x'6A'
   302       *                                  ASCII  x'DD'
   303            05  DFHSTRF                   PIC X VALUE 'h'.
   304	     *	  DFHQUIT is a CA-Realia CICS Extension
   305	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   306            05  DFHQUIT                   PIC X VALUE '!'.   307		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   309		  COPY DFHBMSCA.
   311	      01  DFHBMSCA.
   312	     *
   313	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   314	     *
   315	     * Revision Information
   316	     * ^{File:dfhbmsca.cob}
   317	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   318	     * ^{Revision:2.0}
   319	     *
   320	     *	Note:This FILE is provided with most values as quoted literals
   321	     *	     so that the file can be used for both ASCII and EBCDIC
   322	     *	     programs
   323	     *
   324	     *	     The only exceptions are some 3270 Data Stream Orders
   325	     *	     They use different Hexadecimal values for ASCII and
   326	     *	     EBCDIC and they cannot be expressed as quoted literals
   327	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   328	     *	     characters in ASCII
   329	     *
   330	     *	     They have their values set up to default to the EBCDIC
   331	     *	     values.
   332	     *
   333	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   334	     *	     and SEND TEXT with imbedded format orders.
   335	     *	     If you use these values in ASCII programs the values
   336	     *	     must be changed.
   337	     *
   338	     *	     An alternative is to use REPLACING to change the values.
   339	     *
   340	     *	  i.e. COPY DFHBMSCA replacing
   341	     *			    ==005== BY ==009==	*> DFHPT
   342	     *			    ==021== BY ==010==	*> DFHNL
   343	     *			    ==040== BY ==021==	*> DFHSA
   344	     *			    ==041== BY ==031==	*> DFHSFE
   345	     *			    ==044== BY ==023==	*> DFHMF
   346	     *			    ==060== BY ==020==	*> DFHRA
   347	     *			    ==063== BY ==026==. *> DFHSUB
   348	     *
   349	     ******************************************************************
   350	     *BMS and Terminal Control - Order & Attributes constants	      *
   351	     ******************************************************************
   352	     *
   353	     *	  Field Attributes
   354	     *
   355            05  DFHBMASB                          PIC X VALUE '8'.
   356            05  DFHBMASF                          PIC X VALUE '1'.
   357            05  DFHBMASK                          PIC X VALUE '0'.
   358            05  DFHBMBRY                          PIC X VALUE 'H'.
   359            05  DFHBMDAR                          PIC X VALUE '<'.
   360            05  DFHBMFSE                          PIC X VALUE 'A'.
   361            05  DFHBMPRF                          PIC X VALUE '/'.
   362            05  DFHBMPRO                          PIC X VALUE '-'.
   363            05  DFHBMUNN                          PIC X VALUE '&'.
   364            05  DFHBMUNP                          PIC X VALUE ' '.
   365            05  DFHUNNUM                          PIC X VALUE 'J'.
   366	     *
   367	     *	  partially supported
   368	     *   369            05  DFHUNNOD                          PIC X VALUE '('.
   370            05  DFHUNIMD                          PIC X VALUE 'I'.
   371            05  DFHUNINT                          PIC X VALUE 'R'.
   372            05  DFHUNNON                          PIC X VALUE '('.
   373            05  DFHPROTI                          PIC X VALUE 'Y'.
   374            05  DFHPROTN                          PIC X VALUE '%'.
   375	     *
   376	     *	  These values are additions to mainframe constants
   377	     *
   378            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   379            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   380            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   381	     *						      VALUE APOST
   382            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   383            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   384            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   385            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   386            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   387	     *
   388	     *	  Field Flag values
   389		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   390		  05  FILLER REDEFINES DFHBMEOF-VAL.
   391		      10  FILLER			PIC X.
   392		      10  DFHBMEOF			PIC X.
   393       *                                          x'80'.
   394		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   395		  05  FILLER REDEFINES DFHBMCUR-VAL.
   396		      10  FILLER			PIC X.
   397		      10  DFHBMCUR			PIC X.
   398       *                                          x'02'.
   399		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   400		  05  FILLER REDEFINES DFHBMMEC-VAL.
   401		      10  FILLER			PIC X.
   402		      10  DFHBMMEC			PIC X.
   403       *                                          x'82'.
   404       *                                          x'02'.
   405		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   406		      88  DFHERASE			VALUES 128 130.
   407       *                                          x'80' X'82'
   408		      88  DFHCURSR			VALUES 002 130.
   409       *                                          x'02' X'82'
   410		  05  FILLER REDEFINES DFHBMFLG-VAL.
   411		      10  FILLER			PIC X.
   412		      10  DFHBMFLG			PIC X.
   413
   414		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   415		  05  FILLER REDEFINES DFHBMDUP-VAL.
   416		      10  FILLER			PIC X.
   417		      10  DFHBMDUP			PIC X.
   418       *                                              x'1C'
   419	     *
   420	     ******************************************************************
   421	     *	  supported 327X Extended Attributes
   422	     *
   423	     *	  Extended COLOR Attributes
   424	     *
   425            05  DFHDFCOL                          PIC X VALUE '0'.
   426            05  DFHBLUE                           PIC X VALUE '1'.
   427            05  DFHRED                            PIC X VALUE '2'.
   428            05  DFHPINK                           PIC X VALUE '3'.   429            05  DFHGREEN                          PIC X VALUE '4'.
   430            05  DFHTURQ                           PIC X VALUE '5'.
   431            05  DFHYELLO                          PIC X VALUE '6'.
   432            05  DFHNEUTR                          PIC X VALUE '7'.
   433	     *
   434	     *	  Extended HILIGHT Attributes
   435	     *
   436            05  DFHDFHI                           PIC X VALUE '0'.
   437            05  DFHBLINK                          PIC X VALUE '1'.
   438            05  DFHREVRS                          PIC X VALUE '2'.
   439            05  DFHUNDLN                          PIC X VALUE '4'.
   440	     *
   441	     ******************************************************************
   442	     *	  supported 327X Data Stream Orders
   443	     *
   444		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   445		  05  FILLER REDEFINES DFHSBA-VAL.
   446		      10  FILLER			PIC X.
   447		      10  DFHSBA			PIC X.
   448       *                                              x'11'
   449		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   450		  05  FILLER REDEFINES DFHEUA-VAL.
   451		      10  FILLER			PIC X.
   452		      10  DFHEUA			PIC X.
   453       *                                              x'12'
   454		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   455		  05  FILLER REDEFINES DFHIC-VAL.
   456		      10  FILLER			PIC X.
   457		      10  DFHIC 			PIC X.
   458       *                                              X'13'.
   459		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   460		  05  FILLER REDEFINES DFHSF-VAL.
   461		      10  FILLER			PIC X.
   462		      10  DFHSF 			PIC X.
   463       *                                              X'1D'.
   464		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   465		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   466		      88 DFHPT-VAL-ASCII		VALUE 9.
   467		  05  FILLER REDEFINES DFHPT-VAL.
   468		      10  FILLER			PIC X.
   469		      10  DFHPT 			PIC X.
   470       *                                              EBCDIC X'05'.
   471       *                                              ASCII  X'09'.
   472		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   473		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   474		      88 DFHRA-VAL-ASCII		VALUE 20.
   475		  05  FILLER REDEFINES DFHRA-VAL.
   476		      10  FILLER			PIC X.
   477		      10  DFHRA 			PIC X.
   478       *                                              EBCDIC x'3C'
   479       *                                              ASCII  x'14'
   480		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   481		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   482		      88 DFHSFE-VAL-ASCII		VALUE 31.
   483		  05  FILLER REDEFINES DFHSFE-VAL.
   484		      10  FILLER			PIC X.
   485		      10  DFHSFE			PIC X.
   486       *                                              EBCDIC x'29'
   487       *                                              ASCII  x'1F'
   488		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.   489		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   490		      88 DFHMF-VAL-ASCII		VALUE 23.
   491		  05  FILLER REDEFINES DFHMF-VAL.
   492		      10  FILLER			PIC X.
   493		      10  DFHMF 			PIC X.
   494       *                                              EBCDIC x'2C'
   495       *                                              ASCII  x'17'
   496	     *
   497	     ******************************************************************
   498	     *	  unsupported 327X Data Stream order codes
   499	     *
   500		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   501		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   502		      88 DFHSA-VAL-ASCII		VALUE 21.
   503		  05  FILLER REDEFINES DFHSA-VAL.
   504		      10  FILLER			PIC X.
   505		      10  DFHSA 			PIC X.
   506       *                                              EBCDIC x'28'
   507       *                                              ASCII  x'15'
   508		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   509		  05  FILLER REDEFINES DFHGE-VAL.
   510		      10  FILLER			PIC X.
   511		      10  DFHGE 			PIC X.
   512       *                                              X'08'.
   513	     *
   514	     ******************************************************************
   515	     *	  SFE and MF supported attribute types
   516	     *
   517            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   518       *                                              EBCDIC x'42'
   519       *                                              ASCII  x'83'
   520            05  DFHHLT                            PIC X VALUE 'Ö'.
   521       *                                              EBCDIC x'41'
   522       *                                              ASCII  x'D6'
   523            05  DFH3270                           PIC X VALUE '{'.
   524	     *
   525	     *	  supported for SEND TEXT command and printer terminal
   526	     *
   527		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   528		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   529		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   530		  05  FILLER REDEFINES DFHBMPNL-VAL.
   531		      10  FILLER			PIC X.
   532		      10  DFHBMPNL			PIC X.
   533       *                                              EBCDIC X'15'.
   534       *                                              ASCII  X'0A'.
   535	     *
   536	     ******************************************************************
   537	     *	  Printer terminal data stream only
   538	     *
   539		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   540		  05  FILLER REDEFINES DFHBMPFF-VAL.
   541		      10  FILLER			PIC X.
   542		      10  DFHBMPFF			PIC X.
   543       *                                              X'0C'.
   544		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   545		  05  FILLER REDEFINES DFHBMPCR-VAL.
   546		      10  FILLER			PIC X.
   547		      10  DFHBMPCR			PIC X.
   548       *                                              X'0D'.   549		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   550		  05  FILLER REDEFINES DFHBMPEM-VAL.
   551		      10  FILLER			PIC X.
   552		      10  DFHBMPEM			PIC X.
   553       *                                              X'19'.
   554	     *
   555	     ******************************************************************
   556	     *	  unsupported Miscellaneous attributes and constants
   557	     *
   558		  05  DFHALL				PIC X VALUE LOW-VALUES.
   559            05  DFHBASE                           PIC X VALUE '0'.
   560		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   561		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   562		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   563		      10  DFHBMPSO			PIC X.
   564       *                                              X'0E'.
   565		      10  DFHBMPSI			PIC X.
   566       *                                              X'0F'.
   567		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   568            05  DFHERROR                          PIC X VALUE '¶'.
   569       *                                              EBCDIC X'1A'.
   570       *                                              ASCII  X'B6'.
   571            05  DFHFIL                            PIC X VALUE '4'.
   572            05  DFHMENT                           PIC X VALUE '2'.
   573            05  DFHMET                            PIC X VALUE '3'.
   574            05  DFHMFE                            PIC X VALUE '6'.
   575            05  DFHMFET                           PIC X VALUE '7'.
   576            05  DFHMFT                            PIC X VALUE '5'.
   577            05  DFHMT                             PIC X VALUE '1'.
   578            05  DFHOUTLN                          PIC X VALUE 'B'.
   579            05  DFHPS                             PIC X VALUE '„'.
   580       *                                              EBCDIC x'43'
   581       *                                              ASCII  x'84'
   582            05  DFHVAL                            PIC X VALUE 'A'.
   583	     *
   584		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   585		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   586		      88 DFHSUB-VAL-ASCII		VALUE 26.
   587		  05  FILLER REDEFINES DFHSUB-VAL.
   588		      10  FILLER			PIC X.
   589		      10  DFHSUB			PIC X.
   590       *                                              EBCDIC X'3F'.
   591       *                                              ASCII  X'1A'.
   592	     *
   593		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   594		  05  FILLER REDEFINES DFHFM-VAL.
   595		      10  FILLER			PIC X.
   596		      10  DFHFM 			PIC X.
   597       *                                              EBCDIC X'1E'.
   598		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   600
   601	      LINKAGE SECTION.
   603	      01  DFHEIBLK.						       R
   604		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   605		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   606		  05 EIBTRNID PIC X(4). 				       R
   607		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   608		  05 EIBTRMID PIC X(4). 				       R
   609		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   610		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R   611		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   612		  05 EIBAID   PIC X.					       R
   613		  05 EIBFN    PIC X(2). 				       R
   614		  05 EIBRCODE PIC X(6). 				       R
   615		  05 EIBDS    PIC X(8). 				       R
   616		  05 EIBREQID PIC X(8). 				       R
   617		  05 EIBRSRCE PIC X(8). 				       R
   618		  05 EIBSYNC  PIC X.					       R
   619		  05 EIBFREE  PIC X.					       R
   620		  05 EIBRECV  PIC X.					       R
   621		  05 EIBSEND  PIC X.					       R
   622		  05 EIBATT   PIC X.					       R
   623		  05 EIBEOC   PIC X.					       R
   624		  05 EIBFMH   PIC X.					       R
   625		  05 EIBCOMPL PIC X.					       R
   626		  05 EIBSIG   PIC X.					       R
   627		  05 EIBCONF  PIC X.					       R
   628		  05 EIBERR   PIC X.					       R
   629		  05 EIBERRCD PIC X(4). 				       R
   630		  05 EIBSYNRB PIC X.					       R
   631		  05 EIBNODAT PIC X.					       R
   632		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   633		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   634		  05 EIBRLDBK PIC X.					       R
   635		  05 EIBCARESERVED PIC X(32).				       R
   637	       01  DFHCOMMAREA.
   638		  05 DF-PGMID				PIC X(06).
   639		  05 DF-STATE				PIC X.
   640		  05 DF-TICKET-PASSED			PIC X(07).
   641		  05 DF-USERID.
   642		     10  DF-USERID7			PIC X(7).
   643		     10  FILLER 			PIC X(1).
   644		  05 DF-USR-TYPE.
   645		    15 DF-USR-REQUESTOR 		PIC X.
   646		    15 DF-USR-ADMIN			PIC X.
   647		    15 DF-USR-APPROVER			PIC X.
   648		    15 DF-USR-SERVICE			PIC X.
   649		  05 DF-SM012-STATE			PIC X.
   650		  05 DF-SM012-PGMID			PIC X(06).
   651	     *	  05 DF-TICKET-REC.
   652	     *	     10 DF-TICKET-ID			   PIC 9(07).
   653	     *	     10 DF-TICKET-KEY-NUM REDEFINES DF-TICKET-ID PIC 9(06).
   654	     *	     10 DF-TICKET-REQUESTOR		      PIC X(08).
   655	     *	     10 DF-TICKET-STATUS		      PIC X(10).
   656	     *	     10 DF-TICKET-TITLE 		      PIC X(25).
   657	     *	     10 DF-TICKET-DESC			      PIC X(100).
   658	     *	     10 DF-TICKET-LAST-UPD		      PIC X(20).
   659	     *	     10 DF-TICKET-LAST-UPD-BY		      PIC X(08).
   660	     *	     10 DF-TICKET-UPD-REMARKS		      PIC X(50).
   661
   662	      PROCEDURE DIVISION					       R
   664		  USING DFHEIBLK DFHCOMMAREA.				       R
   689	      100-PROCESS.
   691		  EXEC CICS IGNORE CONDITION
   692			    ERROR
   693		  END-EXEC
   708		  PERFORM 300-VERIFY-USER
   709
   710       *    IF EIBTRNID = 'SM00'
   711   712		     MOVE DFHCOMMAREA TO WS-COMMAREA
   713            IF WS-PGMID = 'SM000' OR WS-PGMID = 'SM001' OR
   714               WS-PGMID = 'SM002' OR WS-PGMID = 'SM003' OR
   715               WS-PGMID = 'SM004' OR WS-PGMID = 'SM005' OR
   716               WS-PGMID = 'SM006' OR EIBTRNID = 'SM00'
   717			MOVE WS-TYPE TO USR-TYPE
   718			MOVE WS-USERID TO USERID
   719	     *		IF EIBCALEN NOT = +0
   720			IF WS-STATE NOT = LOW-VALUES
   721			   PERFORM 200-REC-MAP
   722			ELSE
   723                     MOVE 'ENTER OPTION AND PRESS ENTER' TO ERRMSGO
   724			   MOVE 1 TO WS-STATE
   725			   PERFORM 110-VERIFY-ROLE
   726			END-IF
   727
   728		  ELSE
   729		     MOVE SPACES TO ERRMSGO
   731		     EXEC CICS SEND TEXT
   732			     FROM (WS-INVALID-TRNID)
   733			     LENGTH (+15)
   734			     ERASE
   735			END-EXEC
   766		     EXEC CICS RETURN
   767		     END-EXEC
   780		  END-IF.
   781	      100-EXIT.
   782		  EXIT.
   783
   784	      110-VERIFY-ROLE.
   785		  EVALUATE WS-TYPE
   786            WHEN 'YYYY'
   787            WHEN 'YYYN'
   788		       PERFORM 111-NEW-MAP
   789            WHEN 'YNNN'
   790            WHEN 'YNNY'
   791                 MOVE '5 - CANCEL TICKET' TO OPTN05I
   792		       MOVE SPACE TO OPTN06I
   793		       MOVE SPACES TO OPTN07I
   794		       PERFORM 111-NEW-MAP
   795            WHEN 'YYNN'
   796            WHEN 'YYNY'
   797                 MOVE '5 - CANCEL TICKET' TO OPTN05I
   798                 MOVE '6 - USER MAINTENANCE' TO OPTN06I
   799		       MOVE SPACES TO OPTN07I
   800		       PERFORM 111-NEW-MAP
   801            WHEN 'YNYN'
   802            WHEN 'YNYY'
   803		       MOVE SPACES TO OPTN07I
   804		       PERFORM 111-NEW-MAP
   805            WHEN 'NYYY'
   806                 MOVE '2 - UPDATE TICKET' TO OPTN02I
   807                 MOVE '3 - APPROVE TICKET' TO OPTN03I
   808                 MOVE '4 - USER MAINTENANCE' TO OPTN04I
   809		       MOVE SPACES TO OPTN05I
   810		       MOVE SPACE TO OPTN06I
   811		       MOVE SPACES TO OPTN07I
   812		       PERFORM 111-NEW-MAP
   813            WHEN 'NNYY'
   814                 MOVE '2 - UPDATE TICKET' TO OPTN02I   815                 MOVE '3 - APPROVE TICKET' TO OPTN03I
   816		       MOVE SPACES TO OPTN04I
   817		       MOVE SPACES TO OPTN05I
   818		       MOVE SPACE TO OPTN06I
   819		       MOVE SPACES TO OPTN07I
   820		       PERFORM 111-NEW-MAP
   821            WHEN 'NNNY'
   822                 MOVE '2 - UPDATE TICKET' TO OPTN02I
   823		       MOVE SPACES TO OPTN03I
   824		       MOVE SPACES TO OPTN04I
   825		       MOVE SPACES TO OPTN05I
   826		       MOVE SPACE TO OPTN06I
   827		       MOVE SPACES TO OPTN07I
   828		       PERFORM 111-NEW-MAP
   829            WHEN 'NYNY'
   830                 MOVE '2 - UPDATE TICKET' TO OPTN02I
   831                 MOVE '3 - USER MAINTENANCE' TO OPTN03I
   832		       MOVE SPACES TO OPTN04I
   833		       MOVE SPACES TO OPTN05I
   834		       MOVE SPACE TO OPTN06I
   835		       MOVE SPACES TO OPTN07I
   836		       PERFORM 111-NEW-MAP
   837            WHEN 'NYYN'
   838                 MOVE '2 - APPROVE TICKET' TO OPTN02I
   839                 MOVE '3 - USER MAINTENANCE' TO OPTN03I
   840		       MOVE SPACES TO OPTN04I
   841		       MOVE SPACES TO OPTN05I
   842		       MOVE SPACE TO OPTN06I
   843		       MOVE SPACES TO OPTN07I
   844		       PERFORM 111-NEW-MAP
   845            WHEN 'NYNN'
   846                 MOVE '1 - USER MAINTENANCE' TO OPTN01I
   847		       MOVE SPACES TO OPTN02I
   848		       MOVE SPACES TO OPTN03I
   849		       MOVE SPACES TO OPTN04I
   850		       MOVE SPACES TO OPTN05I
   851		       MOVE SPACE TO OPTN06I
   852		       MOVE SPACES TO OPTN07I
   853		       PERFORM 111-NEW-MAP
   854            WHEN 'NNYN'
   855                 MOVE '2 - APPROVE TICKET' TO OPTN02I
   856		       MOVE SPACES TO OPTN03I
   857		       MOVE SPACES TO OPTN04I
   858		       MOVE SPACES TO OPTN05I
   859		       MOVE SPACE TO OPTN06I
   860		       MOVE SPACES TO OPTN07I
   861		       PERFORM 111-NEW-MAP
   862            WHEN 'NNNN'
   863		       MOVE SPACES TO OPTN01I
   864				      OPTN02I
   865				      OPTN03I
   866				      OPTN04I
   867				      OPTN05I
   868				      OPTN06I
   869				      OPTN07I
   870		       PERFORM 111-NEW-MAP
   871		  WHEN OTHER
   872		       MOVE SPACES TO ERRMSGO
   874		       EXEC CICS SEND TEXT
   875			    FROM (WS-INVALID-TRNID)   876			    LENGTH (+15)
   877			    ERASE
   878		       END-EXEC
   909		       EXEC CICS RETURN
   910		       END-EXEC
   923		  END-EVALUATE.
   924	      110-EXIT.
   925		  EXIT.
   926
   927	      112-DATE-TIME.
   928		  MOVE EIBDATE TO WS-DATE.
   929		  MOVE WS-DATE-X TO DATEO.
   931		  EXEC CICS ASKTIME
   932		       ABSTIME	  (WS-TIME)
   933		  END-EXEC
   952		  EXEC CICS FORMATTIME
   953		       ABSTIME	  (WS-TIME)
   954                 DATESEP    ('/')
   955		       MMDDYYYY   (DATEO)
   956		       TIME	  (TIMEO)
   957                 TIMESEP    (':')
   958		  END-EXEC
   998		  MOVE DFHBMASB TO TIMEA
   999		  MOVE DFHBMASB TO DATEA.
  1000	      112-EXIT.
  1001		  EXIT.
  1002
  1003	      111-NEW-MAP.
  1004		  PERFORM 112-DATE-TIME
  1005
  1006		  MOVE DFHUNIMD TO OPTIONA
  1007		  MOVE DFHUNIMD TO TICKETA
  1008		  MOVE -1	TO OPTIONL
  1009		  MOVE LENGTH OF SM00MO TO WS-LENGTH
  1011		  EXEC CICS SEND
  1012                 MAP('SM00M')
  1013                 MAPSET('SM00S')
  1014		       FROM(SM00MO)
  1015		       LENGTH(WS-LENGTH)
  1016		       CURSOR
  1017		       ERASE
  1018		  END-EXEC
  1064		  EXEC CICS RETURN
  1065                 TRANSID('SM00')
  1066		       COMMAREA(WS-COMMAREA)
  1067		  END-EXEC.
  1092	      110-EXIT.
  1093		  EXIT.
  1094
  1095	      200-REC-MAP.
  1097		  EXEC CICS RECEIVE
  1098                 MAP('SM00M')
  1099                 MAPSET('SM00S')
  1100		       INTO (SM00MI)
  1101		  END-EXEC
  1135		  IF EIBRESP = DFHRESP(MAPFAIL)
  1137		  IF EIBRESP =	       036				       R
  1138		     MOVE WS-INVALID-PFKEY TO ERRMSGO
  1139		     PERFORM 110-VERIFY-ROLE
  1140		  END-IF.  1141		  PERFORM 400-CHECK-EIBAID.
  1142	      200-EXIT.
  1143		  EXIT.
  1144
  1145	      21A-SEARCH-SM001.
  1146             MOVE 'SM000' TO WS-PGMID
  1147		  MOVE LOW-VALUES TO WS-STATE
  1148		  MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1150		  EXEC CICS XCTL
  1151                 PROGRAM('SM001')
  1152		       COMMAREA(WS-COMMAREA)
  1153		       LENGTH(WS-LENGTH)
  1154		  END-EXEC.
  1185	      21A-EXIT.
  1186		  EXIT.
  1187
  1188	      21B-SUBMIT-SM002.
  1189             MOVE 'SM000' TO WS-PGMID
  1190		  MOVE LOW-VALUES TO WS-STATE
  1191		  MOVE TICKETI TO WS-TICKET-PASSED
  1192		  MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1194		  EXEC CICS XCTL
  1195                 PROGRAM('SM002')
  1196		       COMMAREA(WS-COMMAREA)
  1197		       LENGTH(WS-LENGTH)
  1198		  END-EXEC.
  1229	      21B-EXIT.
  1230		  EXIT.
  1231
  1232	      21C-UPDATE-SM003.
  1233             MOVE 'SM000' TO WS-PGMID
  1234		  MOVE LOW-VALUES TO WS-STATE
  1235		  MOVE TICKETI TO WS-TICKET-PASSED
  1236		  MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1238		  EXEC CICS XCTL
  1239                 PROGRAM('SM003')
  1240		       COMMAREA(WS-COMMAREA)
  1241		       LENGTH(WS-LENGTH)
  1242		       RESP(WS-RETNCODE)
  1243		  END-EXEC.
  1280	      21C-EXIT.
  1281		  EXIT.
  1282
  1283	      21D-CLOSE-SM004.
  1284            MOVE 'SM000' TO WS-PGMID
  1285		  MOVE LOW-VALUES TO WS-STATE
  1286		  MOVE TICKETI TO WS-TICKET-PASSED
  1287		  MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1289		  EXEC CICS XCTL
  1290                 PROGRAM('SM004')
  1291		       COMMAREA(WS-COMMAREA)
  1292		       LENGTH(WS-LENGTH)
  1293		       RESP(WS-RETNCODE)
  1294		  END-EXEC.
  1331	      21D-EXIT.
  1332		  EXIT.
  1333
  1334	      21E-APPROVE-SM005.
  1335            MOVE 'SM000' TO WS-PGMID
  1336		  IF TICKETI = LOW-VALUES  1337		     MOVE LOW-VALUES TO WS-STATE
  1338		  ELSE
  1339		     MOVE 1 TO WS-STATE
  1340		     MOVE TICKETI TO WS-TICKET-PASSED
  1341		  END-IF
  1342		  MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1344		  EXEC CICS XCTL
  1345                 PROGRAM('SM005')
  1346		       COMMAREA(WS-COMMAREA)
  1347		       LENGTH(WS-LENGTH)
  1348		       RESP(WS-RETNCODE)
  1349		  END-EXEC.
  1386	      21R-EXIT.
  1387		  EXIT.
  1388
  1389	      21F-CANCEL-SM006.
  1390            MOVE 'SM000' TO WS-PGMID
  1391		  MOVE TICKETI TO WS-TICKET-PASSED
  1392		  MOVE LOW-VALUES TO WS-STATE
  1393		  IF TICKETI NOT = LOW-VALUES OR SPACES
  1394		     PERFORM 500-CHECK-TICKET
  1395	     *	     MOVE WS-TICKET-REC TO COMM-TICKET-REC
  1396		     MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1398		     EXEC CICS XCTL
  1399                    PROGRAM('SM006')
  1400			  COMMAREA(WS-COMMAREA)
  1401			  LENGTH(WS-LENGTH)
  1402		     END-EXEC
  1432		  ELSE
  1433		     MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1435		     EXEC CICS XCTL
  1436                    PROGRAM('SM006')
  1437			  COMMAREA(WS-COMMAREA)
  1438			  LENGTH(WS-LENGTH)
  1439		     END-EXEC
  1469		  END-IF.
  1470	      21F-EXIT.
  1471		  EXIT.
  1472
  1473	      21G-ADMIN-UA001.
  1474            MOVE 'SM000' TO WS-PGMID
  1476		  EXEC CICS LINK
  1477                 PROGRAM('UA001')
  1478		       COMMAREA(WS-COMMAREA)
  1479		       LENGTH(WS-LENGTH)
  1480		       RESP(WS-RETNCODE)
  1481		  END-EXEC
  1518            MOVE 'UA001' TO ERRMSGO.
  1519	      21G-EXIT.
  1520		  EXIT.
  1521
  1522	      21H-F3-EXIT.
  1523		  MOVE SPACES TO ERRMSGO
  1525		  EXEC CICS SEND TEXT
  1526		       FROM (WS-END)
  1527		       LENGTH (+15)
  1528		       ERASE
  1529		  END-EXEC
  1560		  EXEC CICS RETURN
  1561		  END-EXEC.  1575	      21H-EXIT.
  1576		  EXIT.
  1577
  1578	      300-VERIFY-USER.
  1580		  EXEC CICS ASSIGN
  1581		      USERID(WS-USERID)
  1582		  END-EXEC
  1601		  EXEC CICS
  1602                 READ FILE('uaf001')
  1603		       INTO (WS-REC)
  1604		       RIDFLD (WS-USERID)
  1605		       KEYLENGTH (WS-STD-KEY-LEN)
  1606		       EQUAL
  1607		  END-EXEC
  1646		  IF EIBRESP = DFHRESP(NOTFND)
  1648		  IF EIBRESP =	       013				       R
  1650		      EXEC CICS SEND TEXT
  1651			   FROM (WS-INVALID-USER)
  1652			   LENGTH (+20)
  1653			   ERASE
  1654		      END-EXEC
  1685		      EXEC CICS RETURN
  1686		      END-EXEC
  1699		  END-IF.
  1700	      300-EXIT.
  1701		  EXIT.
  1702
  1703	      400-CHECK-EIBAID.
  1704		  EVALUATE WS-TYPE
  1705            WHEN 'YYYY'
  1706            WHEN 'YYYN'
  1707		       EVALUATE EIBAID
  1708		       WHEN DFHPF3
  1709			    PERFORM 21H-F3-EXIT
  1710		       WHEN DFHENTER
  1711			    EVALUATE OPTIONI
  1712			    WHEN 1
  1713				 PERFORM 21A-SEARCH-SM001
  1714			    WHEN 2
  1715				 PERFORM 21B-SUBMIT-SM002
  1716			    WHEN 3
  1717				 PERFORM 21C-UPDATE-SM003
  1718			    WHEN 4
  1719				 PERFORM 21D-CLOSE-SM004
  1720			    WHEN 5
  1721				 PERFORM 21E-APPROVE-SM005
  1722			    WHEN 6
  1723				 PERFORM 21F-CANCEL-SM006
  1724			    WHEN 7
  1725				 PERFORM 21G-ADMIN-UA001
  1726			    WHEN DFHNULL
  1727				 MOVE WS-FIELD-REQ TO ERRMSGO
  1728			    WHEN OTHER
  1729                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1730			    END-EVALUATE
  1731		       WHEN OTHER
  1732                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1733		       END-EVALUATE
  1734            WHEN 'YNNN'
  1735            WHEN 'YNNY'  1736		       EVALUATE EIBAID
  1737		       WHEN DFHPF3
  1738			    PERFORM 21H-F3-EXIT
  1739		       WHEN DFHENTER
  1740			    EVALUATE OPTIONI
  1741			    WHEN 1
  1742				 PERFORM 21A-SEARCH-SM001
  1743			    WHEN 2
  1744				 PERFORM 21B-SUBMIT-SM002
  1745			    WHEN 3
  1746				 PERFORM 21C-UPDATE-SM003
  1747			    WHEN 4
  1748				 PERFORM 21D-CLOSE-SM004
  1749			    WHEN 5
  1750				 PERFORM 21F-CANCEL-SM006
  1751			    WHEN DFHNULL
  1752				 MOVE WS-FIELD-REQ TO ERRMSGO
  1753			    WHEN OTHER
  1754                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1755			    END-EVALUATE
  1756		       WHEN OTHER
  1757                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1758		       END-EVALUATE
  1759            WHEN 'YYNN'
  1760            WHEN 'YYNY'
  1761		       EVALUATE EIBAID
  1762		       WHEN DFHPF3
  1763			    PERFORM 21H-F3-EXIT
  1764		       WHEN DFHENTER
  1765			    EVALUATE OPTIONI
  1766			    WHEN 1
  1767				 PERFORM 21A-SEARCH-SM001
  1768			    WHEN 2
  1769				 PERFORM 21B-SUBMIT-SM002
  1770			    WHEN 3
  1771				 PERFORM 21C-UPDATE-SM003
  1772			    WHEN 4
  1773				 PERFORM 21D-CLOSE-SM004
  1774			    WHEN 5
  1775				 PERFORM 21F-CANCEL-SM006
  1776			    WHEN 6
  1777				 PERFORM 21G-ADMIN-UA001
  1778			    WHEN DFHNULL
  1779				 MOVE WS-FIELD-REQ TO ERRMSGO
  1780			    WHEN OTHER
  1781                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1782			    END-EVALUATE
  1783		       WHEN OTHER
  1784                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1785		       END-EVALUATE
  1786            WHEN 'YNYN'
  1787            WHEN 'YNYY'
  1788		       EVALUATE EIBAID
  1789		       WHEN DFHPF3
  1790			    PERFORM 21H-F3-EXIT
  1791		       WHEN DFHENTER
  1792			    EVALUATE OPTIONI
  1793			    WHEN 1
  1794				 PERFORM 21A-SEARCH-SM001
  1795			    WHEN 2  1796				 PERFORM 21B-SUBMIT-SM002
  1797			    WHEN 3
  1798				 PERFORM 21C-UPDATE-SM003
  1799			    WHEN 4
  1800				 PERFORM 21D-CLOSE-SM004
  1801			    WHEN 5
  1802				 PERFORM 21E-APPROVE-SM005
  1803			    WHEN 6
  1804				 PERFORM 21F-CANCEL-SM006
  1805			    WHEN DFHNULL
  1806				 MOVE WS-FIELD-REQ TO ERRMSGO
  1807			    WHEN OTHER
  1808                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1809			    END-EVALUATE
  1810		       WHEN OTHER
  1811                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1812		       END-EVALUATE
  1813            WHEN 'NYYY'
  1814		       EVALUATE EIBAID
  1815		       WHEN DFHPF3
  1816			    PERFORM 21H-F3-EXIT
  1817		       WHEN DFHENTER
  1818			    EVALUATE OPTIONI
  1819			    WHEN 1
  1820				 PERFORM 21A-SEARCH-SM001
  1821			    WHEN 2
  1822				 PERFORM 21C-UPDATE-SM003
  1823			    WHEN 3
  1824				 PERFORM 21E-APPROVE-SM005
  1825			    WHEN 4
  1826				 PERFORM 21G-ADMIN-UA001
  1827			    WHEN DFHNULL
  1828				 MOVE WS-FIELD-REQ TO ERRMSGO
  1829			    WHEN OTHER
  1830                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1831			    END-EVALUATE
  1832		       WHEN OTHER
  1833                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1834		       END-EVALUATE
  1835            WHEN 'NNYY'
  1836		       EVALUATE EIBAID
  1837		       WHEN DFHPF3
  1838			    PERFORM 21H-F3-EXIT
  1839		       WHEN DFHENTER
  1840			    EVALUATE OPTIONI
  1841			    WHEN 1
  1842				 PERFORM 21A-SEARCH-SM001
  1843			    WHEN 2
  1844				 PERFORM 21C-UPDATE-SM003
  1845			    WHEN 3
  1846				 PERFORM 21E-APPROVE-SM005
  1847			    WHEN DFHNULL
  1848				 MOVE WS-FIELD-REQ TO ERRMSGO
  1849			    WHEN OTHER
  1850                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1851			    END-EVALUATE
  1852		       WHEN OTHER
  1853                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1854		       END-EVALUATE
  1855            WHEN 'NNNY'  1856			EVALUATE EIBAID
  1857		       WHEN DFHPF3
  1858			    PERFORM 21H-F3-EXIT
  1859		       WHEN DFHENTER
  1860			    EVALUATE OPTIONI
  1861			    WHEN 1
  1862				 PERFORM 21A-SEARCH-SM001
  1863			    WHEN 2
  1864				 PERFORM 21C-UPDATE-SM003
  1865			    WHEN DFHNULL
  1866				 MOVE WS-FIELD-REQ TO ERRMSGO
  1867			    WHEN OTHER
  1868                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1869			    END-EVALUATE
  1870		       WHEN OTHER
  1871                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1872		       END-EVALUATE
  1873            WHEN 'NYNY'
  1874		       EVALUATE EIBAID
  1875		       WHEN DFHPF3
  1876			    PERFORM 21H-F3-EXIT
  1877		       WHEN DFHENTER
  1878			    EVALUATE OPTIONI
  1879			    WHEN 1
  1880				 PERFORM 21A-SEARCH-SM001
  1881			    WHEN 2
  1882				 PERFORM 21C-UPDATE-SM003
  1883			    WHEN 3
  1884				 PERFORM 21G-ADMIN-UA001
  1885			    WHEN DFHNULL
  1886				 MOVE WS-FIELD-REQ TO ERRMSGO
  1887			    WHEN OTHER
  1888                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1889			    END-EVALUATE
  1890		       WHEN OTHER
  1891                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1892		       END-EVALUATE
  1893            WHEN 'NYYN'
  1894		       EVALUATE EIBAID
  1895		       WHEN DFHPF3
  1896			    PERFORM 21H-F3-EXIT
  1897		       WHEN DFHENTER
  1898			    EVALUATE OPTIONI
  1899			    WHEN 1
  1900				 PERFORM 21A-SEARCH-SM001
  1901			    WHEN 2
  1902				 PERFORM 21E-APPROVE-SM005
  1903			    WHEN 3
  1904				 PERFORM 21G-ADMIN-UA001
  1905			    WHEN DFHNULL
  1906				 MOVE WS-FIELD-REQ TO ERRMSGO
  1907			    WHEN OTHER
  1908                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1909			    END-EVALUATE
  1910		       WHEN OTHER
  1911                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1912		       END-EVALUATE
  1913            WHEN 'NYNN'
  1914		       EVALUATE EIBAID
  1915		       WHEN DFHPF3  1916			    PERFORM 21H-F3-EXIT
  1917		       WHEN DFHENTER
  1918			    EVALUATE OPTIONI
  1919			    WHEN 1
  1920				 PERFORM 21G-ADMIN-UA001
  1921			    WHEN DFHNULL
  1922				 MOVE WS-FIELD-REQ TO ERRMSGO
  1923			    WHEN OTHER
  1924                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1925			    END-EVALUATE
  1926		       WHEN OTHER
  1927                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1928		       END-EVALUATE
  1929            WHEN 'NNYN'
  1930		       EVALUATE EIBAID
  1931		       WHEN DFHPF3
  1932			    PERFORM 21H-F3-EXIT
  1933		       WHEN DFHENTER
  1934			    EVALUATE OPTIONI
  1935			    WHEN 1
  1936				 PERFORM 21A-SEARCH-SM001
  1937			    WHEN 2
  1938				 PERFORM 21E-APPROVE-SM005
  1939			    WHEN DFHNULL
  1940				 MOVE WS-FIELD-REQ TO ERRMSGO
  1941			    WHEN OTHER
  1942                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1943			    END-EVALUATE
  1944		       WHEN OTHER
  1945                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1946		       END-EVALUATE
  1947
  1948            WHEN 'NNNN'
  1949		       EVALUATE EIBAID
  1950		       WHEN DFHPF3
  1951			    PERFORM 21H-F3-EXIT
  1952		       WHEN DFHENTER
  1953			    EVALUATE TRUE
  1954			    WHEN OPTIONI NOT = SPACES
  1955			    WHEN OPTIONI NOT = LOW-VALUES
  1956                           MOVE 'OPTION INVALID VALUE' TO ERRMSGO
  1957			    END-EVALUATE
  1958		       WHEN OTHER
  1959                      MOVE 'INAVLID PFKEY PRESSED' TO ERRMSGO
  1960		       END-EVALUATE
  1961		  WHEN OTHER
  1962		       MOVE SPACES TO ERRMSGO
  1964		       EXEC CICS SEND TEXT
  1965			    FROM (WS-INVALID-TRNID)
  1966			    LENGTH (+15)
  1967			    ERASE
  1968		       END-EXEC
  1999		       EXEC CICS RETURN
  2000		       END-EXEC
  2013		  END-EVALUATE.
  2014	      400-EXIT.
  2015		  EXIT.
  2016
  2017	      500-CHECK-TICKET.
  2018		  MOVE WS-TICKET-PASSED TO WS-TICKET-KEY-NUM  2020		  EXEC CICS
  2021                 READ FILE('STF001C')
  2022		       INTO (WS-TICKET-REC)
  2023		       RIDFLD (WS-TICKET-KEY-NUM)
  2024		       KEYLENGTH (WS-STF-KEY-LEN)
  2025
  2026		       EQUAL
  2027		  END-EXEC
  2066		  IF EIBRESP = DFHRESP(NOTFND) OR EIBRESP2 = +80
  2068		  IF EIBRESP =	       013     OR EIBRESP2 = +80	       R
  2069               MOVE 'TICKET NOT FOUND' TO ERRMSGO
  2070		  END-IF.
  2071	      500-EXIT.
  2072		  EXIT.CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\SM000.cic	       PAGE   22



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    2083
			Compilation time (mm:ss.ss):  0:00.70
			Compilation speed (lines/minute): 78542

			Compilation date (yy/mm/dd): 23/12/05
			     Time of day (hh:mm:ss): 11:33:33