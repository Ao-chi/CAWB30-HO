     5	     *CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM001.
    22	      ENVIRONMENT DIVISION.
    23	      CONFIGURATION SECTION.
    24	      SOURCE-COMPUTER.	  IBM-PC.
    25	      OBJECT-COMPUTER.	  IBM-PC.
    26	      DATA DIVISION.
    27	      FILE SECTION.
    28	     *------------------------*
    29	     *	  WORKING STORAGE     *
    30	     *------------------------*
    31	      WORKING-STORAGE SECTION.
    32		  COPY SM01S.
    34	     * SYMBOLIC MAP of SM01S Created by CACXBMS Version 6.0.27
    80	      01  SM001MI.
    81		  02  FILLER				     PIC X(12).
    82		  02  PAGEL				     PIC S9(4) COMP.
    83		  02  PAGEF				     PIC X.
    84		  02  FILLER REDEFINES PAGEF.
    85		      03  PAGEA 			     PIC X.
    86		  02  PAGEI				     PIC X(002).
    87		  02  DATE1L				     PIC S9(4) COMP.
    88		  02  DATE1F				     PIC X.
    89		  02  FILLER REDEFINES DATE1F.
    90		      03  DATE1A			     PIC X.
    91		  02  DATE1I				     PIC X(010).
    92		  02  TIME1L				     PIC S9(4) COMP.
    93		  02  TIME1F				     PIC X.
    94		  02  FILLER REDEFINES TIME1F.
    95		      03  TIME1A			     PIC X.
    96		  02  TIME1I				     PIC X(008).
    97		  02  TITLEL				     PIC S9(4) COMP.
    98		  02  TITLEF				     PIC X.
    99		  02  FILLER REDEFINES TITLEF.
   100		      03  TITLEA			     PIC X.
   101		  02  TITLEI				     PIC X(020).
   102		  02  STATUSL				     PIC S9(4) COMP.
   103		  02  STATUSF				     PIC X.
   104		  02  FILLER REDEFINES STATUSF.
   105		      03  STATUSA			     PIC X.
   106		  02  STATUSI				     PIC X(010).
   107		  02  TODATEL				     PIC S9(4) COMP.
   108		  02  TODATEF				     PIC X.
   109		  02  FILLER REDEFINES TODATEF.
   110		      03  TODATEA			     PIC X.
   111		  02  TODATEI				     PIC X(010).
   112		  02  FRDATEL				     PIC S9(4) COMP.
   113		  02  FRDATEF				     PIC X.
   114		  02  FILLER REDEFINES FRDATEF.
   115		      03  FRDATEA			     PIC X.
   116		  02  FRDATEI				     PIC X(010).
   117		  02  OPTN1L				     PIC S9(4) COMP.
   118		  02  OPTN1F				     PIC X.
   119		  02  FILLER REDEFINES OPTN1F.
   120		      03  OPTN1A			     PIC X.
   121		  02  OPTN1I				     PIC X(001).
   122		  02  OPTN2L				     PIC S9(4) COMP.
   123		  02  OPTN2F				     PIC X.
   124		  02  FILLER REDEFINES OPTN2F.   125		      03  OPTN2A			     PIC X.
   126		  02  OPTN2I				     PIC X(001).
   127		  02  OPTN3L				     PIC S9(4) COMP.
   128		  02  OPTN3F				     PIC X.
   129		  02  FILLER REDEFINES OPTN3F.
   130		      03  OPTN3A			     PIC X.
   131		  02  OPTN3I				     PIC X(001).
   132		  02  OPTN4L				     PIC S9(4) COMP.
   133		  02  OPTN4F				     PIC X.
   134		  02  FILLER REDEFINES OPTN4F.
   135		      03  OPTN4A			     PIC X.
   136		  02  OPTN4I				     PIC X(001).
   137		  02  OPTN5L				     PIC S9(4) COMP.
   138		  02  OPTN5F				     PIC X.
   139		  02  FILLER REDEFINES OPTN5F.
   140		      03  OPTN5A			     PIC X.
   141		  02  OPTN5I				     PIC X(001).
   142		  02  OPTN6L				     PIC S9(4) COMP.
   143		  02  OPTN6F				     PIC X.
   144		  02  FILLER REDEFINES OPTN6F.
   145		      03  OPTN6A			     PIC X.
   146		  02  OPTN6I				     PIC X(001).
   147		  02  OPTN7L				     PIC S9(4) COMP.
   148		  02  OPTN7F				     PIC X.
   149		  02  FILLER REDEFINES OPTN7F.
   150		      03  OPTN7A			     PIC X.
   151		  02  OPTN7I				     PIC X(001).
   152		  02  OPTN8L				     PIC S9(4) COMP.
   153		  02  OPTN8F				     PIC X.
   154		  02  FILLER REDEFINES OPTN8F.
   155		      03  OPTN8A			     PIC X.
   156		  02  OPTN8I				     PIC X(001).
   157		  02  OPTN9L				     PIC S9(4) COMP.
   158		  02  OPTN9F				     PIC X.
   159		  02  FILLER REDEFINES OPTN9F.
   160		      03  OPTN9A			     PIC X.
   161		  02  OPTN9I				     PIC X(001).
   162		  02  OPTN10L				     PIC S9(4) COMP.
   163		  02  OPTN10F				     PIC X.
   164		  02  FILLER REDEFINES OPTN10F.
   165		      03  OPTN10A			     PIC X.
   166		  02  OPTN10I				     PIC X(001).
   167		  02  OPTN11L				     PIC S9(4) COMP.
   168		  02  OPTN11F				     PIC X.
   169		  02  FILLER REDEFINES OPTN11F.
   170		      03  OPTN11A			     PIC X.
   171		  02  OPTN11I				     PIC X(001).
   172		  02  DETL1L				     PIC S9(4) COMP.
   173		  02  DETL1F				     PIC X.
   174		  02  FILLER REDEFINES DETL1F.
   175		      03  DETL1A			     PIC X.
   176		  02  DETL1I				     PIC X(070).
   177		  02  DETL2L				     PIC S9(4) COMP.
   178		  02  DETL2F				     PIC X.
   179		  02  FILLER REDEFINES DETL2F.
   180		      03  DETL2A			     PIC X.
   181		  02  DETL2I				     PIC X(070).
   182		  02  DETL3L				     PIC S9(4) COMP.
   183		  02  DETL3F				     PIC X.
   184		  02  FILLER REDEFINES DETL3F.   185		      03  DETL3A			     PIC X.
   186		  02  DETL3I				     PIC X(070).
   187		  02  DETL4L				     PIC S9(4) COMP.
   188		  02  DETL4F				     PIC X.
   189		  02  FILLER REDEFINES DETL4F.
   190		      03  DETL4A			     PIC X.
   191		  02  DETL4I				     PIC X(070).
   192		  02  DETL5L				     PIC S9(4) COMP.
   193		  02  DETL5F				     PIC X.
   194		  02  FILLER REDEFINES DETL5F.
   195		      03  DETL5A			     PIC X.
   196		  02  DETL5I				     PIC X(070).
   197		  02  DETL6L				     PIC S9(4) COMP.
   198		  02  DETL6F				     PIC X.
   199		  02  FILLER REDEFINES DETL6F.
   200		      03  DETL6A			     PIC X.
   201		  02  DETL6I				     PIC X(070).
   202		  02  DETL7L				     PIC S9(4) COMP.
   203		  02  DETL7F				     PIC X.
   204		  02  FILLER REDEFINES DETL7F.
   205		      03  DETL7A			     PIC X.
   206		  02  DETL7I				     PIC X(070).
   207		  02  DETL8L				     PIC S9(4) COMP.
   208		  02  DETL8F				     PIC X.
   209		  02  FILLER REDEFINES DETL8F.
   210		      03  DETL8A			     PIC X.
   211		  02  DETL8I				     PIC X(070).
   212		  02  DETL9L				     PIC S9(4) COMP.
   213		  02  DETL9F				     PIC X.
   214		  02  FILLER REDEFINES DETL9F.
   215		      03  DETL9A			     PIC X.
   216		  02  DETL9I				     PIC X(070).
   217		  02  DETL10L				     PIC S9(4) COMP.
   218		  02  DETL10F				     PIC X.
   219		  02  FILLER REDEFINES DETL10F.
   220		      03  DETL10A			     PIC X.
   221		  02  DETL10I				     PIC X(070).
   222		  02  DETL11L				     PIC S9(4) COMP.
   223		  02  DETL11F				     PIC X.
   224		  02  FILLER REDEFINES DETL11F.
   225		      03  DETL11A			     PIC X.
   226		  02  DETL11I				     PIC X(070).
   227		  02  ERRMSG1L				     PIC S9(4) COMP.
   228		  02  ERRMSG1F				     PIC X.
   229		  02  FILLER REDEFINES ERRMSG1F.
   230		      03  ERRMSG1A			     PIC X.
   231		  02  ERRMSG1I				     PIC X(070).
   232	      01  SM001MO REDEFINES SM001MI.
   233		  02  FILLER				     PIC X(12).
   234		  02  FILLER				     PIC XX.
   235		  02  FILLER				     PIC X.
   236		  02  PAGEO				     PIC X(002).
   237		  02  FILLER				     PIC XX.
   238		  02  FILLER				     PIC X.
   239		  02  DATE1O				     PIC X(010).
   240		  02  FILLER				     PIC XX.
   241		  02  FILLER				     PIC X.
   242		  02  TIME1O				     PIC X(008).
   243		  02  FILLER				     PIC XX.
   244		  02  FILLER				     PIC X.   245		  02  TITLEO				     PIC X(020).
   246		  02  FILLER				     PIC XX.
   247		  02  FILLER				     PIC X.
   248		  02  STATUSO				     PIC X(010).
   249		  02  FILLER				     PIC XX.
   250		  02  FILLER				     PIC X.
   251		  02  TODATEO				     PIC X(010).
   252		  02  FILLER				     PIC XX.
   253		  02  FILLER				     PIC X.
   254		  02  FRDATEO				     PIC X(010).
   255		  02  FILLER				     PIC XX.
   256		  02  FILLER				     PIC X.
   257		  02  OPTN1O				     PIC X(001).
   258		  02  FILLER				     PIC XX.
   259		  02  FILLER				     PIC X.
   260		  02  OPTN2O				     PIC X(001).
   261		  02  FILLER				     PIC XX.
   262		  02  FILLER				     PIC X.
   263		  02  OPTN3O				     PIC X(001).
   264		  02  FILLER				     PIC XX.
   265		  02  FILLER				     PIC X.
   266		  02  OPTN4O				     PIC X(001).
   267		  02  FILLER				     PIC XX.
   268		  02  FILLER				     PIC X.
   269		  02  OPTN5O				     PIC X(001).
   270		  02  FILLER				     PIC XX.
   271		  02  FILLER				     PIC X.
   272		  02  OPTN6O				     PIC X(001).
   273		  02  FILLER				     PIC XX.
   274		  02  FILLER				     PIC X.
   275		  02  OPTN7O				     PIC X(001).
   276		  02  FILLER				     PIC XX.
   277		  02  FILLER				     PIC X.
   278		  02  OPTN8O				     PIC X(001).
   279		  02  FILLER				     PIC XX.
   280		  02  FILLER				     PIC X.
   281		  02  OPTN9O				     PIC X(001).
   282		  02  FILLER				     PIC XX.
   283		  02  FILLER				     PIC X.
   284		  02  OPTN10O				     PIC X(001).
   285		  02  FILLER				     PIC XX.
   286		  02  FILLER				     PIC X.
   287		  02  OPTN11O				     PIC X(001).
   288		  02  FILLER				     PIC XX.
   289		  02  FILLER				     PIC X.
   290		  02  DETL1O				     PIC X(070).
   291		  02  FILLER				     PIC XX.
   292		  02  FILLER				     PIC X.
   293		  02  DETL2O				     PIC X(070).
   294		  02  FILLER				     PIC XX.
   295		  02  FILLER				     PIC X.
   296		  02  DETL3O				     PIC X(070).
   297		  02  FILLER				     PIC XX.
   298		  02  FILLER				     PIC X.
   299		  02  DETL4O				     PIC X(070).
   300		  02  FILLER				     PIC XX.
   301		  02  FILLER				     PIC X.
   302		  02  DETL5O				     PIC X(070).
   303		  02  FILLER				     PIC XX.
   304		  02  FILLER				     PIC X.   305		  02  DETL6O				     PIC X(070).
   306		  02  FILLER				     PIC XX.
   307		  02  FILLER				     PIC X.
   308		  02  DETL7O				     PIC X(070).
   309		  02  FILLER				     PIC XX.
   310		  02  FILLER				     PIC X.
   311		  02  DETL8O				     PIC X(070).
   312		  02  FILLER				     PIC XX.
   313		  02  FILLER				     PIC X.
   314		  02  DETL9O				     PIC X(070).
   315		  02  FILLER				     PIC XX.
   316		  02  FILLER				     PIC X.
   317		  02  DETL10O				     PIC X(070).
   318		  02  FILLER				     PIC XX.
   319		  02  FILLER				     PIC X.
   320		  02  DETL11O				     PIC X(070).
   321		  02  FILLER				     PIC XX.
   322		  02  FILLER				     PIC X.
   323		  02  ERRMSG1O				     PIC X(070).
   325	     *----------------------------------------------------------------*
   326	     *			   COPYBOOK REDEFINES			      *
   327	     *----------------------------------------------------------------*
   328	      01  DETL-LINE REDEFINES SM001MI.
   329		  05 FILLER				 PIC X(103).
   330		  05 DETL-SELECT			 OCCURS 11.
   331		     10 DETL-SELECTL			 PIC S9(4) COMP.
   332		     10 DETL-SELECTF			 PIC X.
   333			  10 FILLER REDEFINES DETL-SELECTF.
   334			15 DETL-SELECTA 		 PIC X.
   335			  10 DETL-SELECTI		      PIC X(001).
   336		  05 DETL-DETAIL			 OCCURS 11.
   337		     10 DETL-DETAILL			 PIC S9(4) COMP.
   338		     10 DETL-DETAILF			 PIC X.
   339		     10 FILLER REDEFINES DETL-DETAILF.
   340			15 DETL-DETAILA 		 PIC X.
   341			 10 DETL-DETAILI.
   342			15 DETAILS-TIX-ID		 PIC X(07).
   343			15 FILLER1			 PIC X(03).
   344			15 DETAILS-TIX-TITLE		 PIC X(25).
   345			15 FILLER2			 PIC X(01).
   346			15 DETAILS-TIX-STAT		 PIC X(10).
   347			15 FILLER3			 PIC X(04).
   348			15 DETAILS-LAST-UPD.
   349			   20  DETAIL-DD		 PIC X(02).
   350			   20  SLASH1			 PIC X.
   351			   20  DETAIL-MM		 PIC X(02).
   352			   20  SLASH2			 PIC X.
   353			   20  DETAIL-YYYY		 PIC X(04).
   354			15 FILLER4			 PIC X(02).
   355			15 DETAILS-UPD-BY		 PIC X(08).
   356		  05 FILLER				 PIC X(65).
   357		  COPY DFHBMSCA.
   359	      01  DFHBMSCA.
   360	     *
   361	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   362	     *
   363	     * Revision Information
   364	     * ^{File:dfhbmsca.cob}
   365	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   366	     * ^{Revision:2.0}   367	     *
   368	     *	Note:This FILE is provided with most values as quoted literals
   369	     *	     so that the file can be used for both ASCII and EBCDIC
   370	     *	     programs
   371	     *
   372	     *	     The only exceptions are some 3270 Data Stream Orders
   373	     *	     They use different Hexadecimal values for ASCII and
   374	     *	     EBCDIC and they cannot be expressed as quoted literals
   375	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   376	     *	     characters in ASCII
   377	     *
   378	     *	     They have their values set up to default to the EBCDIC
   379	     *	     values.
   380	     *
   381	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   382	     *	     and SEND TEXT with imbedded format orders.
   383	     *	     If you use these values in ASCII programs the values
   384	     *	     must be changed.
   385	     *
   386	     *	     An alternative is to use REPLACING to change the values.
   387	     *
   388	     *	  i.e. COPY DFHBMSCA replacing
   389	     *			    ==005== BY ==009==	*> DFHPT
   390	     *			    ==021== BY ==010==	*> DFHNL
   391	     *			    ==040== BY ==021==	*> DFHSA
   392	     *			    ==041== BY ==031==	*> DFHSFE
   393	     *			    ==044== BY ==023==	*> DFHMF
   394	     *			    ==060== BY ==020==	*> DFHRA
   395	     *			    ==063== BY ==026==. *> DFHSUB
   396	     *
   397	     ******************************************************************
   398	     *BMS and Terminal Control - Order & Attributes constants	      *
   399	     ******************************************************************
   400	     *
   401	     *	  Field Attributes
   402	     *
   403            05  DFHBMASB                          PIC X VALUE '8'.
   404            05  DFHBMASF                          PIC X VALUE '1'.
   405            05  DFHBMASK                          PIC X VALUE '0'.
   406            05  DFHBMBRY                          PIC X VALUE 'H'.
   407            05  DFHBMDAR                          PIC X VALUE '<'.
   408            05  DFHBMFSE                          PIC X VALUE 'A'.
   409            05  DFHBMPRF                          PIC X VALUE '/'.
   410            05  DFHBMPRO                          PIC X VALUE '-'.
   411            05  DFHBMUNN                          PIC X VALUE '&'.
   412            05  DFHBMUNP                          PIC X VALUE ' '.
   413            05  DFHUNNUM                          PIC X VALUE 'J'.
   414	     *
   415	     *	  partially supported
   416	     *
   417            05  DFHUNNOD                          PIC X VALUE '('.
   418            05  DFHUNIMD                          PIC X VALUE 'I'.
   419            05  DFHUNINT                          PIC X VALUE 'R'.
   420            05  DFHUNNON                          PIC X VALUE '('.
   421            05  DFHPROTI                          PIC X VALUE 'Y'.
   422            05  DFHPROTN                          PIC X VALUE '%'.
   423	     *
   424	     *	  These values are additions to mainframe constants
   425	     *
   426            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.   427            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   428            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   429	     *						      VALUE APOST
   430            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   431            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   432            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   433            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   434            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   435	     *
   436	     *	  Field Flag values
   437		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   438		  05  FILLER REDEFINES DFHBMEOF-VAL.
   439		      10  FILLER			PIC X.
   440		      10  DFHBMEOF			PIC X.
   441       *                                          x'80'.
   442		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   443		  05  FILLER REDEFINES DFHBMCUR-VAL.
   444		      10  FILLER			PIC X.
   445		      10  DFHBMCUR			PIC X.
   446       *                                          x'02'.
   447		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   448		  05  FILLER REDEFINES DFHBMMEC-VAL.
   449		      10  FILLER			PIC X.
   450		      10  DFHBMMEC			PIC X.
   451       *                                          x'82'.
   452       *                                          x'02'.
   453		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   454		      88  DFHERASE			VALUES 128 130.
   455       *                                          x'80' X'82'
   456		      88  DFHCURSR			VALUES 002 130.
   457       *                                          x'02' X'82'
   458		  05  FILLER REDEFINES DFHBMFLG-VAL.
   459		      10  FILLER			PIC X.
   460		      10  DFHBMFLG			PIC X.
   461
   462		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   463		  05  FILLER REDEFINES DFHBMDUP-VAL.
   464		      10  FILLER			PIC X.
   465		      10  DFHBMDUP			PIC X.
   466       *                                              x'1C'
   467	     *
   468	     ******************************************************************
   469	     *	  supported 327X Extended Attributes
   470	     *
   471	     *	  Extended COLOR Attributes
   472	     *
   473            05  DFHDFCOL                          PIC X VALUE '0'.
   474            05  DFHBLUE                           PIC X VALUE '1'.
   475            05  DFHRED                            PIC X VALUE '2'.
   476            05  DFHPINK                           PIC X VALUE '3'.
   477            05  DFHGREEN                          PIC X VALUE '4'.
   478            05  DFHTURQ                           PIC X VALUE '5'.
   479            05  DFHYELLO                          PIC X VALUE '6'.
   480            05  DFHNEUTR                          PIC X VALUE '7'.
   481	     *
   482	     *	  Extended HILIGHT Attributes
   483	     *
   484            05  DFHDFHI                           PIC X VALUE '0'.
   485            05  DFHBLINK                          PIC X VALUE '1'.
   486            05  DFHREVRS                          PIC X VALUE '2'.   487            05  DFHUNDLN                          PIC X VALUE '4'.
   488	     *
   489	     ******************************************************************
   490	     *	  supported 327X Data Stream Orders
   491	     *
   492		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   493		  05  FILLER REDEFINES DFHSBA-VAL.
   494		      10  FILLER			PIC X.
   495		      10  DFHSBA			PIC X.
   496       *                                              x'11'
   497		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   498		  05  FILLER REDEFINES DFHEUA-VAL.
   499		      10  FILLER			PIC X.
   500		      10  DFHEUA			PIC X.
   501       *                                              x'12'
   502		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   503		  05  FILLER REDEFINES DFHIC-VAL.
   504		      10  FILLER			PIC X.
   505		      10  DFHIC 			PIC X.
   506       *                                              X'13'.
   507		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   508		  05  FILLER REDEFINES DFHSF-VAL.
   509		      10  FILLER			PIC X.
   510		      10  DFHSF 			PIC X.
   511       *                                              X'1D'.
   512		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   513		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   514		      88 DFHPT-VAL-ASCII		VALUE 9.
   515		  05  FILLER REDEFINES DFHPT-VAL.
   516		      10  FILLER			PIC X.
   517		      10  DFHPT 			PIC X.
   518       *                                              EBCDIC X'05'.
   519       *                                              ASCII  X'09'.
   520		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   521		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   522		      88 DFHRA-VAL-ASCII		VALUE 20.
   523		  05  FILLER REDEFINES DFHRA-VAL.
   524		      10  FILLER			PIC X.
   525		      10  DFHRA 			PIC X.
   526       *                                              EBCDIC x'3C'
   527       *                                              ASCII  x'14'
   528		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   529		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   530		      88 DFHSFE-VAL-ASCII		VALUE 31.
   531		  05  FILLER REDEFINES DFHSFE-VAL.
   532		      10  FILLER			PIC X.
   533		      10  DFHSFE			PIC X.
   534       *                                              EBCDIC x'29'
   535       *                                              ASCII  x'1F'
   536		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   537		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   538		      88 DFHMF-VAL-ASCII		VALUE 23.
   539		  05  FILLER REDEFINES DFHMF-VAL.
   540		      10  FILLER			PIC X.
   541		      10  DFHMF 			PIC X.
   542       *                                              EBCDIC x'2C'
   543       *                                              ASCII  x'17'
   544	     *
   545	     ******************************************************************
   546	     *	  unsupported 327X Data Stream order codes   547	     *
   548		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   549		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   550		      88 DFHSA-VAL-ASCII		VALUE 21.
   551		  05  FILLER REDEFINES DFHSA-VAL.
   552		      10  FILLER			PIC X.
   553		      10  DFHSA 			PIC X.
   554       *                                              EBCDIC x'28'
   555       *                                              ASCII  x'15'
   556		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   557		  05  FILLER REDEFINES DFHGE-VAL.
   558		      10  FILLER			PIC X.
   559		      10  DFHGE 			PIC X.
   560       *                                              X'08'.
   561	     *
   562	     ******************************************************************
   563	     *	  SFE and MF supported attribute types
   564	     *
   565            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   566       *                                              EBCDIC x'42'
   567       *                                              ASCII  x'83'
   568            05  DFHHLT                            PIC X VALUE 'Ö'.
   569       *                                              EBCDIC x'41'
   570       *                                              ASCII  x'D6'
   571            05  DFH3270                           PIC X VALUE '{'.
   572	     *
   573	     *	  supported for SEND TEXT command and printer terminal
   574	     *
   575		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   576		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   577		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   578		  05  FILLER REDEFINES DFHBMPNL-VAL.
   579		      10  FILLER			PIC X.
   580		      10  DFHBMPNL			PIC X.
   581       *                                              EBCDIC X'15'.
   582       *                                              ASCII  X'0A'.
   583	     *
   584	     ******************************************************************
   585	     *	  Printer terminal data stream only
   586	     *
   587		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   588		  05  FILLER REDEFINES DFHBMPFF-VAL.
   589		      10  FILLER			PIC X.
   590		      10  DFHBMPFF			PIC X.
   591       *                                              X'0C'.
   592		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   593		  05  FILLER REDEFINES DFHBMPCR-VAL.
   594		      10  FILLER			PIC X.
   595		      10  DFHBMPCR			PIC X.
   596       *                                              X'0D'.
   597		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   598		  05  FILLER REDEFINES DFHBMPEM-VAL.
   599		      10  FILLER			PIC X.
   600		      10  DFHBMPEM			PIC X.
   601       *                                              X'19'.
   602	     *
   603	     ******************************************************************
   604	     *	  unsupported Miscellaneous attributes and constants
   605	     *
   606		  05  DFHALL				PIC X VALUE LOW-VALUES.   607            05  DFHBASE                           PIC X VALUE '0'.
   608		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   609		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   610		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   611		      10  DFHBMPSO			PIC X.
   612       *                                              X'0E'.
   613		      10  DFHBMPSI			PIC X.
   614       *                                              X'0F'.
   615		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   616            05  DFHERROR                          PIC X VALUE '¶'.
   617       *                                              EBCDIC X'1A'.
   618       *                                              ASCII  X'B6'.
   619            05  DFHFIL                            PIC X VALUE '4'.
   620            05  DFHMENT                           PIC X VALUE '2'.
   621            05  DFHMET                            PIC X VALUE '3'.
   622            05  DFHMFE                            PIC X VALUE '6'.
   623            05  DFHMFET                           PIC X VALUE '7'.
   624            05  DFHMFT                            PIC X VALUE '5'.
   625            05  DFHMT                             PIC X VALUE '1'.
   626            05  DFHOUTLN                          PIC X VALUE 'B'.
   627            05  DFHPS                             PIC X VALUE '„'.
   628       *                                              EBCDIC x'43'
   629       *                                              ASCII  x'84'
   630            05  DFHVAL                            PIC X VALUE 'A'.
   631	     *
   632		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   633		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   634		      88 DFHSUB-VAL-ASCII		VALUE 26.
   635		  05  FILLER REDEFINES DFHSUB-VAL.
   636		      10  FILLER			PIC X.
   637		      10  DFHSUB			PIC X.
   638       *                                              EBCDIC X'3F'.
   639       *                                              ASCII  X'1A'.
   640	     *
   641		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   642		  05  FILLER REDEFINES DFHFM-VAL.
   643		      10  FILLER			PIC X.
   644		      10  DFHFM 			PIC X.
   645       *                                              EBCDIC X'1E'.
   646		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   648		  COPY DFHAID.
   650	      01  DFHAID.
   651	     *
   652	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   653	     *
   654	     * Revision Information
   655	     * ^{File:dfhaid.cob  }
   656	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   657	     * ^{Revision:2.0}
   658	     *
   659	     *This is the AID constants copy file
   660	     *
   661            05  DFHENTER                  PIC X VALUE ''''.
   662	     *					value APOST
   663            05  DFHCLEAR                  PIC X VALUE '_'.
   664            05  DFHPA1                    PIC X VALUE '%'.
   665            05  DFHPA2                    PIC X VALUE '>'.
   666            05  DFHPA3                    PIC X VALUE ','.
   667            05  DFHPF1                    PIC X VALUE '1'.
   668            05  DFHPF2                    PIC X VALUE '2'.   669            05  DFHPF3                    PIC X VALUE '3'.
   670            05  DFHPF4                    PIC X VALUE '4'.
   671            05  DFHPF5                    PIC X VALUE '5'.
   672            05  DFHPF6                    PIC X VALUE '6'.
   673            05  DFHPF7                    PIC X VALUE '7'.
   674            05  DFHPF8                    PIC X VALUE '8'.
   675            05  DFHPF9                    PIC X VALUE '9'.
   676            05  DFHPF10                   PIC X VALUE ':'.
   677            05  DFHPF11                   PIC X VALUE '#'.
   678            05  DFHPF12                   PIC X VALUE '@'.
   679            05  DFHPF13                   PIC X VALUE 'A'.
   680            05  DFHPF14                   PIC X VALUE 'B'.
   681            05  DFHPF15                   PIC X VALUE 'C'.
   682            05  DFHPF16                   PIC X VALUE 'D'.
   683            05  DFHPF17                   PIC X VALUE 'E'.
   684            05  DFHPF18                   PIC X VALUE 'F'.
   685            05  DFHPF19                   PIC X VALUE 'G'.
   686            05  DFHPF20                   PIC X VALUE 'H'.
   687            05  DFHPF21                   PIC X VALUE 'I'.
   688            05  DFHPF22                   PIC X VALUE '›'.
   689       *                                  EBCDIC Cent sign x'4A'
   690       *                                  ASCII  Cent sign x'9B'
   691            05  DFHPF23                   PIC X VALUE '.'.
   692            05  DFHPF24                   PIC X VALUE '<'.
   693            05  DFHOPID                   PIC X VALUE 'W'.
   694            05  DFHMSRE                   PIC X VALUE 'X'.
   695            05  DFHTRIG                   PIC X VALUE '"'.
   696       *                                        value QUOTE  "
   697            05  DFHPEN                    PIC X VALUE '='.
   698            05  DFHCLRP                   PIC X VALUE 'Ý'.
   699       *                                  EBCDIC x'6A'
   700       *                                  ASCII  x'DD'
   701            05  DFHSTRF                   PIC X VALUE 'h'.
   702	     *	  DFHQUIT is a CA-Realia CICS Extension
   703	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   704            05  DFHQUIT                   PIC X VALUE '!'.
   705		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   707
   708        01  WS-CURRENT-MAP                    PIC X(7) VALUE 'SM01S'.
   709	      01  WS-REC-LENGTH 			PIC S9(4)
   710		  COMP VALUE +228.
   711	      01  WS-QNAME				PIC X(08).
   712	      01  WS-KEYB.
   713		  05 WS-KEYB6			PIC X(06) VALUE LOW-VALUES.
   714		  05 FILLER REDEFINES WS-KEYB6.
   715		     10 FILLER			PIC X(03).
   716		     10 WS-KEYB3		PIC 9(03).
   717		  05 WS-KEYB1			PIC X(01) VALUE HIGH-VALUES.
   718	      01  WS-STF-REC.
   719		  05 WS-TICKET-ID			PIC 9(07).
   720		  05 WS-TIX-ID				REDEFINES WS-TICKET-ID.
   721		     10 WS-T-ID 			PIC X(06).
   722		     10 FILLER				PIC X.
   723		  05 WS-TICKET-REQ			PIC X(08).
   724		  05 WS-TICKET-STAT			PIC X(10).
   725		  05 WS-TICKET-TITLE			PIC X(25).
   726		  05 WS-TICKET-DESC			PIC X(100).
   727		  05 WS-LAST-UPD			PIC X(20).
   728		  05 WS-UPD-BY				PIC X(08).
   729		  05 WS-UPD-REMARKS			PIC X(50).   730	      01  WS-STF-REC2.
   731		  05 WS-STF-REQ2			OCCURS 11 PIC X(08).
   732	     *01  WS-REC.
   733	     *	  05 WS-USERID.
   734	     *	     10  WS-USERID7			PIC X(7).
   735	     *	     10  FILLER 			PIC X(1).
   736	     *	  05 WS-TYPE.
   737	     *	     10  WS-REQUESTOR			PIC X.
   738	     *	     10  WS-ADMIN			PIC X.
   739	     *	     10  WS-APPROVER			PIC X.
   740	     *	     10  WS-SERVICE			PIC X.
   741	     *	  05 WS-UPDATEDBY			PIC X(8).
   742	      01  WS-TIME				PIC 9(15) COMP-3.
   743	      01  WS-DATE				PIC 9(7).
   744	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
   745	      01  WS-LENGTH				PIC S9(4) COMP.
   746	      01  WS-FLAGS.
   747            05 WS-FLAG                            PIC X    VALUE 'N'.
   748            05 WS-PAGE-CHANGED                    PIC X VALUE 'N'.
   749		  05 WS-PAGE-INVALID			PIC X.
   750            05 WS-SEARCH-FLAG                     PIC X VALUE 'N'.
   751		  05 WS-VALID-FIELDS.
   752		     10 WS-VALID-STAT			PIC X.
   753		     10 WS-VALID-TITLE			PIC X.
   754		     10 WS-VALID-TODATE 		PIC X.
   755		     10 WS-VALID-FRODATE		PIC X.
   756
   757	      01  WS-SELECTED-VALUE			PIC X.
   758	      01  WS-COUNTERS.
   759		  05 WS-INDEX				PIC 9(02).
   760		  05 WS-I				PIC 9(02).
   761		  05 WS-SELECT-COUNT			PIC 9.
   762		  05 WS-PAGE-UPDOWN			PIC 9(02).
   763
   764	      01  WS-ERRMSGS.
   765		  05 WS-INVALID-ACCESS			PIC X(15) VALUE
   766               'INVALID ACCESS'.
   767		  05 WS-INVALID-PGMID			PIC X(20) VALUE
   768               'INVALID USER ACCESS'.
   769		  05 WS-MAPFAIL 			PIC X(20) VALUE
   770               'MAPFAIL ERROR'.
   771		  05 WS-INVALID-TIX-ACC 		PIC X(34) VALUE
   772               'INVALID ACCESS TO SELECTED TICKET'.
   773		  05 WS-FIELD-REQ			PIC X(24) VALUE
   774               'OPTION FIELD IS REQUIRED'.
   775		  05 WS-FIRST-PAGE			PIC X(23) VALUE
   776               'THIS IS THE FIRST PAGE'.
   777		  05 WS-LAST-PAGE			PIC X(21) VALUE
   778               'THIS IS THE LAST PAGE'.
   779		  05 WS-INVALID-VALUE			PIC X(46) VALUE
   780               'INVALID VALUE. PLEASE CORRECT HIGHLIGHT FIELDS'.
   781		  05 WS-INVALID-PFKEY			PIC X(21) VALUE
   782                'INAVLID PFKEY PRESSED'.
   783		  05 WS-MULTIPLE-SELECT 		PIC X(31) VALUE
   784                'NO MULTIPLE SELECTED IS ALLOWED'.
   785		  05 WS-SELECT-OPTION			PIC X(29) VALUE
   786               'SELECT TICKET AND PRESS ENTER'.
   787
   788	      77 WS-RETNCODE				PIC S9(8) COMP.
   789	      77 WS-RETNCODE2				PIC S9(8) COMP.   790	      01  WS-LASTPAGE				PIC X(1).
   791	      01  WS-FIRSTPAGE				PIC X(1).
   792	      01  WS-PAGE-CTR				PIC 9(02).
   793	      01  WS-SEARCH-FIELDS.
   794		  05 WS-SEARCH-STATUS			PIC X(10).
   795		  05 WS-SEARCH-TITLE			PIC X(20).
   796		  05 WS-SEARCH-TO-DATE.
   797		     10 MM-TO-DATE			 PIC X(2).
   798		     10 SLASH1-TO-DATE			 PIC X.
   799		     10 DD-TO-DATE			 PIC X(2).
   800		     10 SLASH2-TO-DATE			 PIC X.
   801		     10 YYYY-TO-DATE			 PIC X(4).
   802
   803	      01  WS-COMMAREA.
   804		  05 WS-PGMID				PIC X(06).
   805		  05 WS-STATE				PIC X.
   806		  05 WS-TICKET-PASSED			PIC X(07).
   807		  05 USERID.
   808		     10  USERID7			PIC X(7).
   809		     10  FILLER 			PIC X(1).
   810		  05 USR-TYPE.
   811		    15 USR-REQUESTOR			PIC X.
   812		    15 USR-ADMIN			PIC X.
   813		    15 USR-APPROVER			PIC X.
   814		    15 USR-SERVICE			PIC X.
   815		  05 WS-SM012-STATE			PIC X.
   816		  05 WS-SM012-PGMID			PIC X(06).
   817		  05 WS-STF01-REC.
   818		     10 WS-STF01-ID			PIC X(07).
   819		     10 FILL1				PIC X(03).
   820		     10 WS-STF01-TITLE			PIC X(25).
   821		     10 FILL2				PIC X(01).
   822		     10 WS-STF01-STATUS 		PIC X(10).
   823		     10 FILL3				PIC X(04).
   824		     10 WS-STF01-LAST-UPD		PIC X(10).
   825		     10 FILL4				PIC X(02).
   826		     10 WS-STF01-LAST-UPDBY		PIC X(8).
   827		     10 WS-STF01-REQ			PIC X(8).
   828		  05 WS-PGMNAME 			PIC  X(6).
   829		  05 WS-DFHSTATE			PIC X(15).
   830		  05 WS-TRANS				PIC X(04).
   831		  05 WS-LUSER				PIC 9(03).
   832		  05 WS-FUSER				PIC X(07).
   833		  05 WS-PAGE				PIC 9(02).
   834		  05 WS-PAGE-END			PIC 9(01).
   835		  05 WS-QITEM				PIC S9(4) COMP.
   836		  05 WS-QITEM-START			PIC S9(4) COMP.
   837		  05 WS-QITEM-END			PIC S9(4) COMP.
   838		  05 WS-QITEM-PAGE			PIC S9(4) COMP.
   839		  05 WS-PAGES.
   840		     10 WS-PREV-PAGE			   PIC X(02).
   841		     10 PREV-PAGE REDEFINES WS-PREV-PAGE   PIC 9(02).
   842		     10 WS-CURR-PAGE			   PIC X(02).
   843		     10 CURR-PAGE REDEFINES WS-CURR-PAGE   PIC 9(02).
   844		     10 WS-TOTAL-QITEM			   PIC 9(02).
   845		     10 WS-MAX-PAGE			   PIC 9(02).
   846	     *----------------------------------------------------------------*
   847	     *				LINKAGE SECTION 		      *
   848	     *----------------------------------------------------------------*
   849	      LINKAGE SECTION.   851	      01  DFHEIBLK.						       R
   852		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   853		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   854		  05 EIBTRNID PIC X(4). 				       R
   855		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   856		  05 EIBTRMID PIC X(4). 				       R
   857		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   858		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   859		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   860		  05 EIBAID   PIC X.					       R
   861		  05 EIBFN    PIC X(2). 				       R
   862		  05 EIBRCODE PIC X(6). 				       R
   863		  05 EIBDS    PIC X(8). 				       R
   864		  05 EIBREQID PIC X(8). 				       R
   865		  05 EIBRSRCE PIC X(8). 				       R
   866		  05 EIBSYNC  PIC X.					       R
   867		  05 EIBFREE  PIC X.					       R
   868		  05 EIBRECV  PIC X.					       R
   869		  05 EIBSEND  PIC X.					       R
   870		  05 EIBATT   PIC X.					       R
   871		  05 EIBEOC   PIC X.					       R
   872		  05 EIBFMH   PIC X.					       R
   873		  05 EIBCOMPL PIC X.					       R
   874		  05 EIBSIG   PIC X.					       R
   875		  05 EIBCONF  PIC X.					       R
   876		  05 EIBERR   PIC X.					       R
   877		  05 EIBERRCD PIC X(4). 				       R
   878		  05 EIBSYNRB PIC X.					       R
   879		  05 EIBNODAT PIC X.					       R
   880		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   881		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   882		  05 EIBRLDBK PIC X.					       R
   883		  05 EIBCARESERVED PIC X(32).				       R
   885	      01  DFHCOMMAREA.
   886		  05 DF-PGMID				PIC X(06).
   887		  05 DF-STATE				PIC X.
   888		  05 DF-TICKET-PASSED			PIC X(07).
   889		  05 DF-USERID.
   890		     10  DF-USERID7			PIC X(7).
   891		     10  FILLER 			PIC X(1).
   892		  05 DF-USR-TYPE.
   893		    15 DF-USR-REQUESTOR 		PIC X.
   894		    15 DF-USR-ADMIN			PIC X.
   895		    15 DF-USR-APPROVER			PIC X.
   896		    15 DF-USR-SERVICE			PIC X.
   897		  05 DF-SM012-STATE			PIC X.
   898		  05 DF-SM012-PGMID			PIC X(06).
   899		  05 DF-STF01-REC.
   900		     10 DF-STF01-ID			PIC X(07).
   901		     10 DF-FILLER			PIC X(03).
   902		     10 DF-STF01-TITLE			PIC X(25).
   903		     10 DF-FILLER			PIC X(01).
   904		     10 DF-STF01-STATUS 		PIC X(10).
   905		     10 DF-FILLER			PIC X(04).
   906		     10 DF-STF01-LAST-UPD		PIC X(10).
   907		     10 DF-FILLER4			PIC X(02).
   908		     10 DF-STF01-LAST-UPDBY		PIC X(8).
   909		     10 DF-STF01-REQ			PIC X(8).
   910		  05 DF-PGMNAME 			PIC X(6).
   911		  05 DFHSTATE				PIC X(15).   912		  05 DF-TRANS				PIC X(04).
   913		  05 DF-LUSER				PIC 9(03).
   914		  05 DF-FUSER				PIC X(07).
   915		  05 DF-PAGE				PIC 9(02).
   916		  05 DF-PAGE-END			PIC 9(01).
   917		  05 DF-QITEM				PIC S9(4) COMP.
   918		  05 DF-QITEM-START			PIC S9(4) COMP.
   919		  05 DF-QITEM-END			PIC S9(4) COMP.
   920		  05 DF-QITEM-PAGE			PIC S9(4) COMP.
   921		  05 DF-PAGES.
   922		     10 DF-PREV-PAGE			   PIC X(02).
   923		     10 PREV REDEFINES DF-PREV-PAGE	   PIC 9(02).
   924		     10 DF-CURR-PAGE			   PIC X(02).
   925		     10 CURR REDEFINES DF-CURR-PAGE	   PIC 9(02).
   926		     10 DF-TOTAL-QITEM			   PIC 9(02).
   927		     10 DF-MAX-PAGE			   PIC 9(02).
   928
   929	      PROCEDURE DIVISION					       R
   931		  USING DFHEIBLK DFHCOMMAREA.				       R
   956	      100-MAIN.
   957		  MOVE DFHCOMMAREA TO WS-COMMAREA
   958		  STRING EIBTRMID DELIMITED BY SIZE
   959                      'SM01' DELIMITED BY SIZE
   960			 INTO WS-QNAME
   962		  EXEC CICS
   963		    IGNORE CONDITION ERROR
   964		  END-EXEC
   979
   980            IF WS-PGMID = 'SM000' OR WS-PGMID = 'SM001' OR
   981               WS-PGMID = 'SM002' OR WS-PGMID = 'SM003' OR
   982               WS-PGMID = 'SM004' OR WS-PGMID = 'SM005' OR
   983               WS-PGMID = 'SM006'
   984		      IF WS-STATE NOT = LOW-VALUES
   985			 PERFORM 200-REC-MAP
   986			 PERFORM 500-CHECK-EIBAID
   987			 PERFORM 600-MOVE-Q-TO-SCREEN
   988			 PERFORM 111-CREATE-MAP
   989
   990		      ELSE
   991			  MOVE WS-SELECT-OPTION TO ERRMSG1O
   992			  MOVE 1 TO WS-STATE
   993			  MOVE 1 TO WS-PAGE
   994			  MOVE WS-PAGE TO PAGEO
   995			  MOVE -1 TO TITLEL
   996			  PERFORM 700-MOVE-FILES-TO-Q
   997			  PERFORM 600-MOVE-Q-TO-SCREEN
   998			  PERFORM 111-CREATE-MAP
   999		      END-IF
  1000		  ELSE
  1001		      MOVE SPACES TO ERRMSG1O
  1002		      MOVE LENGTH OF WS-INVALID-ACCESS TO WS-LENGTH
  1004		      EXEC CICS SEND TEXT
  1005			      FROM (WS-INVALID-ACCESS)
  1006			      LENGTH (WS-LENGTH)
  1007			      ERASE
  1008			 END-EXEC
  1039		      EXEC CICS RETURN
  1040		      END-EXEC
  1053		  END-IF.
  1054  1055	      100-EXIT.
  1056		  EXIT.
  1057
  1058	      110-DATE-TIME.
  1059		  MOVE EIBDATE TO WS-DATE.
  1060		  MOVE WS-DATE-X TO DATE1O.
  1062		  EXEC CICS ASKTIME
  1063		       ABSTIME	  (WS-TIME)
  1064		  END-EXEC
  1083		  EXEC CICS FORMATTIME
  1084		       ABSTIME	  (WS-TIME)
  1085                 DATESEP    ('/')
  1086		       MMDDYYYY   (DATE1O)
  1087		       TIME	  (TIME1O)
  1088                 TIMESEP    (':')
  1089		  END-EXEC
  1129		  MOVE DFHBMASB TO TIME1A
  1130		  MOVE DFHBMASB TO DATE1A.
  1131	      110-EXIT.
  1132		  EXIT.
  1133
  1134	      111-CREATE-MAP.
  1135		  PERFORM 110-DATE-TIME
  1136		  MOVE DFHUNIMD TO TITLEA
  1137		  MOVE DFHUNIMD TO STATUSA
  1138
  1139		  MOVE LENGTH OF SM001MO TO WS-LENGTH
  1141		  EXEC CICS SEND
  1142                 MAP('SM001M')
  1143                 MAPSET('SM01S')
  1144		       FROM(SM001MO)
  1145		       LENGTH(WS-LENGTH)
  1146		       CURSOR
  1147		       ERASE
  1148		  END-EXEC
  1194		  EXEC CICS RETURN
  1195                 TRANSID('SM01')
  1196		       COMMAREA(WS-COMMAREA)
  1197		  END-EXEC.
  1222	      110-EXIT.
  1223		  EXIT.
  1224
  1225	      200-REC-MAP.
  1227		  EXEC CICS RECEIVE
  1228                 MAP('SM001M')
  1229                 MAPSET('SM01S')
  1230		       INTO (SM001MI)
  1231		  END-EXEC.
  1265	     *	  IF EIBRESP = DFHRESP(MAPFAIL)
  1266	     *	     MOVE WS-INVALID-PFKEY TO ERRMSG1O
  1267	     *	     PERFORM 600-MOVE-Q-TO-SCREEN
  1268	     *	     PERFORM 111-CREATE-MAP
  1269	     *	  END-IF
  1270	      200-EXIT.
  1271		  EXIT.
  1272
  1273	      530-PAGE-UP-ENTER.
  1274		  IF WS-QITEM-PAGE > WS-QITEM-END
  1275		     SUBTRACT 11 FROM WS-QITEM-PAGE
  1276		     MOVE WS-LAST-PAGE TO ERRMSG1O  1277		  ELSE
  1278		     MOVE WS-SELECT-OPTION TO
  1279		      ERRMSG1O
  1280		     MOVE CURR-PAGE TO WS-PAGE
  1281		     MOVE WS-PAGE TO PAGEO
  1282		     PERFORM 600-MOVE-Q-TO-SCREEN
  1283		  END-IF
  1284		  PERFORM 111-CREATE-MAP.
  1285	      530-EXIT.
  1286		  EXIT.
  1287
  1288	      540-PAGEDOWN-ENTER.
  1289		  IF WS-QITEM-PAGE = WS-QITEM-START OR
  1290		     WS-QITEM-PAGE <  WS-QITEM-START
  1291		     MOVE WS-FIRST-PAGE TO ERRMSG1O
  1292		     MOVE 1 TO WS-PAGE
  1293		     MOVE WS-QITEM-START TO WS-QITEM-PAGE
  1294		  ELSE
  1295		    SUBTRACT CURR-PAGE FROM WS-PAGE
  1296		    MOVE WS-PAGE TO PAGEO
  1297		  END-IF
  1298		  MOVE WS-PAGE TO PAGEO
  1299		  PERFORM 600-MOVE-Q-TO-SCREEN
  1300		  PERFORM 111-CREATE-MAP.
  1301	      540-EXIT.
  1302		  EXIT.
  1303
  1304	      500-CHECK-EIBAID.
  1305		  EVALUATE EIBAID
  1306		  WHEN DFHCLEAR
  1307		       MOVE WS-INVALID-PFKEY TO ERRMSG1O
  1308		       MOVE -1 TO TITLEL
  1309		       MOVE WS-PAGE TO WS-PREV-PAGE
  1310		       MOVE PREV-PAGE TO PAGEI
  1311		       PERFORM 600-MOVE-Q-TO-SCREEN
  1312		       PERFORM 111-CREATE-MAP
  1313
  1314		  WHEN DFHPF2
  1315                 IF USR-REQUESTOR  = 'Y'
  1316	     *		  MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1317                    MOVE 'SM001' TO WS-PGMID
  1318			  MOVE LOW-VALUES TO WS-STATE
  1320			  EXEC CICS XCTL
  1321                         PROGRAM ('SM002')
  1322			       COMMAREA (WS-COMMAREA)
  1323			       LENGTH (+26)
  1324			  END-EXEC
  1354		       ELSE
  1355			  MOVE WS-INVALID-ACCESS TO ERRMSG1O
  1356		       END-IF
  1357		  WHEN DFHPF3
  1358                 MOVE 'SM001' TO WS-PGMID
  1359		       MOVE LOW-VALUES TO WS-STATE
  1360		       MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1362		       EXEC CICS
  1363			   SEND CONTROL
  1364			   ERASE
  1365		       END-EXEC
  1385		       EXEC CICS DELETEQ TS
  1386			    QUEUE(WS-QNAME)  1387		       END-EXEC
  1407		       EXEC CICS XCTL
  1408                      PROGRAM('SM000')
  1409			    COMMAREA(WS-COMMAREA)
  1410		       END-EXEC
  1434		  WHEN DFHPF5
  1435		       PERFORM 700-MOVE-FILES-TO-Q
  1436		  WHEN DFHPF7
  1437		       PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > 11
  1438			  MOVE LOW-VALUES TO DETL-SELECTI(WS-INDEX)
  1439		       END-PERFORM
  1440		       PERFORM 510-PF7-PAGE-UP
  1441
  1442		  WHEN DFHPF8
  1443		       PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > 11
  1444			  MOVE LOW-VALUES TO DETL-SELECTI(WS-INDEX)
  1445		       END-PERFORM
  1446		       PERFORM 520-PF8-PAGE-DOWN
  1447
  1448		  WHEN DFHPF12
  1449		       PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL WS-INDEX > 11
  1450			  MOVE LOW-VALUES TO DETL-SELECTI(WS-INDEX)
  1451		       END-PERFORM
  1452		       MOVE LOW-VALUES TO STATUSI
  1453		       MOVE LOW-VALUES TO TITLEI
  1454		       MOVE 1 TO WS-PAGE
  1455		       MOVE WS-PAGE TO PAGEO
  1456		       MOVE -1 TO TITLEL
  1457		       PERFORM 700-MOVE-FILES-TO-Q
  1458		       PERFORM 600-MOVE-Q-TO-SCREEN
  1459		       PERFORM 111-CREATE-MAP
  1460		  WHEN DFHENTER
  1461		       MOVE 1 TO WS-STATE
  1462		       PERFORM 550-PAGE-CHANGED
  1463
  1464		  WHEN OTHER
  1465                 MOVE 'INAVLID PFKEY PRESSED' TO ERRMSG1O
  1466		       PERFORM 600-MOVE-Q-TO-SCREEN
  1467		       PERFORM 111-CREATE-MAP
  1468		  END-EVALUATE
  1469             MOVE 'N' TO WS-PAGE-CHANGED.
  1470	      500-EXIT.
  1471		  EXIT.
  1472
  1473	      510-PF7-PAGE-UP.
  1474		  SUBTRACT 11 FROM WS-QITEM-PAGE
  1475		  IF WS-QITEM-PAGE = WS-QITEM-START OR
  1476		     WS-QITEM-PAGE <  WS-QITEM-START
  1477		     MOVE WS-FIRST-PAGE TO ERRMSG1O
  1478		     MOVE 1 TO WS-PAGE
  1479		     MOVE WS-QITEM-START TO WS-QITEM-PAGE
  1480		  ELSE
  1481		    MOVE WS-SELECT-OPTION TO ERRMSG1O
  1482		    SUBTRACT 1 FROM WS-PAGE
  1483		    MOVE WS-PAGE TO PAGEO
  1484		  END-IF
  1485		   MOVE -1 TO TITLEL
  1486		  MOVE WS-PAGE TO PAGEO
  1487		  PERFORM 600-MOVE-Q-TO-SCREEN
  1488		  PERFORM 111-CREATE-MAP.  1489	      510-EXIT.
  1490		  EXIT.
  1491
  1492
  1493	      520-PF8-PAGE-DOWN.
  1494		  ADD 11 TO WS-QITEM-PAGE
  1495		  IF WS-QITEM-PAGE > WS-QITEM-END
  1496		     SUBTRACT 11 FROM WS-QITEM-PAGE
  1497		      PERFORM 600-MOVE-Q-TO-SCREEN
  1498		  ELSE
  1499		     MOVE WS-SELECT-OPTION TO ERRMSG1O
  1500		     ADD 1 TO WS-PAGE
  1501		     MOVE WS-PAGE TO PAGEO
  1502		     PERFORM 600-MOVE-Q-TO-SCREEN
  1503		  END-IF.
  1504		   MOVE -1 TO TITLEL
  1505		  PERFORM 111-CREATE-MAP.
  1506	      520-EXIT.
  1507		  EXIT.
  1508
  1509	      550-PAGE-CHANGED.
  1510		  MOVE PAGEI TO WS-CURR-PAGE
  1511		  IF CURR-PAGE IS NUMERIC
  1512		     PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL
  1513			     WS-INDEX > WS-MAX-PAGE
  1514                 MOVE 'Y' TO WS-PAGE-INVALID
  1515		       IF CURR-PAGE = WS-INDEX
  1516                    MOVE 'N' TO WS-PAGE-INVALID
  1517			  SUBTRACT PREV-PAGE FROM CURR-PAGE GIVING
  1518				   WS-PAGE-UPDOWN
  1519			  EVALUATE TRUE
  1520			   WHEN CURR-PAGE > PREV-PAGE
  1521			     IF WS-PAGE-UPDOWN = 1
  1522				ADD 11 TO WS-QITEM-PAGE
  1523				PERFORM 530-PAGE-UP-ENTER
  1524                           MOVE 'Y' TO WS-PAGE-CHANGED
  1525			     ELSE
  1526				MOVE 1 TO WS-I
  1527				PERFORM UNTIL WS-I = CURR-PAGE
  1528					ADD 11 TO WS-QITEM-PAGE
  1529					ADD 1 TO WS-I
  1530				END-PERFORM
  1531				PERFORM 530-PAGE-UP-ENTER
  1532                           MOVE 'Y' TO WS-PAGE-CHANGED
  1533			     END-IF
  1534			   WHEN CURR-PAGE < PREV-PAGE
  1535			     IF WS-PAGE-UPDOWN = 1
  1536				SUBTRACT 11 FROM WS-QITEM-PAGE
  1537			       PERFORM 540-PAGEDOWN-ENTER
  1538                          MOVE 'Y' TO WS-PAGE-CHANGED
  1539			     ELSE
  1540				MOVE PREV-PAGE TO WS-I
  1541				PERFORM UNTIL WS-I = CURR-PAGE
  1542					SUBTRACT 11 FROM WS-QITEM-PAGE
  1543					SUBTRACT 1 FROM WS-I
  1544				END-PERFORM
  1545				PERFORM 540-PAGEDOWN-ENTER
  1546                           MOVE 'Y' TO WS-PAGE-CHANGED
  1547			     END-IF
  1548			   WHEN OTHER  1549				PERFORM 560-CHECK-OPTION-FIELDS
  1550
  1551			  END-EVALUATE
  1552		       END-IF
  1553		     END-PERFORM
  1554               IF WS-PAGE-INVALID = 'Y'
  1555			EVALUATE TRUE
  1556			  WHEN CURR-PAGE > WS-MAX-PAGE
  1557			       MOVE 1 TO WS-I
  1558			       PERFORM UNTIL WS-I = WS-MAX-PAGE
  1559				       ADD 11 TO WS-QITEM-PAGE
  1560				       ADD 1 TO WS-I
  1561			       END-PERFORM
  1562			       MOVE -1 TO PAGEL
  1563			       MOVE WS-MAX-PAGE TO PAGEO
  1564			       MOVE WS-MAX-PAGE TO WS-PAGE
  1565			      IF WS-QITEM-PAGE > WS-QITEM-END
  1566				 SUBTRACT 11 FROM WS-QITEM-PAGE
  1567				 MOVE WS-LAST-PAGE TO ERRMSG1O
  1568			      ELSE
  1569				 MOVE WS-SELECT-OPTION TO
  1570				  ERRMSG1O
  1571				 PERFORM 600-MOVE-Q-TO-SCREEN
  1572			      END-IF
  1573			      PERFORM 111-CREATE-MAP
  1574			  WHEN CURR-PAGE < 1
  1575			       MOVE PREV-PAGE TO WS-I
  1576			       PERFORM UNTIL WS-I = CURR-PAGE
  1577				       SUBTRACT 11 FROM WS-QITEM-PAGE
  1578				       SUBTRACT 1 FROM WS-I
  1579			       END-PERFORM
  1580			       PERFORM 540-PAGEDOWN-ENTER
  1581			END-EVALUATE
  1582		     ELSE
  1583                   MOVE 'N' TO WS-PAGE-INVALID
  1584		     END-IF
  1585		  ELSE
  1586		      PERFORM 600-MOVE-Q-TO-SCREEN
  1587		      PERFORM 111-CREATE-MAP
  1588		  END-IF.
  1589	      550-EXIT.
  1590		  EXIT.
  1591
  1592	      560-CHECK-OPTION-FIELDS.
  1593		  PERFORM 600-MOVE-Q-TO-SCREEN
  1594		  MOVE 1 TO WS-INDEX
  1595		  MOVE 0 TO WS-SELECT-COUNT
  1596		  PERFORM UNTIL WS-INDEX > 11
  1597               IF DETL-SELECTI(WS-INDEX) NOT = '-' AND
  1598			DETL-SELECTI(WS-INDEX) NOT = SPACES AND
  1599			DETL-SELECTI(WS-INDEX) NOT = LOW-VALUES
  1600                  IF DETL-SELECTI(WS-INDEX) = 'U' OR
  1601                     DETL-SELECTI(WS-INDEX) = 'C' OR
  1602                     DETL-SELECTI(WS-INDEX) = 'A' OR
  1603                     DETL-SELECTI(WS-INDEX) = 'X'
  1604			   ADD 1 TO WS-SELECT-COUNT
  1605			   MOVE DETL-SELECTI(WS-INDEX) TO WS-SELECTED-VALUE
  1606			   MOVE DETL-DETAILI(WS-INDEX) TO WS-STF01-REC
  1607			   MOVE WS-STF-REQ2(WS-INDEX)  TO WS-STF01-REQ
  1608			ELSE  1609			   PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1610			   MOVE WS-INVALID-VALUE TO ERRMSG1O
  1611			   PERFORM 600-MOVE-Q-TO-SCREEN
  1612			   PERFORM 111-CREATE-MAP
  1613			END-IF
  1614
  1615		     END-IF
  1616		     ADD 1 TO WS-INDEX
  1617		  END-PERFORM
  1618		  IF WS-SELECT-COUNT = 1 OR 0
  1619			 EVALUATE WS-SELECTED-VALUE
  1620                    WHEN 'U'
  1621                        IF WS-STF01-STATUS = 'APPROVED' OR
  1622                           'ONGOING'
  1623                           IF USR-REQUESTOR = 'Y'  OR
  1624                              USR-SERVICE = 'Y'
  1625				    IF WS-STF01-REQ = USERID
  1626                                  MOVE 'SM001'   TO WS-PGMID
  1627				     MOVE 1	    TO WS-STATE
  1628				     MOVE WS-STF01-ID TO WS-TICKET-PASSED
  1629				       MOVE LENGTH OF WS-COMMAREA TO
  1630					 WS-LENGTH
  1632				       EXEC CICS XCTL
  1633                                      PROGRAM ('SM003')
  1634					    COMMAREA (WS-COMMAREA)
  1635					    LENGTH (WS-LENGTH)
  1636				       END-EXEC
  1666                                 MOVE 'SM003' TO ERRMSG1O
  1667				    ELSE
  1668				       MOVE WS-INVALID-TIX-ACC TO ERRMSG1O
  1669				       MOVE DFHUNIMD TO
  1670					  DETL-SELECTA(WS-INDEX)
  1671				     MOVE -1 TO DETL-SELECTL(WS-INDEX)
  1672				    END-IF
  1673				 ELSE
  1674				   MOVE WS-INVALID-TIX-ACC TO ERRMSG1O
  1675				   PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1676				 END-IF
  1677			      ELSE
  1678				  MOVE WS-INVALID-TIX-ACC TO ERRMSG1O
  1679				  PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1680			      END-IF
  1681                    WHEN 'C'
  1682                         IF WS-STF01-STATUS = 'COMPLETED'
  1683				  IF WS-STF01-REQ = USERID
  1684                               MOVE 'SM001'   TO WS-PGMID
  1685				     MOVE 1	    TO WS-STATE
  1686				     MOVE WS-STF01-ID TO WS-TICKET-PASSED
  1687				     MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1689				     EXEC CICS XCTL
  1690                                    PROGRAM ('SM004')
  1691					  COMMAREA (WS-COMMAREA)
  1692					  LENGTH (WS-LENGTH)
  1693				     END-EXEC
  1723                               MOVE 'SM004' TO ERRMSG1O
  1724				  ELSE
  1725				     MOVE WS-INVALID-TIX-ACC TO ERRMSG1O
  1726				     PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1727				  END-IF
  1728			       ELSE  1729				  MOVE WS-INVALID-TIX-ACC TO ERRMSG1O
  1730				  PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1731			       END-IF
  1732                    WHEN 'A'
  1733                         IF WS-STF01-STATUS = 'CREATED'
  1734				  IF WS-STF01-REQ = USERID
  1735                               MOVE 'SM001'   TO WS-PGMID
  1736				     MOVE 1	    TO WS-STATE
  1737				     MOVE WS-STF01-ID TO WS-TICKET-PASSED
  1738				     MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1740				     EXEC CICS XCTL
  1741                                    PROGRAM ('SM005')
  1742					  COMMAREA (WS-COMMAREA)
  1743					  LENGTH (WS-LENGTH)
  1744				     END-EXEC
  1774				  ELSE
  1775				     MOVE WS-INVALID-TIX-ACC TO ERRMSG1O
  1776				     PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1777				  END-IF
  1778				ELSE
  1779				  MOVE WS-INVALID-TIX-ACC TO ERRMSG1O
  1780				  PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1781				END-IF
  1782                    WHEN 'X'
  1783			       IF WS-STF01-REQ = USERID
  1784                            MOVE 'SM001'   TO WS-PGMID
  1785				  MOVE 1	 TO WS-STATE
  1786				  MOVE WS-STF01-ID TO WS-TICKET-PASSED
  1787				  MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1789				  EXEC CICS XCTL
  1790                                 PROGRAM ('SM006')
  1791				       COMMAREA (WS-COMMAREA)
  1792				       LENGTH (WS-LENGTH)
  1793				  END-EXEC
  1823			       ELSE
  1824				  MOVE WS-INVALID-TIX-ACC TO ERRMSG1O
  1825				  PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1826			       END-IF
  1827			  WHEN 0
  1828			       PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1829			       MOVE WS-FIELD-REQ TO ERRMSG1O
  1830			       PERFORM 600-MOVE-Q-TO-SCREEN
  1831			       PERFORM 111-CREATE-MAP
  1832			  WHEN OTHER
  1833			       PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1834			       MOVE WS-INVALID-VALUE TO ERRMSG1O
  1835			       PERFORM 600-MOVE-Q-TO-SCREEN
  1836			       PERFORM 111-CREATE-MAP
  1837			 END-EVALUATE
  1838		      ELSE
  1839			PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1840			MOVE WS-MULTIPLE-SELECT TO ERRMSG1O
  1841			PERFORM 600-MOVE-Q-TO-SCREEN
  1842			PERFORM 111-CREATE-MAP
  1843			IF WS-SELECT-COUNT < 1
  1844			   PERFORM 56A-HIGHLIGHT-ERR-FIELD
  1845			   MOVE WS-FIELD-REQ TO ERRMSG1O
  1846			   PERFORM 600-MOVE-Q-TO-SCREEN
  1847			   PERFORM 111-CREATE-MAP
  1848			END-IF  1849		      END-IF.
  1850	      560-EXIT.
  1851		  EXIT.
  1852
  1853	      56A-HIGHLIGHT-ERR-FIELD.
  1854		  PERFORM VARYING WS-INDEX FROM 1 BY 1 UNTIL
  1855		    WS-INDEX > 11
  1856                IF DETL-SELECTI(WS-INDEX) NOT = '-' AND
  1857			DETL-SELECTI(WS-INDEX) NOT = SPACES AND
  1858			DETL-SELECTI(WS-INDEX) NOT = LOW-VALUES
  1859			MOVE DFHUNIMD TO DETL-SELECTA(WS-INDEX)
  1860			MOVE -1       TO DETL-SELECTL(WS-INDEX)
  1861		      END-IF
  1862		  END-PERFORM.
  1863	      56A-EXIT.
  1864		  EXIT.
  1865
  1866	      600-MOVE-Q-TO-SCREEN.
  1867		  MOVE PAGEO TO WS-PREV-PAGE
  1868		  MOVE WS-QITEM-PAGE TO WS-QITEM
  1870		  EXEC CICS READQ TS
  1871			    QUEUE(WS-QNAME)
  1872			    INTO (WS-STF-REC)
  1873			    LENGTH(WS-REC-LENGTH)
  1874			    ITEM (WS-QITEM)
  1875		   END-EXEC
  1910		  MOVE 1 TO WS-INDEX
  1911		  PERFORM UNTIL WS-INDEX > 11
  1913		      IF EIBRESP = DFHRESP(NORMAL) AND
  1915		      IF EIBRESP =	   000	   AND			       R
  1916			 WS-QITEM <= WS-QITEM-END
  1917			 MOVE WS-TICKET-ID TO DETAILS-TIX-ID(WS-INDEX)
  1918			 MOVE WS-TICKET-REQ TO WS-STF-REQ2(WS-INDEX)
  1919			 MOVE WS-TICKET-STAT TO
  1920			      DETAILS-TIX-STAT(WS-INDEX)
  1921			 MOVE WS-TICKET-TITLE TO
  1922			      DETAILS-TIX-TITLE(WS-INDEX)
  1923			 MOVE WS-UPD-BY TO DETAILS-UPD-BY(WS-INDEX)
  1924			 MOVE WS-LAST-UPD TO DETAILS-LAST-UPD(WS-INDEX)
  1925			 ADD 1 TO WS-INDEX
  1926			 ADD 1 TO WS-QITEM
  1928			 EXEC CICS READQ TS
  1929			      QUEUE(WS-QNAME)
  1930			      INTO (WS-STF-REC)
  1931			      ITEM (WS-QITEM)
  1932			END-EXEC
  1962		     ELSE
  1963			MOVE SPACES TO DETL-DETAILI(WS-INDEX)
  1964			MOVE SPACES TO DETL-SELECTI(WS-INDEX)
  1965			 MOVE DFHBMASK TO DETL-DETAILA(WS-INDEX)
  1966			 MOVE DFHBMASK TO DETL-SELECTA(WS-INDEX)
  1967	     *		MOVE WS-LAST-PAGE  TO ERRMSG1O
  1968                  MOVE '1' TO WS-LASTPAGE
  1969			ADD 1 TO WS-INDEX
  1970		     END-IF
  1971		  END-PERFORM
  1972		  MOVE DETAILS-TIX-ID(1) TO WS-FUSER.
  1973
  1974	      600-EXIT.
  1975		  EXIT.  1976
  1977	      710-READ-STF001.
  1978		   MOVE LOW-VALUES TO WS-KEYB.
  1979		  MOVE LENGTH OF WS-STF-REC TO WS-REC-LENGTH
  1981		   EXEC CICS
  1982                STARTBR FILE('STF001C')
  1983		      RIDFLD (WS-KEYB)
  1984		      GTEQ
  1985		   END-EXEC
  2012
  2014		   EXEC CICS
  2015                 READNEXT FILE('STF001C')
  2016		       INTO (WS-STF-REC)
  2017		       RIDFLD (WS-KEYB)
  2018		   END-EXEC.
  2048	      710-EXIT.
  2049		  EXIT.
  2050
  2051	      700-MOVE-FILES-TO-Q.
  2053		  EXEC CICS DELETEQ TS
  2054			    QUEUE(WS-QNAME)
  2055		  END-EXEC
  2074		  PERFORM  710-READ-STF001
  2075	     *	  modified filter
  2076		  EVALUATE TRUE
  2077		    WHEN TITLEI NOT = LOW-VALUES AND STATUSI NOT = LOW-VALUES
  2078			  IF TITLEI = WS-TICKET-TITLE AND
  2079			     STATUSI = WS-TICKET-STAT
  2081			     EXEC CICS WRITEQ TS
  2082				  QUEUE(WS-QNAME)
  2083				  FROM (WS-STF-REC)
  2084				  LENGTH (WS-REC-LENGTH)
  2085				  ITEM (WS-QITEM)
  2086			     END-EXEC
  2121			 END-IF
  2122		    WHEN TITLEI NOT = LOW-VALUES
  2123			 IF TITLEI = WS-TICKET-TITLE
  2125			    EXEC CICS WRITEQ TS
  2126				 QUEUE(WS-QNAME)
  2127				 FROM (WS-STF-REC)
  2128				 LENGTH (WS-REC-LENGTH)
  2129				 ITEM (WS-QITEM)
  2130			    END-EXEC
  2165			 END-IF
  2166		    WHEN STATUSI NOT = LOW-VALUES
  2167			 IF STATUSI = WS-TICKET-STAT
  2169			    EXEC CICS WRITEQ TS
  2170				 QUEUE(WS-QNAME)
  2171				 FROM (WS-STF-REC)
  2172				 LENGTH (WS-REC-LENGTH)
  2173				 ITEM (WS-QITEM)
  2174			    END-EXEC
  2209			 END-IF
  2210		    WHEN OTHER
  2212			  EXEC CICS WRITEQ TS
  2213				    QUEUE(WS-QNAME)
  2214				    FROM (WS-STF-REC)
  2215				    LENGTH (WS-REC-LENGTH)
  2216				    ITEM (WS-QITEM)
  2217			  END-EXEC  2252		  END-EVALUATE
  2253		  MOVE WS-QITEM TO WS-QITEM-START
  2254		  MOVE 1 TO WS-TOTAL-QITEM
  2256		  PERFORM UNTIL EIBRESP NOT = DFHRESP(NORMAL)
  2258		  PERFORM UNTIL EIBRESP NOT =	      000		       R
  2259		      MOVE WS-QITEM TO WS-QITEM-END
  2261		      EXEC CICS
  2262                     READNEXT FILE('STF001C')
  2263			   INTO (WS-STF-REC)
  2264			   RIDFLD (WS-KEYB)
  2265		      END-EXEC
  2295		      IF EIBRESP = DFHRESP(NORMAL)
  2297		      IF EIBRESP =	   000				       R
  2298			  EVALUATE TRUE
  2299			    WHEN TITLEI NOT = LOW-VALUES AND
  2300				 STATUSI NOT = LOW-VALUES
  2301				 IF TITLEI = WS-TICKET-TITLE AND
  2302				    STATUSI = WS-TICKET-STAT
  2303
  2305				    EXEC CICS WRITEQ TS
  2306					 QUEUE(WS-QNAME)
  2307					 FROM (WS-STF-REC)
  2308					 LENGTH (WS-REC-LENGTH)
  2309					 ITEM (WS-QITEM)
  2310				    END-EXEC
  2345				    ADD 1 TO WS-TOTAL-QITEM
  2346				 END-IF
  2347			    WHEN TITLEI NOT = LOW-VALUES
  2348				 IF TITLEI = WS-TICKET-TITLE
  2349
  2351				    EXEC CICS WRITEQ TS
  2352					 QUEUE(WS-QNAME)
  2353					 FROM (WS-STF-REC)
  2354					 LENGTH (WS-REC-LENGTH)
  2355					 ITEM (WS-QITEM)
  2356				    END-EXEC
  2391				    ADD 1 TO WS-TOTAL-QITEM
  2392				 END-IF
  2393			    WHEN STATUSI NOT = LOW-VALUES
  2394				 IF STATUSI = WS-TICKET-STAT
  2395
  2397				    EXEC CICS WRITEQ TS
  2398					 QUEUE(WS-QNAME)
  2399					 FROM (WS-STF-REC)
  2400					 LENGTH (WS-REC-LENGTH)
  2401					 ITEM (WS-QITEM)
  2402				    END-EXEC
  2437				     ADD 1 TO WS-TOTAL-QITEM
  2438				 END-IF
  2439			    WHEN OTHER
  2441				  EXEC CICS WRITEQ TS
  2442					    QUEUE(WS-QNAME)
  2443					    FROM (WS-STF-REC)
  2444					    LENGTH (WS-REC-LENGTH)
  2445					    ITEM (WS-QITEM)
  2446				  END-EXEC
  2481				   ADD 1 TO WS-TOTAL-QITEM
  2482			  END-EVALUATE
  2483			 MOVE WS-T-ID TO WS-KEYB6
  2484			 MOVE HIGH-VALUES TO WS-KEYB1  2485
  2486		      END-IF
  2487		  END-PERFORM
  2488		      DIVIDE WS-TOTAL-QITEM BY 11 GIVING WS-MAX-PAGE
  2489		      ADD 1 TO WS-MAX-PAGE
  2491		  EXEC CICS
  2492                 ENDBR FILE('STF001C')
  2493		  END-EXEC
  2512		  MOVE WS-QITEM-START TO WS-QITEM-PAGE.
  2513
  2514	      700-EXIT.
  2515		  EXIT.
  2516
  2517CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\SM001.cic	       PAGE   27



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    2528
			Compilation time (mm:ss.ss):  0:00.05
			Compilation speed (lines/minute): 33600

			Compilation date (yy/mm/dd): 23/12/06
			     Time of day (hh:mm:ss): 22:23:55