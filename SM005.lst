     5	     *CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM005.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      FILE SECTION.
    29	     *----------------------------------------------------------------*
    30	     *			      WORKING STORAGE			      *
    31	     *----------------------------------------------------------------*
    32	      WORKING-STORAGE SECTION.
    33		  COPY SM05S.
    35	     * SYMBOLIC MAP of SM05S Created by CACXBMS Version 6.0.27
    81	      01  SM005MI.
    82		  02  FILLER				     PIC X(12).
    83		  02  DATEL				     PIC S9(4) COMP.
    84		  02  DATEF				     PIC X.
    85		  02  FILLER REDEFINES DATEF.
    86		      03  DATEA 			     PIC X.
    87		  02  DATEI				     PIC X(010).
    88		  02  TIMEL				     PIC S9(4) COMP.
    89		  02  TIMEF				     PIC X.
    90		  02  FILLER REDEFINES TIMEF.
    91		      03  TIMEA 			     PIC X.
    92		  02  TIMEI				     PIC X(008).
    93		  02  TKTNUML				     PIC S9(4) COMP.
    94		  02  TKTNUMF				     PIC X.
    95		  02  FILLER REDEFINES TKTNUMF.
    96		      03  TKTNUMA			     PIC X.
    97		  02  TKTNUMI				     PIC X(006).
    98		  02  REQBYL				     PIC S9(4) COMP.
    99		  02  REQBYF				     PIC X.
   100		  02  FILLER REDEFINES REQBYF.
   101		      03  REQBYA			     PIC X.
   102		  02  REQBYI				     PIC X(006).
   103		  02  TKTLEL				     PIC S9(4) COMP.
   104		  02  TKTLEF				     PIC X.
   105		  02  FILLER REDEFINES TKTLEF.
   106		      03  TKTLEA			     PIC X.
   107		  02  TKTLEI				     PIC X(025).
   108		  02  TKDESL				     PIC S9(4) COMP.
   109		  02  TKDESF				     PIC X.
   110		  02  FILLER REDEFINES TKDESF.
   111		      03  TKDESA			     PIC X.
   112		  02  TKDESI				     PIC X(040).
   113		  02  STATL				     PIC S9(4) COMP.
   114		  02  STATF				     PIC X.
   115		  02  FILLER REDEFINES STATF.
   116		      03  STATA 			     PIC X.
   117		  02  STATI				     PIC X(010).
   118		  02  UPDTBYL				     PIC S9(4) COMP.
   119		  02  UPDTBYF				     PIC X.
   120		  02  FILLER REDEFINES UPDTBYF.
   121		      03  UPDTBYA			     PIC X.
   122		  02  UPDTBYI				     PIC X(006).
   123		  02  UPDREML				     PIC S9(4) COMP.
   124		  02  UPDREMF				     PIC X.   125		  02  FILLER REDEFINES UPDREMF.
   126		      03  UPDREMA			     PIC X.
   127		  02  UPDREMI				     PIC X(025).
   128		  02  UPDTL				     PIC S9(4) COMP.
   129		  02  UPDTF				     PIC X.
   130		  02  FILLER REDEFINES UPDTF.
   131		      03  UPDTA 			     PIC X.
   132		  02  UPDTI				     PIC X(019).
   133		  02  ERRMSGL				     PIC S9(4) COMP.
   134		  02  ERRMSGF				     PIC X.
   135		  02  FILLER REDEFINES ERRMSGF.
   136		      03  ERRMSGA			     PIC X.
   137		  02  ERRMSGI				     PIC X(071).
   138	      01  SM005MO REDEFINES SM005MI.
   139		  02  FILLER				     PIC X(12).
   140		  02  FILLER				     PIC XX.
   141		  02  FILLER				     PIC X.
   142		  02  DATEO				     PIC X(010).
   143		  02  FILLER				     PIC XX.
   144		  02  FILLER				     PIC X.
   145		  02  TIMEO				     PIC X(008).
   146		  02  FILLER				     PIC XX.
   147		  02  FILLER				     PIC X.
   148		  02  TKTNUMO				     PIC X(006).
   149		  02  FILLER				     PIC XX.
   150		  02  FILLER				     PIC X.
   151		  02  REQBYO				     PIC X(006).
   152		  02  FILLER				     PIC XX.
   153		  02  FILLER				     PIC X.
   154		  02  TKTLEO				     PIC X(025).
   155		  02  FILLER				     PIC XX.
   156		  02  FILLER				     PIC X.
   157		  02  TKDESO				     PIC X(040).
   158		  02  FILLER				     PIC XX.
   159		  02  FILLER				     PIC X.
   160		  02  STATO				     PIC X(010).
   161		  02  FILLER				     PIC XX.
   162		  02  FILLER				     PIC X.
   163		  02  UPDTBYO				     PIC X(006).
   164		  02  FILLER				     PIC XX.
   165		  02  FILLER				     PIC X.
   166		  02  UPDREMO				     PIC X(025).
   167		  02  FILLER				     PIC XX.
   168		  02  FILLER				     PIC X.
   169		  02  UPDTO				     PIC X(019).
   170		  02  FILLER				     PIC XX.
   171		  02  FILLER				     PIC X.
   172		  02  ERRMSGO				     PIC X(071).
   174		  COPY DFHAID.
   176	      01  DFHAID.
   177	     *
   178	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   179	     *
   180	     * Revision Information
   181	     * ^{File:dfhaid.cob  }
   182	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   183	     * ^{Revision:2.0}
   184	     *
   185	     *This is the AID constants copy file
   186	     *   187            05  DFHENTER                  PIC X VALUE ''''.
   188	     *					value APOST
   189            05  DFHCLEAR                  PIC X VALUE '_'.
   190            05  DFHPA1                    PIC X VALUE '%'.
   191            05  DFHPA2                    PIC X VALUE '>'.
   192            05  DFHPA3                    PIC X VALUE ','.
   193            05  DFHPF1                    PIC X VALUE '1'.
   194            05  DFHPF2                    PIC X VALUE '2'.
   195            05  DFHPF3                    PIC X VALUE '3'.
   196            05  DFHPF4                    PIC X VALUE '4'.
   197            05  DFHPF5                    PIC X VALUE '5'.
   198            05  DFHPF6                    PIC X VALUE '6'.
   199            05  DFHPF7                    PIC X VALUE '7'.
   200            05  DFHPF8                    PIC X VALUE '8'.
   201            05  DFHPF9                    PIC X VALUE '9'.
   202            05  DFHPF10                   PIC X VALUE ':'.
   203            05  DFHPF11                   PIC X VALUE '#'.
   204            05  DFHPF12                   PIC X VALUE '@'.
   205            05  DFHPF13                   PIC X VALUE 'A'.
   206            05  DFHPF14                   PIC X VALUE 'B'.
   207            05  DFHPF15                   PIC X VALUE 'C'.
   208            05  DFHPF16                   PIC X VALUE 'D'.
   209            05  DFHPF17                   PIC X VALUE 'E'.
   210            05  DFHPF18                   PIC X VALUE 'F'.
   211            05  DFHPF19                   PIC X VALUE 'G'.
   212            05  DFHPF20                   PIC X VALUE 'H'.
   213            05  DFHPF21                   PIC X VALUE 'I'.
   214            05  DFHPF22                   PIC X VALUE '›'.
   215       *                                  EBCDIC Cent sign x'4A'
   216       *                                  ASCII  Cent sign x'9B'
   217            05  DFHPF23                   PIC X VALUE '.'.
   218            05  DFHPF24                   PIC X VALUE '<'.
   219            05  DFHOPID                   PIC X VALUE 'W'.
   220            05  DFHMSRE                   PIC X VALUE 'X'.
   221            05  DFHTRIG                   PIC X VALUE '"'.
   222       *                                        value QUOTE  "
   223            05  DFHPEN                    PIC X VALUE '='.
   224            05  DFHCLRP                   PIC X VALUE 'Ý'.
   225       *                                  EBCDIC x'6A'
   226       *                                  ASCII  x'DD'
   227            05  DFHSTRF                   PIC X VALUE 'h'.
   228	     *	  DFHQUIT is a CA-Realia CICS Extension
   229	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   230            05  DFHQUIT                   PIC X VALUE '!'.
   231		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   233		  COPY DFHBMSCA.
   235	      01  DFHBMSCA.
   236	     *
   237	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   238	     *
   239	     * Revision Information
   240	     * ^{File:dfhbmsca.cob}
   241	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   242	     * ^{Revision:2.0}
   243	     *
   244	     *	Note:This FILE is provided with most values as quoted literals
   245	     *	     so that the file can be used for both ASCII and EBCDIC
   246	     *	     programs
   247	     *
   248	     *	     The only exceptions are some 3270 Data Stream Orders   249	     *	     They use different Hexadecimal values for ASCII and
   250	     *	     EBCDIC and they cannot be expressed as quoted literals
   251	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   252	     *	     characters in ASCII
   253	     *
   254	     *	     They have their values set up to default to the EBCDIC
   255	     *	     values.
   256	     *
   257	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   258	     *	     and SEND TEXT with imbedded format orders.
   259	     *	     If you use these values in ASCII programs the values
   260	     *	     must be changed.
   261	     *
   262	     *	     An alternative is to use REPLACING to change the values.
   263	     *
   264	     *	  i.e. COPY DFHBMSCA replacing
   265	     *			    ==005== BY ==009==	*> DFHPT
   266	     *			    ==021== BY ==010==	*> DFHNL
   267	     *			    ==040== BY ==021==	*> DFHSA
   268	     *			    ==041== BY ==031==	*> DFHSFE
   269	     *			    ==044== BY ==023==	*> DFHMF
   270	     *			    ==060== BY ==020==	*> DFHRA
   271	     *			    ==063== BY ==026==. *> DFHSUB
   272	     *
   273	     ******************************************************************
   274	     *BMS and Terminal Control - Order & Attributes constants	      *
   275	     ******************************************************************
   276	     *
   277	     *	  Field Attributes
   278	     *
   279            05  DFHBMASB                          PIC X VALUE '8'.
   280            05  DFHBMASF                          PIC X VALUE '1'.
   281            05  DFHBMASK                          PIC X VALUE '0'.
   282            05  DFHBMBRY                          PIC X VALUE 'H'.
   283            05  DFHBMDAR                          PIC X VALUE '<'.
   284            05  DFHBMFSE                          PIC X VALUE 'A'.
   285            05  DFHBMPRF                          PIC X VALUE '/'.
   286            05  DFHBMPRO                          PIC X VALUE '-'.
   287            05  DFHBMUNN                          PIC X VALUE '&'.
   288            05  DFHBMUNP                          PIC X VALUE ' '.
   289            05  DFHUNNUM                          PIC X VALUE 'J'.
   290	     *
   291	     *	  partially supported
   292	     *
   293            05  DFHUNNOD                          PIC X VALUE '('.
   294            05  DFHUNIMD                          PIC X VALUE 'I'.
   295            05  DFHUNINT                          PIC X VALUE 'R'.
   296            05  DFHUNNON                          PIC X VALUE '('.
   297            05  DFHPROTI                          PIC X VALUE 'Y'.
   298            05  DFHPROTN                          PIC X VALUE '%'.
   299	     *
   300	     *	  These values are additions to mainframe constants
   301	     *
   302            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   303            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   304            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   305	     *						      VALUE APOST
   306            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   307            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   308            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.   309            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   310            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   311	     *
   312	     *	  Field Flag values
   313		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   314		  05  FILLER REDEFINES DFHBMEOF-VAL.
   315		      10  FILLER			PIC X.
   316		      10  DFHBMEOF			PIC X.
   317       *                                          x'80'.
   318		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   319		  05  FILLER REDEFINES DFHBMCUR-VAL.
   320		      10  FILLER			PIC X.
   321		      10  DFHBMCUR			PIC X.
   322       *                                          x'02'.
   323		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   324		  05  FILLER REDEFINES DFHBMMEC-VAL.
   325		      10  FILLER			PIC X.
   326		      10  DFHBMMEC			PIC X.
   327       *                                          x'82'.
   328       *                                          x'02'.
   329		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   330		      88  DFHERASE			VALUES 128 130.
   331       *                                          x'80' X'82'
   332		      88  DFHCURSR			VALUES 002 130.
   333       *                                          x'02' X'82'
   334		  05  FILLER REDEFINES DFHBMFLG-VAL.
   335		      10  FILLER			PIC X.
   336		      10  DFHBMFLG			PIC X.
   337
   338		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   339		  05  FILLER REDEFINES DFHBMDUP-VAL.
   340		      10  FILLER			PIC X.
   341		      10  DFHBMDUP			PIC X.
   342       *                                              x'1C'
   343	     *
   344	     ******************************************************************
   345	     *	  supported 327X Extended Attributes
   346	     *
   347	     *	  Extended COLOR Attributes
   348	     *
   349            05  DFHDFCOL                          PIC X VALUE '0'.
   350            05  DFHBLUE                           PIC X VALUE '1'.
   351            05  DFHRED                            PIC X VALUE '2'.
   352            05  DFHPINK                           PIC X VALUE '3'.
   353            05  DFHGREEN                          PIC X VALUE '4'.
   354            05  DFHTURQ                           PIC X VALUE '5'.
   355            05  DFHYELLO                          PIC X VALUE '6'.
   356            05  DFHNEUTR                          PIC X VALUE '7'.
   357	     *
   358	     *	  Extended HILIGHT Attributes
   359	     *
   360            05  DFHDFHI                           PIC X VALUE '0'.
   361            05  DFHBLINK                          PIC X VALUE '1'.
   362            05  DFHREVRS                          PIC X VALUE '2'.
   363            05  DFHUNDLN                          PIC X VALUE '4'.
   364	     *
   365	     ******************************************************************
   366	     *	  supported 327X Data Stream Orders
   367	     *
   368		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.   369		  05  FILLER REDEFINES DFHSBA-VAL.
   370		      10  FILLER			PIC X.
   371		      10  DFHSBA			PIC X.
   372       *                                              x'11'
   373		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   374		  05  FILLER REDEFINES DFHEUA-VAL.
   375		      10  FILLER			PIC X.
   376		      10  DFHEUA			PIC X.
   377       *                                              x'12'
   378		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   379		  05  FILLER REDEFINES DFHIC-VAL.
   380		      10  FILLER			PIC X.
   381		      10  DFHIC 			PIC X.
   382       *                                              X'13'.
   383		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   384		  05  FILLER REDEFINES DFHSF-VAL.
   385		      10  FILLER			PIC X.
   386		      10  DFHSF 			PIC X.
   387       *                                              X'1D'.
   388		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   389		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   390		      88 DFHPT-VAL-ASCII		VALUE 9.
   391		  05  FILLER REDEFINES DFHPT-VAL.
   392		      10  FILLER			PIC X.
   393		      10  DFHPT 			PIC X.
   394       *                                              EBCDIC X'05'.
   395       *                                              ASCII  X'09'.
   396		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   397		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   398		      88 DFHRA-VAL-ASCII		VALUE 20.
   399		  05  FILLER REDEFINES DFHRA-VAL.
   400		      10  FILLER			PIC X.
   401		      10  DFHRA 			PIC X.
   402       *                                              EBCDIC x'3C'
   403       *                                              ASCII  x'14'
   404		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   405		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   406		      88 DFHSFE-VAL-ASCII		VALUE 31.
   407		  05  FILLER REDEFINES DFHSFE-VAL.
   408		      10  FILLER			PIC X.
   409		      10  DFHSFE			PIC X.
   410       *                                              EBCDIC x'29'
   411       *                                              ASCII  x'1F'
   412		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   413		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   414		      88 DFHMF-VAL-ASCII		VALUE 23.
   415		  05  FILLER REDEFINES DFHMF-VAL.
   416		      10  FILLER			PIC X.
   417		      10  DFHMF 			PIC X.
   418       *                                              EBCDIC x'2C'
   419       *                                              ASCII  x'17'
   420	     *
   421	     ******************************************************************
   422	     *	  unsupported 327X Data Stream order codes
   423	     *
   424		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   425		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   426		      88 DFHSA-VAL-ASCII		VALUE 21.
   427		  05  FILLER REDEFINES DFHSA-VAL.
   428		      10  FILLER			PIC X.   429		      10  DFHSA 			PIC X.
   430       *                                              EBCDIC x'28'
   431       *                                              ASCII  x'15'
   432		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   433		  05  FILLER REDEFINES DFHGE-VAL.
   434		      10  FILLER			PIC X.
   435		      10  DFHGE 			PIC X.
   436       *                                              X'08'.
   437	     *
   438	     ******************************************************************
   439	     *	  SFE and MF supported attribute types
   440	     *
   441            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   442       *                                              EBCDIC x'42'
   443       *                                              ASCII  x'83'
   444            05  DFHHLT                            PIC X VALUE 'Ö'.
   445       *                                              EBCDIC x'41'
   446       *                                              ASCII  x'D6'
   447            05  DFH3270                           PIC X VALUE '{'.
   448	     *
   449	     *	  supported for SEND TEXT command and printer terminal
   450	     *
   451		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   452		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   453		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   454		  05  FILLER REDEFINES DFHBMPNL-VAL.
   455		      10  FILLER			PIC X.
   456		      10  DFHBMPNL			PIC X.
   457       *                                              EBCDIC X'15'.
   458       *                                              ASCII  X'0A'.
   459	     *
   460	     ******************************************************************
   461	     *	  Printer terminal data stream only
   462	     *
   463		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   464		  05  FILLER REDEFINES DFHBMPFF-VAL.
   465		      10  FILLER			PIC X.
   466		      10  DFHBMPFF			PIC X.
   467       *                                              X'0C'.
   468		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   469		  05  FILLER REDEFINES DFHBMPCR-VAL.
   470		      10  FILLER			PIC X.
   471		      10  DFHBMPCR			PIC X.
   472       *                                              X'0D'.
   473		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   474		  05  FILLER REDEFINES DFHBMPEM-VAL.
   475		      10  FILLER			PIC X.
   476		      10  DFHBMPEM			PIC X.
   477       *                                              X'19'.
   478	     *
   479	     ******************************************************************
   480	     *	  unsupported Miscellaneous attributes and constants
   481	     *
   482		  05  DFHALL				PIC X VALUE LOW-VALUES.
   483            05  DFHBASE                           PIC X VALUE '0'.
   484		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   485		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   486		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   487		      10  DFHBMPSO			PIC X.
   488       *                                              X'0E'.   489		      10  DFHBMPSI			PIC X.
   490       *                                              X'0F'.
   491		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   492            05  DFHERROR                          PIC X VALUE '¶'.
   493       *                                              EBCDIC X'1A'.
   494       *                                              ASCII  X'B6'.
   495            05  DFHFIL                            PIC X VALUE '4'.
   496            05  DFHMENT                           PIC X VALUE '2'.
   497            05  DFHMET                            PIC X VALUE '3'.
   498            05  DFHMFE                            PIC X VALUE '6'.
   499            05  DFHMFET                           PIC X VALUE '7'.
   500            05  DFHMFT                            PIC X VALUE '5'.
   501            05  DFHMT                             PIC X VALUE '1'.
   502            05  DFHOUTLN                          PIC X VALUE 'B'.
   503            05  DFHPS                             PIC X VALUE '„'.
   504       *                                              EBCDIC x'43'
   505       *                                              ASCII  x'84'
   506            05  DFHVAL                            PIC X VALUE 'A'.
   507	     *
   508		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   509		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   510		      88 DFHSUB-VAL-ASCII		VALUE 26.
   511		  05  FILLER REDEFINES DFHSUB-VAL.
   512		      10  FILLER			PIC X.
   513		      10  DFHSUB			PIC X.
   514       *                                              EBCDIC X'3F'.
   515       *                                              ASCII  X'1A'.
   516	     *
   517		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   518		  05  FILLER REDEFINES DFHFM-VAL.
   519		      10  FILLER			PIC X.
   520		      10  DFHFM 			PIC X.
   521       *                                              EBCDIC X'1E'.
   522		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   524        01  WS-CURRENT-MAP  VALUE 'SM0005M'       PIC X(7).
   525	      01  WS-TIME				PIC 9(15) COMP-3.
   526	      01  WS-DATE				PIC 9(10).
   527	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
   528	      01  WS-LENGTH				PIC S9(4) COMP.
   529
   530	      01  WS-ERRMSGS.
   531		  05 WS-INVALID-ACCESS			PIC X(15) VALUE
   532               'INVALID ACCESS'.
   533		  05 WS-INVALID-PGMID			PIC X(20) VALUE
   534               'INVALID USER ACCESS'.
   535		  05 WS-MAPFAIL 			PIC X(20) VALUE
   536               'MAPFAIL ERROR'.
   537		  05 WS-INVALID-TIX-ACC 		PIC X(34) VALUE
   538               'INVALID ACCESS TO SELECTED TICKET'.
   539		  05 WS-FIELD-REQ			PIC X(24) VALUE
   540               'OPTION FIELD IS REQUIRED'.
   541		  05 WS-FIRST-PAGE			PIC X(23) VALUE
   542               'THIS IS THE FIRST PAGE'.
   543		  05 WS-LAST-PAGE			PIC X(21) VALUE
   544               'THIS IS THE LAST PAGE'.
   545
   546	      01  WS-COMMAREA.
   547		  05 WS-PGMID				PIC X(06).
   548		  05 WS-TICKET-PASSED			PIC X(07).
   549		  05 USERID.   550		     10  USERID7			PIC X(7).
   551		     10  FILLER 			PIC X(1).
   552		  05 USR-TYPE.
   553		    15 USR-REQUESTOR			PIC X.
   554		    15 USR-ADMIN			PIC X.
   555		    15 USR-APPROVER			PIC X.
   556		    15 USR-SERVICE			PIC X.
   557		  05 WS-STATE				PIC X.
   558
   559	      LINKAGE SECTION.
   561	      01  DFHEIBLK.						       R
   562		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   563		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   564		  05 EIBTRNID PIC X(4). 				       R
   565		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   566		  05 EIBTRMID PIC X(4). 				       R
   567		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   568		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   569		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   570		  05 EIBAID   PIC X.					       R
   571		  05 EIBFN    PIC X(2). 				       R
   572		  05 EIBRCODE PIC X(6). 				       R
   573		  05 EIBDS    PIC X(8). 				       R
   574		  05 EIBREQID PIC X(8). 				       R
   575		  05 EIBRSRCE PIC X(8). 				       R
   576		  05 EIBSYNC  PIC X.					       R
   577		  05 EIBFREE  PIC X.					       R
   578		  05 EIBRECV  PIC X.					       R
   579		  05 EIBSEND  PIC X.					       R
   580		  05 EIBATT   PIC X.					       R
   581		  05 EIBEOC   PIC X.					       R
   582		  05 EIBFMH   PIC X.					       R
   583		  05 EIBCOMPL PIC X.					       R
   584		  05 EIBSIG   PIC X.					       R
   585		  05 EIBCONF  PIC X.					       R
   586		  05 EIBERR   PIC X.					       R
   587		  05 EIBERRCD PIC X(4). 				       R
   588		  05 EIBSYNRB PIC X.					       R
   589		  05 EIBNODAT PIC X.					       R
   590		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   591		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   592		  05 EIBRLDBK PIC X.					       R
   593		  05 EIBCARESERVED PIC X(32).				       R
   595	      01  DFHCOMMAREA.
   596		  05 DF-PGMID				PIC X(06).
   597		  05 DF-TICKET-PASSED			PIC X(07).
   598		  05 DF-USERID.
   599		     10  DF-USERID7			PIC X(7).
   600		     10  FILLER 			PIC X(1).
   601		  05 DF-USR-TYPE.
   602		    15 DF-USR-REQUESTOR 		PIC X.
   603		    15 DF-USR-ADMIN			PIC X.
   604		    15 DF-USR-APPROVER			PIC X.
   605		    15 DF-USR-SERVICE			PIC X.
   606		  05 DF-STATE				PIC X.
   607
   608	      PROCEDURE DIVISION					       R
   610		  USING DFHEIBLK DFHCOMMAREA.				       R
   635	      100-PROCESS.
   637		  EXEC CICS IGNORE CONDITION   638			    ERROR
   639		  END-EXEC
   654		  MOVE DFHCOMMAREA TO WS-COMMAREA
   655            IF WS-PGMID = 'SM000' OR WS-PGMID = 'SM001' OR
   656               WS-PGMID = 'SM012'
   657		     IF EIBCALEN NOT = +0
   658			PERFORM 200-REC-MAP
   659		     ELSE
   660			PERFORM 110-NEW-MAP
   661		     END-IF
   662		  ELSE
   663		      MOVE SPACES TO ERRMSGO
   664		      MOVE LENGTH OF WS-INVALID-ACCESS TO WS-LENGTH
   666		      EXEC CICS SEND TEXT
   667			      FROM (WS-INVALID-ACCESS)
   668			      LENGTH (WS-LENGTH)
   669			      ERASE
   670			 END-EXEC
   701		      EXEC CICS RETURN
   702		      END-EXEC
   715		  END-IF.
   716	      100-EXIT.
   717		  EXIT.
   718
   719	      110-NEW-MAP.
   720		  MOVE EIBDATE TO WS-DATE.
   721		  MOVE WS-DATE-X TO DATEO.
   723		  EXEC CICS ASKTIME
   724		  ABSTIME  (WS-TIME)
   725		  END-EXEC
   744		  EXEC CICS FORMATTIME
   745		  ABSTIME  (WS-TIME)
   746            DATESEP  ('/')
   747		  MMDDYY   (DATEO)
   748		  TIME	   (TIMEO)
   749            TIMESEP  (':')
   750		  END-EXEC
   790
   791
   793		  EXEC CICS SEND
   794                 MAP('SM005M')
   795                 MAPSET('SM05S')
   796		       FROM(SM005MO)
   797		       CURSOR
   798		       LENGTH(WS-LENGTH)
   799		       ERASE
   800		  END-EXEC
   846		  EXEC CICS RETURN
   847                 TRANSID('SM05')
   848		       COMMAREA(WS-COMMAREA)
   849		  END-EXEC.
   874
   875	      110-EXIT.
   876		  EXIT.
   877
   878	      200-REC-MAP.
   879
   881		   EXEC CICS RECEIVE
   882                  MAP('SM005M')
   883                  MAPSET('SM05S')   884			INTO (SM005MI)
   885		   END-EXEC
   919		   IF EIBRESP = DFHRESP(MAPFAIL)
   921		   IF EIBRESP = 	036				       R
   922		       MOVE WS-MAPFAIL TO ERRMSGO
   923		      PERFORM 110-NEW-MAP
   924		   END-IF.
   925		   PERFORM 210-CHECK-AID
   926		   PERFORM 110-NEW-MAP.
   927
   928	      200-EXIT.
   929		  EXIT.
   930
   931	      210-CHECK-AID.
   932		  IF EIBAID = DFHPF3
   933		       EVALUATE WS-PGMID
   934                  WHEN 'SM000'
   936				   EXEC CICS XCTL
   937                                   PROGRAM('SM000')
   938			   END-EXEC
   957                  WHEN 'SM001'
   959			   EXEC CICS XCTL
   960                                       PROGRAM('SM001')
   961			   END-EXEC
   980                  WHEN 'SM012'
   982			   EXEC CICS XCTL
   983                                       PROGRAM('SM012')
   984			   END-EXEC
  1003		       END-EVALUATE
  1004		  END-IF.
  1005	      210-EXIT.
  1006		   EXIT.CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\SM005.cic	       PAGE   12



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    1017
			Compilation time (mm:ss.ss):  0:00.69
			Compilation speed (lines/minute): 88434

			Compilation date (yy/mm/dd): 23/11/25
			     Time of day (hh:mm:ss): 16:21:21