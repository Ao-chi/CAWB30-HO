     5	     *CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. SM005.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27	      DATA DIVISION.
    28	      FILE SECTION.
    29	     *----------------------------------------------------------------*
    30	     *			      WORKING STORAGE			      *
    31	     *----------------------------------------------------------------*
    32	      WORKING-STORAGE SECTION.
    33		  COPY SM05S.
    35	     * SYMBOLIC MAP of SM05S Created by CACXBMS Version 6.0.27
    81	      01  SM005MI.
    82		  02  FILLER				     PIC X(12).
    83		  02  DATEL				     PIC S9(4) COMP.
    84		  02  DATEF				     PIC X.
    85		  02  FILLER REDEFINES DATEF.
    86		      03  DATEA 			     PIC X.
    87		  02  DATEI				     PIC X(010).
    88		  02  TIMEL				     PIC S9(4) COMP.
    89		  02  TIMEF				     PIC X.
    90		  02  FILLER REDEFINES TIMEF.
    91		      03  TIMEA 			     PIC X.
    92		  02  TIMEI				     PIC X(008).
    93		  02  TKTNUML				     PIC S9(4) COMP.
    94		  02  TKTNUMF				     PIC X.
    95		  02  FILLER REDEFINES TKTNUMF.
    96		      03  TKTNUMA			     PIC X.
    97		  02  TKTNUMI				     PIC X(006).
    98		  02  REQBYL				     PIC S9(4) COMP.
    99		  02  REQBYF				     PIC X.
   100		  02  FILLER REDEFINES REQBYF.
   101		      03  REQBYA			     PIC X.
   102		  02  REQBYI				     PIC X(008).
   103		  02  TKTLEL				     PIC S9(4) COMP.
   104		  02  TKTLEF				     PIC X.
   105		  02  FILLER REDEFINES TKTLEF.
   106		      03  TKTLEA			     PIC X.
   107		  02  TKTLEI				     PIC X(025).
   108		  02  TKDES1L				     PIC S9(4) COMP.
   109		  02  TKDES1F				     PIC X.
   110		  02  FILLER REDEFINES TKDES1F.
   111		      03  TKDES1A			     PIC X.
   112		  02  TKDES1I				     PIC X(050).
   113		  02  TKDES2L				     PIC S9(4) COMP.
   114		  02  TKDES2F				     PIC X.
   115		  02  FILLER REDEFINES TKDES2F.
   116		      03  TKDES2A			     PIC X.
   117		  02  TKDES2I				     PIC X(050).
   118		  02  STATL				     PIC S9(4) COMP.
   119		  02  STATF				     PIC X.
   120		  02  FILLER REDEFINES STATF.
   121		      03  STATA 			     PIC X.
   122		  02  STATI				     PIC X(010).
   123		  02  UPDTBYL				     PIC S9(4) COMP.
   124		  02  UPDTBYF				     PIC X.   125		  02  FILLER REDEFINES UPDTBYF.
   126		      03  UPDTBYA			     PIC X.
   127		  02  UPDTBYI				     PIC X(008).
   128		  02  UPDREM1L				     PIC S9(4) COMP.
   129		  02  UPDREM1F				     PIC X.
   130		  02  FILLER REDEFINES UPDREM1F.
   131		      03  UPDREM1A			     PIC X.
   132		  02  UPDREM1I				     PIC X(025).
   133		  02  UPDREM2L				     PIC S9(4) COMP.
   134		  02  UPDREM2F				     PIC X.
   135		  02  FILLER REDEFINES UPDREM2F.
   136		      03  UPDREM2A			     PIC X.
   137		  02  UPDREM2I				     PIC X(025).
   138		  02  UPDTL				     PIC S9(4) COMP.
   139		  02  UPDTF				     PIC X.
   140		  02  FILLER REDEFINES UPDTF.
   141		      03  UPDTA 			     PIC X.
   142		  02  UPDTI				     PIC X(020).
   143		  02  ERRMSGL				     PIC S9(4) COMP.
   144		  02  ERRMSGF				     PIC X.
   145		  02  FILLER REDEFINES ERRMSGF.
   146		      03  ERRMSGA			     PIC X.
   147		  02  ERRMSGI				     PIC X(071).
   148	      01  SM005MO REDEFINES SM005MI.
   149		  02  FILLER				     PIC X(12).
   150		  02  FILLER				     PIC XX.
   151		  02  FILLER				     PIC X.
   152		  02  DATEO				     PIC X(010).
   153		  02  FILLER				     PIC XX.
   154		  02  FILLER				     PIC X.
   155		  02  TIMEO				     PIC X(008).
   156		  02  FILLER				     PIC XX.
   157		  02  FILLER				     PIC X.
   158		  02  TKTNUMO				     PIC X(006).
   159		  02  FILLER				     PIC XX.
   160		  02  FILLER				     PIC X.
   161		  02  REQBYO				     PIC X(008).
   162		  02  FILLER				     PIC XX.
   163		  02  FILLER				     PIC X.
   164		  02  TKTLEO				     PIC X(025).
   165		  02  FILLER				     PIC XX.
   166		  02  FILLER				     PIC X.
   167		  02  TKDES1O				     PIC X(050).
   168		  02  FILLER				     PIC XX.
   169		  02  FILLER				     PIC X.
   170		  02  TKDES2O				     PIC X(050).
   171		  02  FILLER				     PIC XX.
   172		  02  FILLER				     PIC X.
   173		  02  STATO				     PIC X(010).
   174		  02  FILLER				     PIC XX.
   175		  02  FILLER				     PIC X.
   176		  02  UPDTBYO				     PIC X(008).
   177		  02  FILLER				     PIC XX.
   178		  02  FILLER				     PIC X.
   179		  02  UPDREM1O				     PIC X(025).
   180		  02  FILLER				     PIC XX.
   181		  02  FILLER				     PIC X.
   182		  02  UPDREM2O				     PIC X(025).
   183		  02  FILLER				     PIC XX.
   184		  02  FILLER				     PIC X.   185		  02  UPDTO				     PIC X(020).
   186		  02  FILLER				     PIC XX.
   187		  02  FILLER				     PIC X.
   188		  02  ERRMSGO				     PIC X(071).
   190		  COPY DFHAID.
   192	      01  DFHAID.
   193	     *
   194	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   195	     *
   196	     * Revision Information
   197	     * ^{File:dfhaid.cob  }
   198	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   199	     * ^{Revision:2.0}
   200	     *
   201	     *This is the AID constants copy file
   202	     *
   203            05  DFHENTER                  PIC X VALUE ''''.
   204	     *					value APOST
   205            05  DFHCLEAR                  PIC X VALUE '_'.
   206            05  DFHPA1                    PIC X VALUE '%'.
   207            05  DFHPA2                    PIC X VALUE '>'.
   208            05  DFHPA3                    PIC X VALUE ','.
   209            05  DFHPF1                    PIC X VALUE '1'.
   210            05  DFHPF2                    PIC X VALUE '2'.
   211            05  DFHPF3                    PIC X VALUE '3'.
   212            05  DFHPF4                    PIC X VALUE '4'.
   213            05  DFHPF5                    PIC X VALUE '5'.
   214            05  DFHPF6                    PIC X VALUE '6'.
   215            05  DFHPF7                    PIC X VALUE '7'.
   216            05  DFHPF8                    PIC X VALUE '8'.
   217            05  DFHPF9                    PIC X VALUE '9'.
   218            05  DFHPF10                   PIC X VALUE ':'.
   219            05  DFHPF11                   PIC X VALUE '#'.
   220            05  DFHPF12                   PIC X VALUE '@'.
   221            05  DFHPF13                   PIC X VALUE 'A'.
   222            05  DFHPF14                   PIC X VALUE 'B'.
   223            05  DFHPF15                   PIC X VALUE 'C'.
   224            05  DFHPF16                   PIC X VALUE 'D'.
   225            05  DFHPF17                   PIC X VALUE 'E'.
   226            05  DFHPF18                   PIC X VALUE 'F'.
   227            05  DFHPF19                   PIC X VALUE 'G'.
   228            05  DFHPF20                   PIC X VALUE 'H'.
   229            05  DFHPF21                   PIC X VALUE 'I'.
   230            05  DFHPF22                   PIC X VALUE '›'.
   231       *                                  EBCDIC Cent sign x'4A'
   232       *                                  ASCII  Cent sign x'9B'
   233            05  DFHPF23                   PIC X VALUE '.'.
   234            05  DFHPF24                   PIC X VALUE '<'.
   235            05  DFHOPID                   PIC X VALUE 'W'.
   236            05  DFHMSRE                   PIC X VALUE 'X'.
   237            05  DFHTRIG                   PIC X VALUE '"'.
   238       *                                        value QUOTE  "
   239            05  DFHPEN                    PIC X VALUE '='.
   240            05  DFHCLRP                   PIC X VALUE 'Ý'.
   241       *                                  EBCDIC x'6A'
   242       *                                  ASCII  x'DD'
   243            05  DFHSTRF                   PIC X VALUE 'h'.
   244	     *	  DFHQUIT is a CA-Realia CICS Extension
   245	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   246            05  DFHQUIT                   PIC X VALUE '!'.   247		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   249		  COPY DFHBMSCA.
   251	      01  DFHBMSCA.
   252	     *
   253	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   254	     *
   255	     * Revision Information
   256	     * ^{File:dfhbmsca.cob}
   257	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   258	     * ^{Revision:2.0}
   259	     *
   260	     *	Note:This FILE is provided with most values as quoted literals
   261	     *	     so that the file can be used for both ASCII and EBCDIC
   262	     *	     programs
   263	     *
   264	     *	     The only exceptions are some 3270 Data Stream Orders
   265	     *	     They use different Hexadecimal values for ASCII and
   266	     *	     EBCDIC and they cannot be expressed as quoted literals
   267	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   268	     *	     characters in ASCII
   269	     *
   270	     *	     They have their values set up to default to the EBCDIC
   271	     *	     values.
   272	     *
   273	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   274	     *	     and SEND TEXT with imbedded format orders.
   275	     *	     If you use these values in ASCII programs the values
   276	     *	     must be changed.
   277	     *
   278	     *	     An alternative is to use REPLACING to change the values.
   279	     *
   280	     *	  i.e. COPY DFHBMSCA replacing
   281	     *			    ==005== BY ==009==	*> DFHPT
   282	     *			    ==021== BY ==010==	*> DFHNL
   283	     *			    ==040== BY ==021==	*> DFHSA
   284	     *			    ==041== BY ==031==	*> DFHSFE
   285	     *			    ==044== BY ==023==	*> DFHMF
   286	     *			    ==060== BY ==020==	*> DFHRA
   287	     *			    ==063== BY ==026==. *> DFHSUB
   288	     *
   289	     ******************************************************************
   290	     *BMS and Terminal Control - Order & Attributes constants	      *
   291	     ******************************************************************
   292	     *
   293	     *	  Field Attributes
   294	     *
   295            05  DFHBMASB                          PIC X VALUE '8'.
   296            05  DFHBMASF                          PIC X VALUE '1'.
   297            05  DFHBMASK                          PIC X VALUE '0'.
   298            05  DFHBMBRY                          PIC X VALUE 'H'.
   299            05  DFHBMDAR                          PIC X VALUE '<'.
   300            05  DFHBMFSE                          PIC X VALUE 'A'.
   301            05  DFHBMPRF                          PIC X VALUE '/'.
   302            05  DFHBMPRO                          PIC X VALUE '-'.
   303            05  DFHBMUNN                          PIC X VALUE '&'.
   304            05  DFHBMUNP                          PIC X VALUE ' '.
   305            05  DFHUNNUM                          PIC X VALUE 'J'.
   306	     *
   307	     *	  partially supported
   308	     *   309            05  DFHUNNOD                          PIC X VALUE '('.
   310            05  DFHUNIMD                          PIC X VALUE 'I'.
   311            05  DFHUNINT                          PIC X VALUE 'R'.
   312            05  DFHUNNON                          PIC X VALUE '('.
   313            05  DFHPROTI                          PIC X VALUE 'Y'.
   314            05  DFHPROTN                          PIC X VALUE '%'.
   315	     *
   316	     *	  These values are additions to mainframe constants
   317	     *
   318            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   319            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   320            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   321	     *						      VALUE APOST
   322            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   323            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   324            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   325            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   326            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   327	     *
   328	     *	  Field Flag values
   329		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   330		  05  FILLER REDEFINES DFHBMEOF-VAL.
   331		      10  FILLER			PIC X.
   332		      10  DFHBMEOF			PIC X.
   333       *                                          x'80'.
   334		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   335		  05  FILLER REDEFINES DFHBMCUR-VAL.
   336		      10  FILLER			PIC X.
   337		      10  DFHBMCUR			PIC X.
   338       *                                          x'02'.
   339		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   340		  05  FILLER REDEFINES DFHBMMEC-VAL.
   341		      10  FILLER			PIC X.
   342		      10  DFHBMMEC			PIC X.
   343       *                                          x'82'.
   344       *                                          x'02'.
   345		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   346		      88  DFHERASE			VALUES 128 130.
   347       *                                          x'80' X'82'
   348		      88  DFHCURSR			VALUES 002 130.
   349       *                                          x'02' X'82'
   350		  05  FILLER REDEFINES DFHBMFLG-VAL.
   351		      10  FILLER			PIC X.
   352		      10  DFHBMFLG			PIC X.
   353
   354		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   355		  05  FILLER REDEFINES DFHBMDUP-VAL.
   356		      10  FILLER			PIC X.
   357		      10  DFHBMDUP			PIC X.
   358       *                                              x'1C'
   359	     *
   360	     ******************************************************************
   361	     *	  supported 327X Extended Attributes
   362	     *
   363	     *	  Extended COLOR Attributes
   364	     *
   365            05  DFHDFCOL                          PIC X VALUE '0'.
   366            05  DFHBLUE                           PIC X VALUE '1'.
   367            05  DFHRED                            PIC X VALUE '2'.
   368            05  DFHPINK                           PIC X VALUE '3'.   369            05  DFHGREEN                          PIC X VALUE '4'.
   370            05  DFHTURQ                           PIC X VALUE '5'.
   371            05  DFHYELLO                          PIC X VALUE '6'.
   372            05  DFHNEUTR                          PIC X VALUE '7'.
   373	     *
   374	     *	  Extended HILIGHT Attributes
   375	     *
   376            05  DFHDFHI                           PIC X VALUE '0'.
   377            05  DFHBLINK                          PIC X VALUE '1'.
   378            05  DFHREVRS                          PIC X VALUE '2'.
   379            05  DFHUNDLN                          PIC X VALUE '4'.
   380	     *
   381	     ******************************************************************
   382	     *	  supported 327X Data Stream Orders
   383	     *
   384		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   385		  05  FILLER REDEFINES DFHSBA-VAL.
   386		      10  FILLER			PIC X.
   387		      10  DFHSBA			PIC X.
   388       *                                              x'11'
   389		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   390		  05  FILLER REDEFINES DFHEUA-VAL.
   391		      10  FILLER			PIC X.
   392		      10  DFHEUA			PIC X.
   393       *                                              x'12'
   394		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   395		  05  FILLER REDEFINES DFHIC-VAL.
   396		      10  FILLER			PIC X.
   397		      10  DFHIC 			PIC X.
   398       *                                              X'13'.
   399		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   400		  05  FILLER REDEFINES DFHSF-VAL.
   401		      10  FILLER			PIC X.
   402		      10  DFHSF 			PIC X.
   403       *                                              X'1D'.
   404		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   405		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   406		      88 DFHPT-VAL-ASCII		VALUE 9.
   407		  05  FILLER REDEFINES DFHPT-VAL.
   408		      10  FILLER			PIC X.
   409		      10  DFHPT 			PIC X.
   410       *                                              EBCDIC X'05'.
   411       *                                              ASCII  X'09'.
   412		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   413		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   414		      88 DFHRA-VAL-ASCII		VALUE 20.
   415		  05  FILLER REDEFINES DFHRA-VAL.
   416		      10  FILLER			PIC X.
   417		      10  DFHRA 			PIC X.
   418       *                                              EBCDIC x'3C'
   419       *                                              ASCII  x'14'
   420		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   421		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   422		      88 DFHSFE-VAL-ASCII		VALUE 31.
   423		  05  FILLER REDEFINES DFHSFE-VAL.
   424		      10  FILLER			PIC X.
   425		      10  DFHSFE			PIC X.
   426       *                                              EBCDIC x'29'
   427       *                                              ASCII  x'1F'
   428		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.   429		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   430		      88 DFHMF-VAL-ASCII		VALUE 23.
   431		  05  FILLER REDEFINES DFHMF-VAL.
   432		      10  FILLER			PIC X.
   433		      10  DFHMF 			PIC X.
   434       *                                              EBCDIC x'2C'
   435       *                                              ASCII  x'17'
   436	     *
   437	     ******************************************************************
   438	     *	  unsupported 327X Data Stream order codes
   439	     *
   440		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   441		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   442		      88 DFHSA-VAL-ASCII		VALUE 21.
   443		  05  FILLER REDEFINES DFHSA-VAL.
   444		      10  FILLER			PIC X.
   445		      10  DFHSA 			PIC X.
   446       *                                              EBCDIC x'28'
   447       *                                              ASCII  x'15'
   448		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   449		  05  FILLER REDEFINES DFHGE-VAL.
   450		      10  FILLER			PIC X.
   451		      10  DFHGE 			PIC X.
   452       *                                              X'08'.
   453	     *
   454	     ******************************************************************
   455	     *	  SFE and MF supported attribute types
   456	     *
   457            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   458       *                                              EBCDIC x'42'
   459       *                                              ASCII  x'83'
   460            05  DFHHLT                            PIC X VALUE 'Ö'.
   461       *                                              EBCDIC x'41'
   462       *                                              ASCII  x'D6'
   463            05  DFH3270                           PIC X VALUE '{'.
   464	     *
   465	     *	  supported for SEND TEXT command and printer terminal
   466	     *
   467		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   468		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   469		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   470		  05  FILLER REDEFINES DFHBMPNL-VAL.
   471		      10  FILLER			PIC X.
   472		      10  DFHBMPNL			PIC X.
   473       *                                              EBCDIC X'15'.
   474       *                                              ASCII  X'0A'.
   475	     *
   476	     ******************************************************************
   477	     *	  Printer terminal data stream only
   478	     *
   479		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   480		  05  FILLER REDEFINES DFHBMPFF-VAL.
   481		      10  FILLER			PIC X.
   482		      10  DFHBMPFF			PIC X.
   483       *                                              X'0C'.
   484		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   485		  05  FILLER REDEFINES DFHBMPCR-VAL.
   486		      10  FILLER			PIC X.
   487		      10  DFHBMPCR			PIC X.
   488       *                                              X'0D'.   489		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   490		  05  FILLER REDEFINES DFHBMPEM-VAL.
   491		      10  FILLER			PIC X.
   492		      10  DFHBMPEM			PIC X.
   493       *                                              X'19'.
   494	     *
   495	     ******************************************************************
   496	     *	  unsupported Miscellaneous attributes and constants
   497	     *
   498		  05  DFHALL				PIC X VALUE LOW-VALUES.
   499            05  DFHBASE                           PIC X VALUE '0'.
   500		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   501		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   502		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   503		      10  DFHBMPSO			PIC X.
   504       *                                              X'0E'.
   505		      10  DFHBMPSI			PIC X.
   506       *                                              X'0F'.
   507		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   508            05  DFHERROR                          PIC X VALUE '¶'.
   509       *                                              EBCDIC X'1A'.
   510       *                                              ASCII  X'B6'.
   511            05  DFHFIL                            PIC X VALUE '4'.
   512            05  DFHMENT                           PIC X VALUE '2'.
   513            05  DFHMET                            PIC X VALUE '3'.
   514            05  DFHMFE                            PIC X VALUE '6'.
   515            05  DFHMFET                           PIC X VALUE '7'.
   516            05  DFHMFT                            PIC X VALUE '5'.
   517            05  DFHMT                             PIC X VALUE '1'.
   518            05  DFHOUTLN                          PIC X VALUE 'B'.
   519            05  DFHPS                             PIC X VALUE '„'.
   520       *                                              EBCDIC x'43'
   521       *                                              ASCII  x'84'
   522            05  DFHVAL                            PIC X VALUE 'A'.
   523	     *
   524		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   525		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   526		      88 DFHSUB-VAL-ASCII		VALUE 26.
   527		  05  FILLER REDEFINES DFHSUB-VAL.
   528		      10  FILLER			PIC X.
   529		      10  DFHSUB			PIC X.
   530       *                                              EBCDIC X'3F'.
   531       *                                              ASCII  X'1A'.
   532	     *
   533		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   534		  05  FILLER REDEFINES DFHFM-VAL.
   535		      10  FILLER			PIC X.
   536		      10  DFHFM 			PIC X.
   537       *                                              EBCDIC X'1E'.
   538		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   540        01  WS-CURRENT-MAP  VALUE 'SM0005M'       PIC X(7).
   541	      01  WS-TIME				PIC 9(15) COMP-3.
   542	      01  WS-DATE				PIC 9(10).
   543	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
   544	      01  WS-LENGTH				PIC S9(4) COMP.
   545
   546	      01  WS-ERRMSGS.
   547		  05 WS-INVALID-ACCESS			PIC X(15) VALUE
   548               'INVALID ACCESS'.
   549		  05 WS-INVALID-PGMID			PIC X(20) VALUE   550               'INVALID USER ACCESS'.
   551		  05 WS-INVALID-TIX-ACC 		PIC X(34) VALUE
   552               'INVALID ACCESS TO SELECTED TICKET'.
   553		  05 WS-FIELD-REQ			PIC X(24) VALUE
   554               'OPTION FIELD IS REQUIRED'.
   555		  05 WS-PRESS-F2			PIC X(31) VALUE
   556               'PRESS PF2 TO APPROVE THE TICKET'.
   557		  05 WS-PRESS-F5			PIC X(53) VALUE
   558              'TICKET APPROVAL ABORTED. ENTER TICKET AND PRESS ENTER'.
   559		  05 WS-TICKET-APPROVED 		PIC X(54) VALUE
   560               'TICKET APPROVED, PRESS ENTER TO APPROVE ANOTHER TICKET'.
   561		  05 WS-ENTER-TICKET			PIC X(35) VALUE
   562               'ENTER TICKET NUMBER AND PRESS ENTER'.
   563		  05 WS-NOT-EXIST			PIC X(28) VALUE
   564               'TICKET NUMBER DOES NOT EXIST'.
   565		  05 WS-INVALID-STATUS			PIC X(28) VALUE
   566               'INVALID TICKET STATUS'.
   567		  05 WS-INVALID-PFKEY			PIC X(21) VALUE
   568                'INAVLID PFKEY PRESSED'.
   569
   570        01  WS-FOUND                              PIC X VALUE 'N'.
   571	      77  WS-RETNCODE				 PIC S9(8) COMP.
   572	      77  WS-RETNCODE2				 PIC S9(8) COMP.
   573
   574	      01  WS-TICKET-REC.
   575		  05 WS-TICKET-KEY			PIC X(07).
   576		  05 WS-TICKET-KEY-NUM REDEFINES WS-TICKET-KEY PIC 9(06).
   577		  05 WS-TICKET-REQUESTOR		PIC X(8).
   578		  05 WS-TICKET-STATUS			PIC X(10).
   579		  05 WS-TICKET-TITLE			PIC X(25).
   580		  05 WS-TICKET-DESCRIPTION		PIC X(100).
   581		  05 WS-TICKET-LAST-UPDATE		PIC X(20).
   582		  05 WS-TICKET-LAST-UPDATE-BY		PIC X(8).
   583		  05 WS-TICKET-UPDATE-REMARKS		PIC X(50).
   584
   585	      01  WS-LOG-REC.
   586		  05 WS-LOG-KEYS.
   587		      10 WS-LOG-TICKET-ID		PIC X(06).
   588		      10 WS-LOG-SEQ-NUM 		PIC 9(03).
   589		  05 WS-LOG-LAST-UPD			PIC X(20).
   590		  05 WS-LOG-LAST-UPDBY			PIC X(10).
   591		  05 WS-LOG-UPD-REMARKS 		PIC X(50).
   592
   593	      01  WS-COMMAREA.
   594		  05 WS-PGMID				PIC X(06).
   595		  05 WS-STATE				PIC X.
   596		  05 WS-TICKET-PASSED			PIC X(07).
   597		  05 USERID.
   598		     10  USERID7			PIC X(7).
   599		     10  FILLER 			PIC X(1).
   600		  05 USR-TYPE.
   601		    15 USR-REQUESTOR			PIC X.
   602		    15 USR-ADMIN			PIC X.
   603		    15 USR-APPROVER			PIC X.
   604		    15 USR-SERVICE			PIC X.
   605		  05 WS-SM012-STATE			PIC X.
   606		  05 WS-SM012-PGMID			PIC X(06).
   607		  05 WS-TIX-DETL.
   608		     10 WS-TIX-KEY			PIC X(07).
   609		     10 WS-TIX-KEY-NUM REDEFINES WS-TIX-KEY PIC 9(06).   610		     10 WS-TIX-REQUESTOR		PIC X(8).
   611		     10 WS-TIX-STATUS			PIC X(10).
   612		     10 WS-TIX-TITLE			PIC X(25).
   613		     10 WS-TIX-DESC			PIC X(100).
   614		     10 WS-TIX-LAST-UPD 		PIC X(20).
   615		     10 WS-TIX-LAST-UPDBY		PIC X(8).
   616		     10 WS-TIX-UPD-REMARKS		PIC X(50).
   617
   618	      LINKAGE SECTION.
   620	      01  DFHEIBLK.						       R
   621		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   622		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
   623		  05 EIBTRNID PIC X(4). 				       R
   624		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   625		  05 EIBTRMID PIC X(4). 				       R
   626		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   627		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   628		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   629		  05 EIBAID   PIC X.					       R
   630		  05 EIBFN    PIC X(2). 				       R
   631		  05 EIBRCODE PIC X(6). 				       R
   632		  05 EIBDS    PIC X(8). 				       R
   633		  05 EIBREQID PIC X(8). 				       R
   634		  05 EIBRSRCE PIC X(8). 				       R
   635		  05 EIBSYNC  PIC X.					       R
   636		  05 EIBFREE  PIC X.					       R
   637		  05 EIBRECV  PIC X.					       R
   638		  05 EIBSEND  PIC X.					       R
   639		  05 EIBATT   PIC X.					       R
   640		  05 EIBEOC   PIC X.					       R
   641		  05 EIBFMH   PIC X.					       R
   642		  05 EIBCOMPL PIC X.					       R
   643		  05 EIBSIG   PIC X.					       R
   644		  05 EIBCONF  PIC X.					       R
   645		  05 EIBERR   PIC X.					       R
   646		  05 EIBERRCD PIC X(4). 				       R
   647		  05 EIBSYNRB PIC X.					       R
   648		  05 EIBNODAT PIC X.					       R
   649		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   650		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   651		  05 EIBRLDBK PIC X.					       R
   652		  05 EIBCARESERVED PIC X(32).				       R
   654	      01  DFHCOMMAREA.
   655		  05 DF-PGMID				PIC X(06).
   656		  05 DF-STATE				PIC X.
   657		  05 DF-TICKET-PASSED			PIC X(07).
   658		  05 DF-USERID.
   659		     10  DF-USERID7			PIC X(7).
   660		     10  FILLER 			PIC X(1).
   661		  05 DF-USR-TYPE.
   662		    15 DF-USR-REQUESTOR 		PIC X.
   663		    15 DF-USR-ADMIN			PIC X.
   664		    15 DF-USR-APPROVER			PIC X.
   665		    15 DF-USR-SERVICE			PIC X.
   666		  05 DF-SM012-STATE			PIC X.
   667		  05 DF-SM012-PGMID			PIC X(06).
   668		  05 DF-TIX-DETL.
   669		     10 DF-TIX-KEY			PIC X(07).
   670		     10 DF-TIX-KEY-NUM REDEFINES DF-TIX-KEY PIC 9(06).
   671		     10 DF-TIX-REQUESTOR		PIC X(8).   672		     10 DF-TIX-STATUS			PIC X(10).
   673		     10 DF-TIX-TITLE			PIC X(25).
   674		     10 DF-TIX-DESC			PIC X(100).
   675		     10 DF-TIX-LAST-UPD 		PIC X(20).
   676		     10 DF-TIX-LAST-UPDBY		PIC X(8).
   677		     10 DF-TIX-UPD-REMARKS		PIC X(50).
   678
   679	      PROCEDURE DIVISION					       R
   681		  USING DFHEIBLK DFHCOMMAREA.				       R
   706	      000-PROCESS.
   708		  EXEC CICS IGNORE CONDITION
   709			    ERROR
   710		  END-EXEC
   725		  MOVE DFHCOMMAREA TO WS-COMMAREA
   726            IF WS-PGMID = 'SM000' OR WS-PGMID = 'SM001' OR
   727               WS-PGMID = 'SM012'
   728		     EVALUATE TRUE
   729		       WHEN WS-STATE = LOW-VALUES
   730			    EVALUATE TRUE
   731			      WHEN WS-TICKET-PASSED = LOW-VALUES
   732				   MOVE 1 TO WS-STATE
   733				   MOVE WS-ENTER-TICKET TO ERRMSGO
   734				   MOVE -1 TO TKTNUML
   735				   PERFORM 100-CREATE-MAP
   736			    END-EVALUATE
   737		       WHEN WS-STATE = 1
   738			    PERFORM 200-REC-MAP
   739			    PERFORM 300-CHECK-AID
   740			    PERFORM 600-MOVE-DATA-TO-COMMAREA
   741	     *		    MOVE -1 TO TKTNUML
   742			    PERFORM 100-CREATE-MAP
   743		       WHEN WS-STATE = 2
   744			    PERFORM 200-REC-MAP
   745			    PERFORM 300-CHECK-AID
   746	     *		    MOVE -1 TO TKTNUML
   747			    PERFORM 100-CREATE-MAP
   748		       WHEN WS-STATE = 3
   749			    PERFORM 200-REC-MAP
   750			    PERFORM 300-CHECK-AID
   751	     *		    MOVE -1 TO TKTNUML
   752			    PERFORM 100-CREATE-MAP
   753		     END-EVALUATE
   754		  ELSE
   755		      MOVE SPACES TO ERRMSGO
   756		      MOVE LENGTH OF WS-INVALID-ACCESS TO WS-LENGTH
   758		      EXEC CICS SEND TEXT
   759			      FROM (WS-INVALID-ACCESS)
   760			      LENGTH (WS-LENGTH)
   761			      ERASE
   762			 END-EXEC
   793		      EXEC CICS RETURN
   794		      END-EXEC
   807		  END-IF.
   808	      000-EXIT.
   809		  EXIT.
   810
   811	      110-FORMAT-DATE-TIME.
   812		  MOVE EIBDATE TO WS-DATE
   813		  MOVE WS-DATE-X TO DATEO
   815		  EXEC CICS ASKTIME   816		       ABSTIME	(WS-TIME)
   817		       END-EXEC
   836		       EXEC CICS FORMATTIME
   837		       ABSTIME	(WS-TIME)
   838                 DATESEP  ('/')
   839		       MMDDYYYY (DATEO)
   840		       TIME	(TIMEO)
   841                 TIMESEP  (':')
   842		  END-EXEC.
   883	      110-EXIT.
   884		  EXIT.
   885
   886	      100-CREATE-MAP.
   887		  PERFORM 110-FORMAT-DATE-TIME
   888
   890		  EXEC CICS SEND
   891                 MAP('SM005M')
   892                 MAPSET('SM05S')
   893		       FROM(SM005MO)
   894		       CURSOR
   895		       LENGTH(WS-LENGTH)
   896		       ERASE
   897		  END-EXEC
   943		  EXEC CICS RETURN
   944                 TRANSID('SM05')
   945		       COMMAREA(WS-COMMAREA)
   946		  END-EXEC.
   971	      100-EXIT.
   972		  EXIT.
   973
   974	      200-REC-MAP.
   976		   EXEC CICS RECEIVE
   977                  MAP('SM005M')
   978                  MAPSET('SM05S')
   979			INTO (SM005MI)
   980		   END-EXEC.
  1014	      200-EXIT.
  1015		  EXIT.
  1016
  1017	      300-CHECK-AID.
  1018		  EVALUATE EIBAID
  1019		    WHEN DFHENTER
  1020			 EVALUATE TRUE
  1021			   WHEN WS-STATE = 1
  1022			      MOVE 2 TO WS-STATE
  1023			      MOVE -1 TO TKTNUML
  1024			      IF TKTNUMI NOT = LOW-VALUES
  1025				 MOVE TKTNUMI TO WS-TICKET-PASSED
  1026			      ELSE
  1027				 MOVE WS-TICKET-PASSED TO TKTNUMI
  1028			      END-IF
  1029			      PERFORM 400-VALIDATE-TICKET
  1030                        IF WS-FOUND = 'Y'
  1031				 PERFORM 500-MOVE-TO-SCREEN
  1032				 MOVE WS-PRESS-F2 TO ERRMSGO
  1033			      ELSE
  1034				 PERFORM 410-MOVE-LOW-VALUES
  1035				 MOVE 1 TO WS-STATE
  1036			      END-IF
  1037			   WHEN WS-STATE = 2  1038				PERFORM 310-REDISPLAY-INVALID-PFKEY
  1039				MOVE WS-PRESS-F2 TO ERRMSGO
  1040				MOVE -1 TO TKTNUML
  1041			      CONTINUE
  1042			    WHEN WS-STATE = 3
  1043				 MOVE 1 TO WS-STATE
  1044				 PERFORM 410-MOVE-LOW-VALUES
  1045				 MOVE -1 TO TKTNUML
  1046				 MOVE WS-ENTER-TICKET TO ERRMSGO
  1047			 END-EVALUATE
  1048		    WHEN DFHPF2
  1049			 EVALUATE TRUE
  1050			   WHEN WS-STATE = LOW-VALUES
  1051				CONTINUE
  1052			   WHEN WS-STATE = 1
  1053				MOVE -1 TO TKTNUML
  1054				MOVE WS-ENTER-TICKET TO ERRMSGO
  1055				CONTINUE
  1056			   WHEN WS-STATE = 2
  1057				PERFORM 400-VALIDATE-TICKET
  1058				MOVE WS-TICKET-APPROVED TO ERRMSGO
  1059				PERFORM 110-FORMAT-DATE-TIME
  1060				MOVE DATEO TO UPDTO(1:10)
  1061				MOVE TIMEO TO UPDTO(12:9)
  1062				MOVE WS-TIX-KEY TO TKTNUMI
  1063				MOVE WS-TIX-REQUESTOR TO REQBYO
  1064				MOVE WS-TIX-TITLE TO TKTLEO
  1065				MOVE WS-TICKET-DESCRIPTION(1:50) TO TKDES1O
  1066				MOVE WS-TICKET-DESCRIPTION(51:50) TO TKDES2O
  1067                          MOVE 'APPROVED' TO STATO
  1068				MOVE USERID TO UPDTBYO
  1069                          MOVE 'TICKET APPROVED' TO UPDREM1O
  1070				MOVE 3 TO WS-STATE
  1071				PERFORM 600-MOVE-DATA-TO-COMMAREA
  1072				PERFORM 700-UPDATE-TICEKT-FILE
  1073				PERFORM 800-READ-LOG-REC
  1074				MOVE -1 TO TKTNUML
  1075			   WHEN WS-STATE = 3
  1076				MOVE -1 TO TKTNUML
  1077				MOVE WS-TICKET-APPROVED TO ERRMSGO
  1078				PERFORM 110-FORMAT-DATE-TIME
  1079				MOVE DATEO TO UPDTO(1:10)
  1080				MOVE TIMEO TO UPDTO(12:9)
  1081				MOVE WS-TIX-KEY TO TKTNUMI
  1082				MOVE WS-TIX-REQUESTOR TO REQBYO
  1083				MOVE WS-TIX-TITLE TO TKTLEO
  1084				MOVE WS-TICKET-DESCRIPTION(1:50) TO TKDES1O
  1085				MOVE WS-TICKET-DESCRIPTION(51:50) TO TKDES2O
  1086                          MOVE 'APPROVED' TO STATO
  1087				MOVE USERID TO UPDTBYO
  1088                          MOVE 'TICKET APPROVED' TO UPDREM1O
  1089			 END-EVALUATE
  1090		    WHEN DFHPF3
  1091		       MOVE LOW-VALUES TO WS-STATE
  1092		       MOVE LOW-VALUES TO WS-TICKET-PASSED
  1093		       EVALUATE WS-PGMID
  1094                  WHEN 'SM000'
  1095                     MOVE 'SM005' TO WS-PGMID
  1097				   EXEC CICS XCTL
  1098                                      PROGRAM('SM000')  1099				COMMAREA(WS-COMMAREA)
  1100			   END-EXEC
  1124                  WHEN 'SM001'
  1125                     MOVE 'SM005' TO WS-PGMID
  1127			   EXEC CICS XCTL
  1128                                       PROGRAM('SM001')
  1129			   END-EXEC
  1148                  WHEN 'SM012'
  1149                     MOVE 'SM005' TO WS-PGMID
  1151			   EXEC CICS XCTL
  1152                                       PROGRAM('SM012')
  1153			   END-EXEC
  1172		       END-EVALUATE
  1173		    WHEN DFHPF5
  1174			 EVALUATE TRUE
  1175			   WHEN WS-STATE = LOW-VALUES
  1176				MOVE -1 TO TKTNUML
  1177				MOVE WS-ENTER-TICKET TO ERRMSGO
  1178				CONTINUE
  1179			   WHEN WS-STATE = 1
  1180				MOVE -1 TO TKTNUML
  1181				MOVE WS-ENTER-TICKET TO ERRMSGO
  1182				CONTINUE
  1183			   WHEN WS-STATE = 2
  1184				MOVE 1 TO WS-STATE
  1185				MOVE -1 TO TKTNUML
  1186				PERFORM 410-MOVE-LOW-VALUES
  1187				MOVE WS-PRESS-F5 TO ERRMSGO
  1188				CONTINUE
  1189			   WHEN WS-STATE = 3
  1190				MOVE -1 TO TKTNUML
  1191				MOVE WS-TICKET-APPROVED TO ERRMSGO
  1192				PERFORM 110-FORMAT-DATE-TIME
  1193				MOVE DATEO TO UPDTO(1:10)
  1194				MOVE TIMEO TO UPDTO(12:9)
  1195				MOVE WS-TIX-KEY TO TKTNUMI
  1196				MOVE WS-TIX-REQUESTOR TO REQBYO
  1197				MOVE WS-TIX-TITLE TO TKTLEO
  1198				MOVE WS-TICKET-DESCRIPTION(1:50) TO TKDES1O
  1199				MOVE WS-TICKET-DESCRIPTION(51:50) TO TKDES2O
  1200                          MOVE 'APPROVED' TO STATO
  1201				MOVE USERID TO UPDTBYO
  1202                          MOVE 'TICKET APPROVED' TO UPDREM1O
  1203			 END-EVALUATE
  1204		    WHEN DFHPF12
  1205                   MOVE 'SM005' TO WS-SM012-PGMID
  1206	     *		 MOVE LOW-VALUES TO WS-STATE
  1207			 MOVE LOW-VALUES TO WS-SM012-STATE
  1209			 EXEC CICS XCTL
  1210                        PROGRAM('SM012')
  1211			      COMMAREA(WS-COMMAREA)
  1212			 END-EXEC
  1236		    WHEN DFHCLEAR
  1237			 EVALUATE TRUE
  1238			   WHEN WS-STATE = LOW-VALUES
  1239				MOVE -1 TO TKTNUML
  1240				MOVE WS-INVALID-PFKEY TO ERRMSGO
  1241				PERFORM 100-CREATE-MAP
  1242			   WHEN WS-STATE = 1
  1243				MOVE -1 TO TKTNUML  1244				MOVE WS-INVALID-PFKEY TO ERRMSGO
  1245				PERFORM 100-CREATE-MAP
  1246			   WHEN WS-STATE = 2
  1247				PERFORM 310-REDISPLAY-INVALID-PFKEY
  1248				MOVE WS-INVALID-PFKEY TO ERRMSGO
  1249				MOVE -1 TO TKTNUML
  1250				PERFORM 100-CREATE-MAP
  1251			   WHEN WS-STATE  = 3
  1252				PERFORM 310-REDISPLAY-INVALID-PFKEY
  1253				MOVE WS-INVALID-PFKEY TO ERRMSGO
  1254				MOVE -1 TO TKTNUML
  1255				PERFORM 100-CREATE-MAP
  1256			 END-EVALUATE
  1257		    WHEN OTHER
  1258			 PERFORM 310-REDISPLAY-INVALID-PFKEY
  1259			 MOVE WS-INVALID-PFKEY TO ERRMSGO
  1260			 MOVE -1 TO TKTNUML
  1261			 PERFORM 100-CREATE-MAP
  1262
  1263		  END-EVALUATE.
  1264	      300-EXIT.
  1265		   EXIT.
  1266
  1267	     *	  Backup na display to kapag invalid PFKEY pressed.
  1268	     *	  Kapag WS-TIX galing ws-commarea
  1269	     *	  pag ws-ticket sa working storage
  1270	      310-REDISPLAY-INVALID-PFKEY.
  1271		  MOVE WS-TIX-KEY TO TKTNUMI
  1272		  MOVE WS-TIX-REQUESTOR TO REQBYO
  1273		  MOVE WS-TIX-TITLE TO TKTLEO
  1274		  EVALUATE WS-STATE
  1275		    WHEN 2
  1276		       MOVE WS-TIX-DESC(1:50) TO TKDES1O
  1277		       MOVE WS-TIX-DESC(51:50) TO TKDES2O
  1278		       MOVE WS-TIX-UPD-REMARKS(1:25) TO UPDREM1O
  1279		       MOVE WS-TIX-UPD-REMARKS(26:25) TO UPDREM2O
  1280		    WHEN 3
  1281		       MOVE WS-TICKET-DESCRIPTION(1:50) TO TKDES1O
  1282		       MOVE WS-TICKET-DESCRIPTION(51:50) TO TKDES2O
  1283		       MOVE WS-TICKET-UPDATE-REMARKS(1:25) TO UPDREM1O
  1284		       MOVE WS-TICKET-UPDATE-REMARKS(26:25) TO UPDREM2O
  1285		  END-EVALUATE
  1286		  MOVE WS-TIX-STATUS TO STATO
  1287		  MOVE WS-TIX-LAST-UPDBY TO UPDTBYO
  1288		  MOVE WS-TIX-LAST-UPD TO UPDTO.
  1289	      310-EXIT.
  1290		  EXIT.
  1291
  1292	      400-VALIDATE-TICKET.
  1294		  EXEC CICS STARTBR
  1295                 FILE('STF001C')
  1296		       RIDFLD (WS-TICKET-PASSED)
  1297		       GTEQ
  1298		  END-EXEC
  1325		  IF EIBRESP = +0
  1327		   EXEC CICS
  1328                  READ FILE('STF001C')
  1329			INTO (WS-TICKET-REC)
  1330			RIDFLD (WS-TICKET-PASSED)
  1331			EQUAL  1332			UPDATE
  1333		   END-EXEC
  1368             MOVE 'Y' TO WS-FOUND
  1369             IF WS-TICKET-STATUS = 'CREATED'
  1370                MOVE 'Y' TO WS-FOUND
  1371		   ELSE
  1372		      MOVE -1 TO TKTNUML
  1373                MOVE 'N' TO WS-FOUND
  1374		      MOVE WS-INVALID-STATUS TO ERRMSGO
  1375		   END-IF
  1376		  ELSE
  1377		     MOVE -1 TO TKTNUML
  1378               MOVE 'N' TO WS-FOUND
  1379		     MOVE WS-NOT-EXIST TO ERRMSGO
  1380		  END-IF.
  1381	      400-EXIT.
  1382		  EXIT.
  1383
  1384	     *	  Pang reset ng display kapag PF5(ABORT) or
  1385	     *	  ENTER(KAPAG NAUPDATE NA)
  1386	      410-MOVE-LOW-VALUES.
  1387		  MOVE LOW-VALUES TO REQBYO
  1388		  MOVE LOW-VALUES TO TKTLEO
  1389		  MOVE LOW-VALUES TO TKDES1O
  1390		  MOVE LOW-VALUES TO TKDES2O
  1391		  MOVE LOW-VALUES TO STATO
  1392		  MOVE LOW-VALUES TO UPDTBYO
  1393		  MOVE LOW-VALUES TO UPDREM1O
  1394		  MOVE LOW-VALUES TO UPDREM2O
  1395		  MOVE LOW-VALUES TO UPDTO.
  1396	      410-EXIT.
  1397		  EXIT.
  1398
  1399	      500-MOVE-TO-SCREEN.
  1400		  MOVE WS-TICKET-REQUESTOR TO REQBYO
  1401		  MOVE WS-TICKET-TITLE	   TO TKTLEO
  1402		  MOVE WS-TICKET-DESCRIPTION(1:50) TO TKDES1O
  1403		  MOVE WS-TICKET-DESCRIPTION(51:50) TO TKDES2O
  1404		  MOVE WS-TICKET-STATUS TO STATO
  1405		  MOVE WS-TICKET-LAST-UPDATE-BY TO UPDTBYO
  1406		  MOVE WS-TICKET-UPDATE-REMARKS(1:25) TO UPDREM1O
  1407		  MOVE WS-TICKET-UPDATE-REMARKS(26:25) TO UPDREM2O
  1408		  MOVE WS-TICKET-LAST-UPDATE TO UPDTO.
  1409	      500-EXIT.
  1410		  EXIT.
  1411
  1412	      600-MOVE-DATA-TO-COMMAREA.
  1413		  IF TKTNUMI = LOW-VALUES
  1414		     MOVE WS-TICKET-PASSED TO WS-TIX-KEY
  1415		  ELSE
  1416		     MOVE TKTNUMI TO WS-TIX-KEY
  1417		  END-IF
  1418		  MOVE REQBYO TO WS-TIX-REQUESTOR
  1419		  MOVE TKTLEO TO WS-TIX-TITLE
  1420		  MOVE TKDES1O TO WS-TIX-DESC(1:50)
  1421		  MOVE TKDES2O TO WS-TIX-DESC(51:50)
  1422		  MOVE STATO TO WS-TIX-STATUS
  1423		  MOVE UPDTBYO TO WS-TIX-LAST-UPDBY
  1424		  MOVE UPDREM1O TO WS-TIX-UPD-REMARKS(1:25)
  1425		  MOVE UPDREM2O TO WS-TIX-UPD-REMARKS(26:25)  1426		  MOVE UPDTO TO WS-TIX-LAST-UPD.
  1427	      600-EXIT.
  1428		  EXIT.
  1429
  1430	      700-UPDATE-TICEKT-FILE.
  1431	     *	  MOVE WS-TICKET-PASSED TO WS-TICKET-KEY
  1432		  MOVE REQBYO TO WS-TICKET-REQUESTOR
  1433		  MOVE TKTLEO TO WS-TICKET-TITLE
  1434		  MOVE TKDES1O TO WS-TICKET-DESCRIPTION(1:50)
  1435		  MOVE TKDES2O TO WS-TICKET-DESCRIPTION(51:50)
  1436		  MOVE STATO TO WS-TICKET-STATUS
  1437		  MOVE UPDTBYO TO WS-TICKET-LAST-UPDATE-BY
  1438		  MOVE UPDREM1O TO WS-TICKET-UPDATE-REMARKS(1:25)
  1439		  MOVE UPDREM2O TO WS-TICKET-UPDATE-REMARKS(26:25)
  1440		  MOVE UPDTO TO WS-TICKET-LAST-UPDATE
  1442		  EXEC CICS
  1443                 REWRITE FILE ('STF001C')
  1444		       FROM (WS-TICKET-REC)
  1445		       RESP(WS-RETNCODE)
  1446		       RESP2(WS-RETNCODE2)
  1447		  END-EXEC.
  1479	      700-EXIT.
  1480		  EXIT.
  1481
  1482	      800-READ-LOG-REC.
  1484		  EXEC CICS READ
  1485                FILE('STF002E')
  1486		      INTO(WS-LOG-REC)
  1487		      RIDFLD(WS-LOG-KEYS)
  1488		      GTEQ
  1489		  END-EXEC
  1521		  MOVE WS-TICKET-PASSED TO WS-LOG-TICKET-ID
  1522		  ADD 1 TO WS-LOG-SEQ-NUM
  1523		  MOVE USERID TO WS-LOG-LAST-UPDBY
  1524		  MOVE DATEO TO WS-LOG-LAST-UPD(1:10)
  1525		  MOVE TIMEO TO WS-LOG-LAST-UPD(12:9)
  1526		  MOVE UPDREM1O TO WS-LOG-UPD-REMARKS(1:25)
  1527		  MOVE UPDREM2O TO WS-LOG-UPD-REMARKS(26:25)
  1528
  1529		  PERFORM 810-CREATE-LOG-REC.
  1530	      800-EXIT.
  1531		  EXIT.
  1532
  1533	      810-CREATE-LOG-REC.
  1535		  EXEC CICS
  1536                 WRITE FILE('STF002E')
  1537		       FROM (WS-LOG-REC)
  1538		       RIDFLD (WS-LOG-KEYS)
  1539		       RESP(WS-RETNCODE)
  1540		  END-EXEC.
  1576	      810-EXIT.
  1577		  EXIT.
  1578
  1579CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\SM005.cic	       PAGE   18



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    1590
			Compilation time (mm:ss.ss):  0:00.07
			Compilation speed (lines/minute): 62857

			Compilation date (yy/mm/dd): 23/12/05
			     Time of day (hh:mm:ss): 20:04:08