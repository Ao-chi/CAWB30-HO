     5	     *CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. UA002.
    22	      ENVIRONMENT DIVISION.
    23	      CONFIGURATION SECTION.
    24	      SOURCE-COMPUTER.	  IBM-PC.
    25	      OBJECT-COMPUTER.	  IBM-PC.
    26	      DATA DIVISION.
    27	      FILE SECTION.
    28	     *----------------------------------------------------------------*
    29	     *			      WORKING STORAGE			      *
    30	     *----------------------------------------------------------------*
    31	      WORKING-STORAGE SECTION.
    32		  COPY UA002S.
    34	     * SYMBOLIC MAP of UA002S Created by CACXBMS Version 6.0.27
    80	      01  UA002MI.
    81		  02  FILLER				     PIC X(12).
    82		  02  USRIDL				     PIC S9(4) COMP.
    83		  02  USRIDF				     PIC X.
    84		  02  FILLER REDEFINES USRIDF.
    85		      03  USRIDA			     PIC X.
    86		  02  USRIDI				     PIC X(008).
    87		  02  REQTAGL				     PIC S9(4) COMP.
    88		  02  REQTAGF				     PIC X.
    89		  02  FILLER REDEFINES REQTAGF.
    90		      03  REQTAGA			     PIC X.
    91		  02  REQTAGI				     PIC X(001).
    92		  02  ADMTAGL				     PIC S9(4) COMP.
    93		  02  ADMTAGF				     PIC X.
    94		  02  FILLER REDEFINES ADMTAGF.
    95		      03  ADMTAGA			     PIC X.
    96		  02  ADMTAGI				     PIC X(001).
    97		  02  APRTAGL				     PIC S9(4) COMP.
    98		  02  APRTAGF				     PIC X.
    99		  02  FILLER REDEFINES APRTAGF.
   100		      03  APRTAGA			     PIC X.
   101		  02  APRTAGI				     PIC X(001).
   102		  02  SRVTAGL				     PIC S9(4) COMP.
   103		  02  SRVTAGF				     PIC X.
   104		  02  FILLER REDEFINES SRVTAGF.
   105		      03  SRVTAGA			     PIC X.
   106		  02  SRVTAGI				     PIC X(001).
   107		  02  ERRMSG8L				     PIC S9(4) COMP.
   108		  02  ERRMSG8F				     PIC X.
   109		  02  FILLER REDEFINES ERRMSG8F.
   110		      03  ERRMSG8A			     PIC X.
   111		  02  ERRMSG8I				     PIC X(071).
   112		  02  DATEL				     PIC S9(4) COMP.
   113		  02  DATEF				     PIC X.
   114		  02  FILLER REDEFINES DATEF.
   115		      03  DATEA 			     PIC X.
   116		  02  DATEI				     PIC X(010).
   117		  02  TIMEL				     PIC S9(4) COMP.
   118		  02  TIMEF				     PIC X.
   119		  02  FILLER REDEFINES TIMEF.
   120		      03  TIMEA 			     PIC X.
   121		  02  TIMEI				     PIC X(008).
   122	      01  UA002MO REDEFINES UA002MI.
   123		  02  FILLER				     PIC X(12).
   124		  02  FILLER				     PIC XX.   125		  02  FILLER				     PIC X.
   126		  02  USRIDO				     PIC X(008).
   127		  02  FILLER				     PIC XX.
   128		  02  FILLER				     PIC X.
   129		  02  REQTAGO				     PIC X(001).
   130		  02  FILLER				     PIC XX.
   131		  02  FILLER				     PIC X.
   132		  02  ADMTAGO				     PIC X(001).
   133		  02  FILLER				     PIC XX.
   134		  02  FILLER				     PIC X.
   135		  02  APRTAGO				     PIC X(001).
   136		  02  FILLER				     PIC XX.
   137		  02  FILLER				     PIC X.
   138		  02  SRVTAGO				     PIC X(001).
   139		  02  FILLER				     PIC XX.
   140		  02  FILLER				     PIC X.
   141		  02  ERRMSG8O				     PIC X(071).
   142		  02  FILLER				     PIC XX.
   143		  02  FILLER				     PIC X.
   144		  02  DATEO				     PIC X(010).
   145		  02  FILLER				     PIC XX.
   146		  02  FILLER				     PIC X.
   147		  02  TIMEO				     PIC X(008).
   149		  COPY DFHBMSCA.
   151	      01  DFHBMSCA.
   152	     *
   153	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   154	     *
   155	     * Revision Information
   156	     * ^{File:dfhbmsca.cob}
   157	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   158	     * ^{Revision:2.0}
   159	     *
   160	     *	Note:This FILE is provided with most values as quoted literals
   161	     *	     so that the file can be used for both ASCII and EBCDIC
   162	     *	     programs
   163	     *
   164	     *	     The only exceptions are some 3270 Data Stream Orders
   165	     *	     They use different Hexadecimal values for ASCII and
   166	     *	     EBCDIC and they cannot be expressed as quoted literals
   167	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   168	     *	     characters in ASCII
   169	     *
   170	     *	     They have their values set up to default to the EBCDIC
   171	     *	     values.
   172	     *
   173	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   174	     *	     and SEND TEXT with imbedded format orders.
   175	     *	     If you use these values in ASCII programs the values
   176	     *	     must be changed.
   177	     *
   178	     *	     An alternative is to use REPLACING to change the values.
   179	     *
   180	     *	  i.e. COPY DFHBMSCA replacing
   181	     *			    ==005== BY ==009==	*> DFHPT
   182	     *			    ==021== BY ==010==	*> DFHNL
   183	     *			    ==040== BY ==021==	*> DFHSA
   184	     *			    ==041== BY ==031==	*> DFHSFE
   185	     *			    ==044== BY ==023==	*> DFHMF
   186	     *			    ==060== BY ==020==	*> DFHRA   187	     *			    ==063== BY ==026==. *> DFHSUB
   188	     *
   189	     ******************************************************************
   190	     *BMS and Terminal Control - Order & Attributes constants	      *
   191	     ******************************************************************
   192	     *
   193	     *	  Field Attributes
   194	     *
   195            05  DFHBMASB                          PIC X VALUE '8'.
   196            05  DFHBMASF                          PIC X VALUE '1'.
   197            05  DFHBMASK                          PIC X VALUE '0'.
   198            05  DFHBMBRY                          PIC X VALUE 'H'.
   199            05  DFHBMDAR                          PIC X VALUE '<'.
   200            05  DFHBMFSE                          PIC X VALUE 'A'.
   201            05  DFHBMPRF                          PIC X VALUE '/'.
   202            05  DFHBMPRO                          PIC X VALUE '-'.
   203            05  DFHBMUNN                          PIC X VALUE '&'.
   204            05  DFHBMUNP                          PIC X VALUE ' '.
   205            05  DFHUNNUM                          PIC X VALUE 'J'.
   206	     *
   207	     *	  partially supported
   208	     *
   209            05  DFHUNNOD                          PIC X VALUE '('.
   210            05  DFHUNIMD                          PIC X VALUE 'I'.
   211            05  DFHUNINT                          PIC X VALUE 'R'.
   212            05  DFHUNNON                          PIC X VALUE '('.
   213            05  DFHPROTI                          PIC X VALUE 'Y'.
   214            05  DFHPROTN                          PIC X VALUE '%'.
   215	     *
   216	     *	  These values are additions to mainframe constants
   217	     *
   218            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   219            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   220            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   221	     *						      VALUE APOST
   222            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   223            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   224            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   225            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   226            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   227	     *
   228	     *	  Field Flag values
   229		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   230		  05  FILLER REDEFINES DFHBMEOF-VAL.
   231		      10  FILLER			PIC X.
   232		      10  DFHBMEOF			PIC X.
   233       *                                          x'80'.
   234		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   235		  05  FILLER REDEFINES DFHBMCUR-VAL.
   236		      10  FILLER			PIC X.
   237		      10  DFHBMCUR			PIC X.
   238       *                                          x'02'.
   239		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   240		  05  FILLER REDEFINES DFHBMMEC-VAL.
   241		      10  FILLER			PIC X.
   242		      10  DFHBMMEC			PIC X.
   243       *                                          x'82'.
   244       *                                          x'02'.
   245		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   246		      88  DFHERASE			VALUES 128 130.   247       *                                          x'80' X'82'
   248		      88  DFHCURSR			VALUES 002 130.
   249       *                                          x'02' X'82'
   250		  05  FILLER REDEFINES DFHBMFLG-VAL.
   251		      10  FILLER			PIC X.
   252		      10  DFHBMFLG			PIC X.
   253
   254		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   255		  05  FILLER REDEFINES DFHBMDUP-VAL.
   256		      10  FILLER			PIC X.
   257		      10  DFHBMDUP			PIC X.
   258       *                                              x'1C'
   259	     *
   260	     ******************************************************************
   261	     *	  supported 327X Extended Attributes
   262	     *
   263	     *	  Extended COLOR Attributes
   264	     *
   265            05  DFHDFCOL                          PIC X VALUE '0'.
   266            05  DFHBLUE                           PIC X VALUE '1'.
   267            05  DFHRED                            PIC X VALUE '2'.
   268            05  DFHPINK                           PIC X VALUE '3'.
   269            05  DFHGREEN                          PIC X VALUE '4'.
   270            05  DFHTURQ                           PIC X VALUE '5'.
   271            05  DFHYELLO                          PIC X VALUE '6'.
   272            05  DFHNEUTR                          PIC X VALUE '7'.
   273	     *
   274	     *	  Extended HILIGHT Attributes
   275	     *
   276            05  DFHDFHI                           PIC X VALUE '0'.
   277            05  DFHBLINK                          PIC X VALUE '1'.
   278            05  DFHREVRS                          PIC X VALUE '2'.
   279            05  DFHUNDLN                          PIC X VALUE '4'.
   280	     *
   281	     ******************************************************************
   282	     *	  supported 327X Data Stream Orders
   283	     *
   284		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   285		  05  FILLER REDEFINES DFHSBA-VAL.
   286		      10  FILLER			PIC X.
   287		      10  DFHSBA			PIC X.
   288       *                                              x'11'
   289		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   290		  05  FILLER REDEFINES DFHEUA-VAL.
   291		      10  FILLER			PIC X.
   292		      10  DFHEUA			PIC X.
   293       *                                              x'12'
   294		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   295		  05  FILLER REDEFINES DFHIC-VAL.
   296		      10  FILLER			PIC X.
   297		      10  DFHIC 			PIC X.
   298       *                                              X'13'.
   299		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
   300		  05  FILLER REDEFINES DFHSF-VAL.
   301		      10  FILLER			PIC X.
   302		      10  DFHSF 			PIC X.
   303       *                                              X'1D'.
   304		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
   305		      88 DFHPT-VAL-EBCDIC		VALUE 5.
   306		      88 DFHPT-VAL-ASCII		VALUE 9.   307		  05  FILLER REDEFINES DFHPT-VAL.
   308		      10  FILLER			PIC X.
   309		      10  DFHPT 			PIC X.
   310       *                                              EBCDIC X'05'.
   311       *                                              ASCII  X'09'.
   312		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
   313		      88 DFHRA-VAL-EBCDIC		VALUE 60.
   314		      88 DFHRA-VAL-ASCII		VALUE 20.
   315		  05  FILLER REDEFINES DFHRA-VAL.
   316		      10  FILLER			PIC X.
   317		      10  DFHRA 			PIC X.
   318       *                                              EBCDIC x'3C'
   319       *                                              ASCII  x'14'
   320		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
   321		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
   322		      88 DFHSFE-VAL-ASCII		VALUE 31.
   323		  05  FILLER REDEFINES DFHSFE-VAL.
   324		      10  FILLER			PIC X.
   325		      10  DFHSFE			PIC X.
   326       *                                              EBCDIC x'29'
   327       *                                              ASCII  x'1F'
   328		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
   329		      88 DFHMF-VAL-EBCDIC		VALUE 44.
   330		      88 DFHMF-VAL-ASCII		VALUE 23.
   331		  05  FILLER REDEFINES DFHMF-VAL.
   332		      10  FILLER			PIC X.
   333		      10  DFHMF 			PIC X.
   334       *                                              EBCDIC x'2C'
   335       *                                              ASCII  x'17'
   336	     *
   337	     ******************************************************************
   338	     *	  unsupported 327X Data Stream order codes
   339	     *
   340		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
   341		      88 DFHSA-VAL-EBCDIC		VALUE 40.
   342		      88 DFHSA-VAL-ASCII		VALUE 21.
   343		  05  FILLER REDEFINES DFHSA-VAL.
   344		      10  FILLER			PIC X.
   345		      10  DFHSA 			PIC X.
   346       *                                              EBCDIC x'28'
   347       *                                              ASCII  x'15'
   348		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
   349		  05  FILLER REDEFINES DFHGE-VAL.
   350		      10  FILLER			PIC X.
   351		      10  DFHGE 			PIC X.
   352       *                                              X'08'.
   353	     *
   354	     ******************************************************************
   355	     *	  SFE and MF supported attribute types
   356	     *
   357            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
   358       *                                              EBCDIC x'42'
   359       *                                              ASCII  x'83'
   360            05  DFHHLT                            PIC X VALUE 'Ö'.
   361       *                                              EBCDIC x'41'
   362       *                                              ASCII  x'D6'
   363            05  DFH3270                           PIC X VALUE '{'.
   364	     *
   365	     *	  supported for SEND TEXT command and printer terminal
   366	     *   367		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
   368		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
   369		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
   370		  05  FILLER REDEFINES DFHBMPNL-VAL.
   371		      10  FILLER			PIC X.
   372		      10  DFHBMPNL			PIC X.
   373       *                                              EBCDIC X'15'.
   374       *                                              ASCII  X'0A'.
   375	     *
   376	     ******************************************************************
   377	     *	  Printer terminal data stream only
   378	     *
   379		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
   380		  05  FILLER REDEFINES DFHBMPFF-VAL.
   381		      10  FILLER			PIC X.
   382		      10  DFHBMPFF			PIC X.
   383       *                                              X'0C'.
   384		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.
   385		  05  FILLER REDEFINES DFHBMPCR-VAL.
   386		      10  FILLER			PIC X.
   387		      10  DFHBMPCR			PIC X.
   388       *                                              X'0D'.
   389		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
   390		  05  FILLER REDEFINES DFHBMPEM-VAL.
   391		      10  FILLER			PIC X.
   392		      10  DFHBMPEM			PIC X.
   393       *                                              X'19'.
   394	     *
   395	     ******************************************************************
   396	     *	  unsupported Miscellaneous attributes and constants
   397	     *
   398		  05  DFHALL				PIC X VALUE LOW-VALUES.
   399            05  DFHBASE                           PIC X VALUE '0'.
   400		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
   401		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
   402		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
   403		      10  DFHBMPSO			PIC X.
   404       *                                              X'0E'.
   405		      10  DFHBMPSI			PIC X.
   406       *                                              X'0F'.
   407		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
   408            05  DFHERROR                          PIC X VALUE '¶'.
   409       *                                              EBCDIC X'1A'.
   410       *                                              ASCII  X'B6'.
   411            05  DFHFIL                            PIC X VALUE '4'.
   412            05  DFHMENT                           PIC X VALUE '2'.
   413            05  DFHMET                            PIC X VALUE '3'.
   414            05  DFHMFE                            PIC X VALUE '6'.
   415            05  DFHMFET                           PIC X VALUE '7'.
   416            05  DFHMFT                            PIC X VALUE '5'.
   417            05  DFHMT                             PIC X VALUE '1'.
   418            05  DFHOUTLN                          PIC X VALUE 'B'.
   419            05  DFHPS                             PIC X VALUE '„'.
   420       *                                              EBCDIC x'43'
   421       *                                              ASCII  x'84'
   422            05  DFHVAL                            PIC X VALUE 'A'.
   423	     *
   424		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
   425		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
   426		      88 DFHSUB-VAL-ASCII		VALUE 26.   427		  05  FILLER REDEFINES DFHSUB-VAL.
   428		      10  FILLER			PIC X.
   429		      10  DFHSUB			PIC X.
   430       *                                              EBCDIC X'3F'.
   431       *                                              ASCII  X'1A'.
   432	     *
   433		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
   434		  05  FILLER REDEFINES DFHFM-VAL.
   435		      10  FILLER			PIC X.
   436		      10  DFHFM 			PIC X.
   437       *                                              EBCDIC X'1E'.
   438		  05  DFHEO VALUE HIGH-VALUE		PIC X.
   440		  COPY DFHAID.
   442	      01  DFHAID.
   443	     *
   444	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   445	     *
   446	     * Revision Information
   447	     * ^{File:dfhaid.cob  }
   448	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   449	     * ^{Revision:2.0}
   450	     *
   451	     *This is the AID constants copy file
   452	     *
   453            05  DFHENTER                  PIC X VALUE ''''.
   454	     *					value APOST
   455            05  DFHCLEAR                  PIC X VALUE '_'.
   456            05  DFHPA1                    PIC X VALUE '%'.
   457            05  DFHPA2                    PIC X VALUE '>'.
   458            05  DFHPA3                    PIC X VALUE ','.
   459            05  DFHPF1                    PIC X VALUE '1'.
   460            05  DFHPF2                    PIC X VALUE '2'.
   461            05  DFHPF3                    PIC X VALUE '3'.
   462            05  DFHPF4                    PIC X VALUE '4'.
   463            05  DFHPF5                    PIC X VALUE '5'.
   464            05  DFHPF6                    PIC X VALUE '6'.
   465            05  DFHPF7                    PIC X VALUE '7'.
   466            05  DFHPF8                    PIC X VALUE '8'.
   467            05  DFHPF9                    PIC X VALUE '9'.
   468            05  DFHPF10                   PIC X VALUE ':'.
   469            05  DFHPF11                   PIC X VALUE '#'.
   470            05  DFHPF12                   PIC X VALUE '@'.
   471            05  DFHPF13                   PIC X VALUE 'A'.
   472            05  DFHPF14                   PIC X VALUE 'B'.
   473            05  DFHPF15                   PIC X VALUE 'C'.
   474            05  DFHPF16                   PIC X VALUE 'D'.
   475            05  DFHPF17                   PIC X VALUE 'E'.
   476            05  DFHPF18                   PIC X VALUE 'F'.
   477            05  DFHPF19                   PIC X VALUE 'G'.
   478            05  DFHPF20                   PIC X VALUE 'H'.
   479            05  DFHPF21                   PIC X VALUE 'I'.
   480            05  DFHPF22                   PIC X VALUE '›'.
   481       *                                  EBCDIC Cent sign x'4A'
   482       *                                  ASCII  Cent sign x'9B'
   483            05  DFHPF23                   PIC X VALUE '.'.
   484            05  DFHPF24                   PIC X VALUE '<'.
   485            05  DFHOPID                   PIC X VALUE 'W'.
   486            05  DFHMSRE                   PIC X VALUE 'X'.
   487            05  DFHTRIG                   PIC X VALUE '"'.
   488       *                                        value QUOTE  "   489            05  DFHPEN                    PIC X VALUE '='.
   490            05  DFHCLRP                   PIC X VALUE 'Ý'.
   491       *                                  EBCDIC x'6A'
   492       *                                  ASCII  x'DD'
   493            05  DFHSTRF                   PIC X VALUE 'h'.
   494	     *	  DFHQUIT is a CA-Realia CICS Extension
   495	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   496            05  DFHQUIT                   PIC X VALUE '!'.
   497		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   499
   500        01  WS-CURRENT-MAP  VALUE 'UA002S'        PIC X(7).
   501	      01  WS-REC-LENGTH 			PIC S9(4)
   502		  COMP VALUE +21.
   503        01  WS-FLAG                               PIC X    VALUE 'N'.
   504	      01  WS-KEYB.
   505		  05 WS-KEYB6			PIC X(06) VALUE LOW-VALUES.
   506		  05 FILLER REDEFINES WS-KEYB6.
   507		     10 FILLER			PIC X(03).
   508		     10 WS-KEYB3		PIC 9(03).
   509		  05 WS-KEYB1			PIC X(01) VALUE HIGH-VALUES.
   510	      01  WS-STF-REC.
   511		  05 WS-TICKET-ID			PIC 9(07).
   512		  05 WS-TIX-ID				REDEFINES WS-TICKET-ID.
   513		     10 WS-T-ID 			PIC X(06).
   514		     10 FILLER				PIC X.
   515		  05 WS-TICKET-REQ			PIC X(08).
   516		  05 WS-TICKET-STAT			PIC X(10).
   517		  05 WS-TICKET-TITLE			PIC X(25).
   518		  05 WS-TICKET-DESC			PIC X(100).
   519		  05 WS-LAST-UPD			PIC X(20).
   520		  05 WS-UPD-BY				PIC X(08).
   521		  05 WS-UPD-REMARKS			PIC X(50).
   522	      01  WS-USER-REC.
   523		  05 WS-USERID.
   524		     10  WS-USERID7			PIC X(7).
   525		     10  FILLER 			PIC X(1).
   526		  05 WS-TYPE.
   527		     10  WS-REQUESTOR			PIC X.
   528		     10  WS-ADMIN			PIC X.
   529		     10  WS-APPROVER			PIC X.
   530		     10  WS-SERVICE			PIC X.
   531		  05 WS-UPDATEDBY			PIC X(8).
   532	      01  WS-TIME				PIC 9(15) COMP-3.
   533	      01  WS-DATE				PIC 9(7).
   534	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
   535	      01  WS-LENGTH				PIC S9(4) COMP.
   536
   537	      01  WS-COUNTERS.
   538		  05 WS-INDEX				PIC 9(02).
   539	      01  WS-ERRMSGS.
   540		  05 WS-END				PIC X(15) VALUE
   541               'END PREOCESSING'.
   542		  05 WS-INVALID-ACCESS			PIC X(15) VALUE
   543               'INVALID ACCESS'.
   544		  05 WS-INVALID-PGMID			PIC X(20) VALUE
   545               'INVALID USER ACCESS'.
   546		  05 WS-MAPFAIL 			PIC X(20) VALUE
   547               'MAPFAIL ERROR'.
   548		  05 WS-INVALID-TIX-ACC 		PIC X(34) VALUE
   549               'INVALID ACCESS TO SELECTED TICKET'.   550		  05 WS-FIELD-REQ			PIC X(24) VALUE
   551               'OPTION FIELD IS REQUIRED'.
   552		  05 WS-INVALID-VALUE			PIC X(46) VALUE
   553               'INVALID VALUE. PLEASE CORRECT HIGHLIGHT FIELDS'.
   554		  05 WS-INVALID-PFKEY			PIC X(21) VALUE
   555                'INAVLID PFKEY PRESSED'.
   556
   557	      01  WS-PAGE-NO				PIC 9(03) VALUE 1.
   558	      77 WS-RETNCODE	    PIC S9(8) COMP.
   559	      77 WS-RETNCODE2	     PIC S9(8) COMP.
   560	     *--------------------------------------------------------------*
   561	     *		     COMMAREA WORKING STORAGE			    *
   562	     *--------------------------------------------------------------*
   563	      01  WS-COMMAREA.
   564		  05 WS-PGMID				PIC X(06).
   565		  05 WS-STATE				PIC X.
   566		  05 WS-TICKET-PASSED			PIC X(07).
   567		  05 USERID.
   568		     10  USERID7			PIC X(7).
   569		     10  FILLER 			PIC X(1).
   570		  05 USR-TYPE.
   571		    15 USR-REQUESTOR			PIC X.
   572		    15 USR-ADMIN			PIC X.
   573		    15 USR-APPROVER			PIC X.
   574		    15 USR-SERVICE			PIC X.
   575		  05 WS-SM012-STATE			PIC X.
   576		  05 WS-SM012-PGMID			PIC X(06).
   577		  05 WS-STF01-REC.
   578		     10 WS-STF01-ID			PIC X(07).
   579		     10 FILL1				PIC X(03).
   580		     10 WS-STF01-TITLE			PIC X(25).
   581		     10 FILL2				PIC X(01).
   582		     10 WS-STF01-STATUS 		PIC X(10).
   583		     10 FILL3				PIC X(04).
   584		     10 WS-STF01-LAST-UPD		PIC X(10).
   585		     10 FILL4				PIC X(02).
   586		     10 WS-STF01-LAST-UPDBY		PIC X(8).
   587		     10 WS-STF01-REQ			PIC X(8).
   588		  05 WS-PGMNAME 			PIC  X(6).
   589		  05 WS-DFHSTATE			PIC X(15).
   590		  05 WS-TRANS				PIC X(04).
   591		  05 WS-LUSER				PIC 9(03).
   592		  05 WS-FUSER				PIC X(07).
   593		  05 WS-PAGE				PIC 9(02).
   594		  05 WS-PAGE-END			PIC 9(01).
   595		  05 WS-ADDED-USER		     PIC X(08).
   596		  05 WS-USER-DETL.
   597		     10 WS-USER-ADD			PIC X(08).
   598		     10 WS-USER-REQ			PIC X.
   599		     10 WS-USER-ADMIN			PIC X.
   600		     10 WS-USER-APPROVER		PIC X.
   601		     10 WS-USER-SERVICE 		PIC X.
   602
   603	     *----------------------------------------------------------------*
   604	     *			       LINKAGE SECTION			      *
   605	     *----------------------------------------------------------------*
   606	      LINKAGE SECTION.
   608	      01  DFHEIBLK.						       R
   609		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
   610		  05 EIBDATE  PIC S9(7) COMP-3. 			       R   611		  05 EIBTRNID PIC X(4). 				       R
   612		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
   613		  05 EIBTRMID PIC X(4). 				       R
   614		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
   615		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
   616		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
   617		  05 EIBAID   PIC X.					       R
   618		  05 EIBFN    PIC X(2). 				       R
   619		  05 EIBRCODE PIC X(6). 				       R
   620		  05 EIBDS    PIC X(8). 				       R
   621		  05 EIBREQID PIC X(8). 				       R
   622		  05 EIBRSRCE PIC X(8). 				       R
   623		  05 EIBSYNC  PIC X.					       R
   624		  05 EIBFREE  PIC X.					       R
   625		  05 EIBRECV  PIC X.					       R
   626		  05 EIBSEND  PIC X.					       R
   627		  05 EIBATT   PIC X.					       R
   628		  05 EIBEOC   PIC X.					       R
   629		  05 EIBFMH   PIC X.					       R
   630		  05 EIBCOMPL PIC X.					       R
   631		  05 EIBSIG   PIC X.					       R
   632		  05 EIBCONF  PIC X.					       R
   633		  05 EIBERR   PIC X.					       R
   634		  05 EIBERRCD PIC X(4). 				       R
   635		  05 EIBSYNRB PIC X.					       R
   636		  05 EIBNODAT PIC X.					       R
   637		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
   638		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
   639		  05 EIBRLDBK PIC X.					       R
   640		  05 EIBCARESERVED PIC X(32).				       R
   642	      01  DFHCOMMAREA.
   643		  05 DF-PGMID				PIC X(06).
   644		  05 DF-STATE				PIC X.
   645		  05 DF-TICKET-PASSED			PIC X(07).
   646		  05 DF-USERID.
   647		     10  DF-USERID7			PIC X(7).
   648		     10  FILLER 			PIC X(1).
   649		  05 DF-USR-TYPE.
   650		    15 DF-USR-REQUESTOR 		PIC X.
   651		    15 DF-USR-ADMIN			PIC X.
   652		    15 DF-USR-APPROVER			PIC X.
   653		    15 DF-USR-SERVICE			PIC X.
   654		  05 DF-SM012-STATE			PIC X.
   655		  05 DF-SM012-PGMID			PIC X(06).
   656		  05 DF-STF01-REC.
   657		     10 DF-STF01-ID			PIC X(07).
   658		     10 DF-FILLER			PIC X(03).
   659		     10 DF-STF01-TITLE			PIC X(25).
   660		     10 DF-FILLER			PIC X(01).
   661		     10 DF-STF01-STATUS 		PIC X(10).
   662		     10 DF-FILLER			PIC X(04).
   663		     10 DF-STF01-LAST-UPD		PIC X(10).
   664		     10 DF-FILLER4			PIC X(02).
   665		     10 DF-STF01-LAST-UPDBY		PIC X(8).
   666		     10 DF-STF01-REQ			PIC X(8).
   667		  05 DF-PGMNAME 			PIC X(6).
   668		  05 DFHSTATE				PIC X(15).
   669		  05 DF-TRANS				PIC X(04).
   670		  05 DF-LUSER				PIC 9(03).
   671		  05 DF-FUSER				PIC X(07).   672		  05 DF-PAGE				PIC 9(02).
   673		  05 DF-PAGE-END			PIC 9(01).
   674		  05 DF-ADDED-USER			PIC X(08).
   675		  05 DF-USER-DETL.
   676		     10 DF-USER 			PIC X(08).
   677		     10 DF-USER-REQ			PIC X.
   678		     10 DF-USER-ADMIN			PIC X.
   679		     10 DF-USER-APPROVER		PIC X.
   680		     10 DF-USER-SERVICE 		PIC X.
   681	     *----------------------------------------------------------------*
   682	     *			       PROGRAM DIVISION 		      *
   683	     *----------------------------------------------------------------*
   684	      PROCEDURE DIVISION					       R
   686		  USING DFHEIBLK DFHCOMMAREA.				       R
   711	      100-MAIN.
   713		  EXEC CICS IGNORE CONDITION
   714			    ERROR
   715		  END-EXEC
   730
   731		  MOVE DFHCOMMAREA TO WS-COMMAREA
   732            IF WS-PGMID = 'SM000' OR WS-PGMID = 'UA001' OR
   733               WS-PGMID = 'UA002'
   734		     EVALUATE TRUE
   735		       WHEN WS-STATE = LOW-VALUES
   736			  MOVE 1 TO WS-STATE
   737                    MOVE 'ENTER USER DETAILS AND PRESS PF2' TO ERRMSG8O
   738			  MOVE -1 TO USRIDL
   739			  PERFORM 111-CREATE-MAP
   740		       WHEN WS-STATE = 1
   741			    PERFORM 200-REC-MAP
   742			    PERFORM 120-MOVE-DATA-TO-HOLDER
   743			    PERFORM 300-CHECK-EIBAID
   744			    PERFORM 111-CREATE-MAP
   745		       WHEN WS-STATE = 2
   746			    PERFORM 200-REC-MAP
   747	     *		    PERFORM 120-MOVE-DATA-TO-HOLDER
   748			    PERFORM 300-CHECK-EIBAID
   749			    PERFORM 111-CREATE-MAP
   750		       WHEN WS-STATE = 3
   751			    PERFORM 200-REC-MAP
   752	     *		    PERFORM 120-MOVE-DATA-TO-HOLDER
   753			    PERFORM 300-CHECK-EIBAID
   754			    PERFORM 111-CREATE-MAP
   755		     END-EVALUATE
   756		  ELSE
   757		      MOVE SPACES TO ERRMSG8O
   758		      MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
   760		      EXEC CICS SEND TEXT
   761			      FROM (WS-INVALID-ACCESS)
   762			      LENGTH (WS-LENGTH)
   763			      ERASE
   764			 END-EXEC
   795		      EXEC CICS RETURN
   796		      END-EXEC
   809		  END-IF.
   810	      100-EXIT.
   811		  EXIT.
   812
   813	      110-DATE-TIME.
   814		  MOVE EIBDATE TO WS-DATE.   815		  MOVE WS-DATE-X TO DATEO.
   817		  EXEC CICS ASKTIME
   818		       ABSTIME	  (WS-TIME)
   819		  END-EXEC
   838		  EXEC CICS FORMATTIME
   839		       ABSTIME	  (WS-TIME)
   840                 DATESEP    ('/')
   841		       MMDDYYYY   (DATEO)
   842		       TIME	  (TIMEO)
   843                 TIMESEP    (':')
   844		  END-EXEC
   884		  MOVE DFHBMASB TO TIMEA
   885		  MOVE DFHBMASB TO DATEA.
   886	      110-EXIT.
   887		  EXIT.
   888
   889	      111-CREATE-MAP.
   890		  PERFORM 110-DATE-TIME
   891		  MOVE LENGTH OF UA002MO TO WS-LENGTH
   893		  EXEC CICS SEND
   894                 MAP('UA002M')
   895		       MAPSET(WS-CURRENT-MAP)
   896		       FROM(UA002MO)
   897		       LENGTH(WS-LENGTH)
   898		       CURSOR
   899		       ERASE
   900		  END-EXEC
   946		  EXEC CICS RETURN
   947                 TRANSID('UA02')
   948		       COMMAREA(WS-COMMAREA)
   949		  END-EXEC.
   974	      110-EXIT.
   975		  EXIT.
   976	     *Minove sa commarea para pag nagescape ung user di mabubura sa scre
   977	     *inputs nila
   978	      120-MOVE-DATA-TO-HOLDER.
   979		  MOVE USRIDI TO WS-USER-ADD
   980		  MOVE REQTAGI TO WS-USER-REQ
   981		  MOVE ADMTAGI TO WS-USER-ADMIN
   982		  MOVE APRTAGI TO WS-USER-APPROVER
   983		  MOVE SRVTAGI TO WS-USER-SERVICE.
   984	      120-EXIT.
   985		  EXIT.
   986
   987	      200-REC-MAP.
   989		  EXEC CICS RECEIVE
   990                 MAP('UA002M')
   991		       MAPSET(WS-CURRENT-MAP)
   992		       INTO (UA002MI)
   993		       RESP(WS-RETNCODE)
   994		  END-EXEC
  1033	     *	  Eto pang handle ng escape keypress
  1035		  IF EIBRESP = DFHRESP(MAPFAIL)
  1037		  IF EIBRESP =	       036				       R
  1038		     MOVE WS-INVALID-PFKEY TO ERRMSG8O
  1039		     MOVE WS-USER-ADD TO USRIDI
  1040		     MOVE WS-USER-REQ TO REQTAGI
  1041		     MOVE WS-USER-ADMIN TO ADMTAGI
  1042		     MOVE WS-USER-APPROVER TO APRTAGI
  1043		     MOVE WS-USER-SERVICE TO SRVTAGI  1044		     MOVE -1 TO USRIDL
  1045		     MOVE 1 TO WS-STATE
  1046		     PERFORM 111-CREATE-MAP
  1047		  END-IF.
  1048	      200-EXIT.
  1049		  EXIT.
  1050
  1051	      300-CHECK-EIBAID.
  1052		  EVALUATE EIBAID
  1053		   WHEN DFHPF2
  1054			EVALUATE TRUE
  1055			  WHEN WS-STATE = 1
  1056			     MOVE 2 TO WS-STATE
  1057			     PERFORM 310-VALIDATE-DETAILS
  1058                       IF WS-FLAG = 'Y'
  1059				 MOVE 1 TO WS-STATE
  1060			     ELSE
  1061				 MOVE 3 TO WS-STATE
  1062
  1063				 STRING WS-USER-ADD DELIMITED BY SIZE
  1064                             'CREATED PRESS ENTER TO' DELIMITED BY SIZE
  1065                             ' CREATE ANOTHER USER ID' DELIMITED BY SIZE
  1066				   INTO ERRMSG8O
  1067				 END-STRING
  1068				 MOVE WS-USER-ADD TO USRIDI
  1069				 MOVE WS-USER-REQ TO REQTAGI
  1070				 MOVE WS-USER-ADMIN TO ADMTAGI
  1071				 MOVE WS-USER-APPROVER TO APRTAGI
  1072				 MOVE WS-USER-SERVICE TO SRVTAGI
  1073				 PERFORM 320-SET-PROTECTED
  1074				 MOVE -1 TO USRIDL
  1075				 MOVE WS-USER-ADD TO WS-USERID
  1076				 MOVE WS-USER-REQ TO WS-REQUESTOR
  1077				 MOVE WS-USER-ADMIN TO WS-ADMIN
  1078				 MOVE WS-USER-APPROVER TO WS-APPROVER
  1079				 MOVE WS-USER-SERVICE TO WS-SERVICE
  1080                           MOVE 'ISCB126 ' TO WS-UPDATEDBY
  1081				 PERFORM 400-WRITE-USER
  1082			     END-IF
  1083			  WHEN WS-STATE = 2
  1084			       MOVE 3 TO WS-STATE
  1085
  1086				 STRING WS-USER-ADD DELIMITED BY SIZE
  1087                             'CREATED PRESS ENTER TO' DELIMITED BY SIZE
  1088                             ' CREATE ANOTHER USER ID' DELIMITED BY SIZE
  1089				   INTO ERRMSG8O
  1090				 END-STRING
  1091				 MOVE WS-USER-ADD TO USRIDI
  1092				 MOVE WS-USER-REQ TO REQTAGI
  1093				 MOVE WS-USER-ADMIN TO ADMTAGI
  1094				 MOVE WS-USER-APPROVER TO APRTAGI
  1095				 MOVE WS-USER-SERVICE TO SRVTAGI
  1096				 PERFORM 320-SET-PROTECTED
  1097				 MOVE -1 TO USRIDL
  1098				 MOVE WS-USER-ADD TO WS-USERID
  1099				 MOVE WS-USER-REQ TO WS-REQUESTOR
  1100				 MOVE WS-USER-ADMIN TO WS-ADMIN
  1101				 MOVE WS-USER-APPROVER TO WS-APPROVER
  1102				 MOVE WS-USER-SERVICE TO WS-SERVICE
  1103                           MOVE 'ISCB126 ' TO WS-UPDATEDBY  1104
  1105				 PERFORM 400-WRITE-USER
  1106			  WHEN WS-STATE = 3
  1107			       MOVE WS-USER-ADD TO USRIDI
  1108			       MOVE WS-USER-REQ TO REQTAGI
  1109			       MOVE WS-USER-ADMIN TO ADMTAGI
  1110			       MOVE WS-USER-APPROVER TO APRTAGI
  1111			       MOVE WS-USER-SERVICE TO SRVTAGI
  1112			       MOVE -1 TO USRIDL
  1113			       PERFORM 320-SET-PROTECTED
  1114			       CONTINUE
  1115			END-EVALUATE
  1116		   WHEN DFHPF3
  1117                  MOVE 'UA002' TO WS-PGMID
  1118			MOVE LOW-VALUES TO WS-STATE
  1119			MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  1121			EXEC CICS XCTL
  1122                       PROGRAM('UA001')
  1123			     COMMAREA(WS-COMMAREA)
  1124			END-EXEC
  1148		   WHEN DFHPF5
  1149			EVALUATE TRUE
  1150			  WHEN WS-STATE = 1
  1151			       MOVE 1 TO WS-STATE
  1152			       PERFORM 340-MOVE-LOW-VALUES
  1153                         MOVE 'ENTER USER DETAILS AND PRESS PF2'
  1154				    TO ERRMSG8O
  1155			       MOVE -1 TO USRIDL
  1156			  WHEN WS-STATE = 2
  1157			       MOVE 1 TO WS-STATE
  1158			       PERFORM 340-MOVE-LOW-VALUES
  1159                         MOVE 'ENTER USER DETAILS AND PRESS PF2'
  1160				    TO ERRMSG8O
  1161			       MOVE -1 TO USRIDL
  1162			  WHEN WS-STATE = 3
  1163			       MOVE WS-USER-ADD TO USRIDI
  1164			       MOVE WS-USER-REQ TO REQTAGI
  1165			       MOVE WS-USER-ADMIN TO ADMTAGI
  1166			       MOVE WS-USER-APPROVER TO APRTAGI
  1167			       MOVE WS-USER-SERVICE TO SRVTAGI
  1168			       MOVE -1 TO USRIDL
  1169			       PERFORM 320-SET-PROTECTED
  1170			       CONTINUE
  1171			END-EVALUATE
  1172		   WHEN DFHENTER
  1173			IF WS-STATE = 1
  1174			   MOVE 2 TO WS-STATE
  1175			   PERFORM 310-VALIDATE-DETAILS
  1176                     IF WS-FLAG = 'Y'
  1177			       MOVE 1 TO WS-STATE
  1178			    ELSE
  1179			       MOVE 2 TO WS-STATE
  1180                         MOVE 'PRESS PF2 TO CONFIRM ADD' TO ERRMSG8O
  1181			       PERFORM 320-SET-PROTECTED
  1182			       MOVE -1 TO USRIDL
  1183			   END-IF
  1184
  1185			ELSE
  1186			   IF WS-STATE = 2
  1187                        MOVE 'PRESS PF2 TO ADD USER' TO ERRMSG8O  1188			      PERFORM 320-SET-PROTECTED
  1189			      MOVE -1 TO USRIDL
  1190			      CONTINUE
  1191			   ELSE
  1192			      IF WS-STATE = 3
  1193				 MOVE 1 TO WS-STATE
  1194				 PERFORM 340-MOVE-LOW-VALUES
  1195                           MOVE 'ENTER USER DETAILS AND PRESS PF2'
  1196				      TO ERRMSG8O
  1197				 MOVE -1 TO USRIDL
  1198
  1199			      END-IF
  1200			   END-IF
  1201			END-IF
  1202		   WHEN OTHER
  1203			MOVE WS-INVALID-PFKEY TO ERRMSG8O
  1204			MOVE WS-USER-ADD TO USRIDI
  1205			MOVE WS-USER-REQ TO REQTAGI
  1206			MOVE WS-USER-ADMIN TO ADMTAGI
  1207			MOVE WS-USER-APPROVER TO APRTAGI
  1208			MOVE WS-USER-SERVICE TO SRVTAGI
  1209			MOVE -1 TO USRIDL
  1210			EVALUATE TRUE
  1211			  WHEN WS-STATE = 1
  1212			       MOVE 1 TO WS-STATE
  1213			  WHEN WS-STATE = 2
  1214			       MOVE 2 TO WS-STATE
  1215			  WHEN WS-STATE = 3
  1216			       MOVE 3 TO WS-STATE
  1217			END-EVALUATE
  1218		  END-EVALUATE.
  1219	      300-EXIT.
  1220		  EXIT.
  1221
  1222	      310-VALIDATE-DETAILS.
  1223		  EVALUATE TRUE
  1224		    WHEN USRIDI = LOW-VALUES
  1225                   MOVE 'USER ID IS REQUIRED' TO ERRMSG8O
  1226			 MOVE 1 TO WS-STATE
  1227			 MOVE -1 TO USRIDL
  1228			 MOVE DFHUNIMD TO USRIDA
  1229                   MOVE 'Y' TO WS-FLAG
  1230		    WHEN REQTAGI = LOW-VALUES
  1231                   MOVE 'REQURESTOR TAG IS REQUIRED' TO ERRMSG8O
  1232			 MOVE 1 TO WS-STATE
  1233			 MOVE -1 TO REQTAGL
  1234			 MOVE DFHUNIMD TO REQTAGA
  1235                   MOVE 'Y' TO WS-FLAG
  1236		    WHEN ADMTAGI = LOW-VALUES
  1237                   MOVE 'ADMIN TAG IS REQUIRED' TO ERRMSG8O
  1238			 MOVE 1 TO WS-STATE
  1239			 MOVE -1 TO ADMTAGL
  1240			 MOVE DFHUNIMD TO ADMTAGA
  1241                   MOVE 'Y' TO WS-FLAG
  1242		    WHEN APRTAGI = LOW-VALUES
  1243                   MOVE 'APPROVER TAG IS REQUIRED' TO ERRMSG8O
  1244			 MOVE 1 TO WS-STATE
  1245			 MOVE -1 TO APRTAGL
  1246			 MOVE DFHUNIMD TO APRTAGA
  1247                   MOVE 'Y' TO WS-FLAG  1248		    WHEN SRVTAGI = LOW-VALUES
  1249                   MOVE 'SERVICE TAG IS REQUIRED' TO ERRMSG8O
  1250			 MOVE 1 TO WS-STATE
  1251			 MOVE -1 TO SRVTAGL
  1252			 MOVE DFHUNIMD TO SRVTAGA
  1253                   MOVE 'Y' TO WS-FLAG
  1254		  END-EVALUATE
  1255
  1256		  IF REQTAGI NOT = LOW-VALUES
  1257               IF REQTAGI = 'Y' OR REQTAGI = 'N'
  1258			MOVE 2 TO WS-STATE
  1259		     ELSE
  1260			MOVE WS-INVALID-VALUE TO ERRMSG8O
  1261                  MOVE 'Y' TO WS-FLAG
  1262			MOVE -1 TO REQTAGL
  1263			MOVE DFHUNIMD TO REQTAGA
  1264		     END-IF
  1265		  END-IF
  1266		  IF ADMTAGI NOT = LOW-VALUES
  1267               IF ADMTAGI = 'Y' OR ADMTAGI = 'N'
  1268			MOVE 2 TO WS-STATE
  1269		     ELSE
  1270			MOVE WS-INVALID-VALUE TO ERRMSG8O
  1271                  MOVE 'Y' TO WS-FLAG
  1272			MOVE -1 TO ADMTAGL
  1273			MOVE DFHUNIMD TO ADMTAGA
  1274		     END-IF
  1275		  END-IF
  1276		  IF APRTAGI NOT = LOW-VALUES
  1277               IF APRTAGI = 'Y' OR APRTAGI = 'N'
  1278			MOVE 2 TO WS-STATE
  1279		     ELSE
  1280			MOVE WS-INVALID-VALUE TO ERRMSG8O
  1281                  MOVE 'Y' TO WS-FLAG
  1282			MOVE -1 TO APRTAGL
  1283			MOVE DFHUNIMD TO APRTAGA
  1284		     END-IF
  1285		  END-IF
  1286		  IF SRVTAGI NOT = LOW-VALUES
  1287               IF SRVTAGI = 'Y' OR SRVTAGI = 'N'
  1288			MOVE 2 TO WS-STATE
  1289		     ELSE
  1290			MOVE WS-INVALID-VALUE TO ERRMSG8O
  1291                  MOVE 'Y' TO WS-FLAG
  1292			MOVE -1 TO SRVTAGL
  1293			MOVE DFHUNIMD TO SRVTAGA
  1294		     END-IF
  1295		  END-IF.
  1296	      310-EXIT.
  1297		  EXIT.
  1298
  1299	      320-SET-PROTECTED.
  1300		  MOVE DFHBMPRO TO USRIDA
  1301		  MOVE DFHBMPRO TO REQTAGA
  1302		  MOVE DFHBMPRO TO ADMTAGA
  1303		  MOVE DFHBMPRO TO APRTAGA
  1304		  MOVE DFHBMPRO TO SRVTAGA.
  1305	      320-EXIT.
  1306		  EXIT.
  1307  1308	      330-SET-UNPROTECTED.
  1309		  MOVE DFHBMUNP TO USRIDA
  1310		  MOVE DFHBMUNP TO REQTAGA
  1311		  MOVE DFHBMUNP TO ADMTAGA
  1312		  MOVE DFHBMUNP TO APRTAGA
  1313		  MOVE DFHBMUNP TO SRVTAGA.
  1314	      330-EXIT.
  1315		  EXIT.
  1316
  1317	      340-MOVE-LOW-VALUES.
  1318		  MOVE LOW-VALUES TO USRIDI
  1319		  MOVE LOW-VALUES TO REQTAGI
  1320		  MOVE LOW-VALUES TO ADMTAGI
  1321		  MOVE LOW-VALUES TO APRTAGI
  1322		  MOVE LOW-VALUES TO SRVTAGI.
  1323	      340-EXIT.
  1324		  EXIT.
  1325
  1326	      400-WRITE-USER.
  1327
  1329		  EXEC CICS WRITE
  1330                 FILE('uaf001')
  1331		       FROM(WS-USER-REC)
  1332		       RIDFLD(WS-USERID)
  1333		  END-EXEC
  1362
  1363	     *	  Will display error message if user id already in records
  1364		  EVALUATE TRUE
  1365		   WHEN EIBRESP = +14
  1366                  STRING 'USER ID ALREADY EXIST' DELIMITED BY SIZE
  1367                    ', USER NOT CREATED.' DELIMITED BY SIZE
  1368                    'PRESS ENTER TO INPUT AGAIN.' DELIMITED BY SIZE
  1369			   INTO ERRMSG8O
  1370			END-STRING
  1371			MOVE 3 TO WS-STATE
  1372			PERFORM 330-SET-UNPROTECTED
  1373		   WHEN EIBRESP = +0
  1374			MOVE 3 TO WS-STATE
  1375		   WHEN OTHER
  1376                  MOVE 'USER NOT ADDED' TO ERRMSG8O
  1377		  END-EVALUATE.
  1378
  1379	      400-EXIT.
  1380		  EXIT.
  1381CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\UA002.cic	       PAGE   18



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    1392
			Compilation time (mm:ss.ss):  0:00.05
			Compilation speed (lines/minute): 70400

			Compilation date (yy/mm/dd): 23/12/06
			     Time of day (hh:mm:ss): 22:23:55