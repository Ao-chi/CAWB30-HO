     5	     *CBL XOPTS(COBOL2)
    20	      IDENTIFICATION DIVISION.
    21	      PROGRAM-ID. UA001.
    22
    23	      ENVIRONMENT DIVISION.
    24	      CONFIGURATION SECTION.
    25	      SOURCE-COMPUTER.	  IBM-PC.
    26	      OBJECT-COMPUTER.	  IBM-PC.
    27
    28	      DATA DIVISION.
    29	      WORKING-STORAGE SECTION.
    75        01  WS-CURRENT-MAP  VALUE 'UA001M'         PIC X(7).
    76	      01  WS-TIME				PIC 9(15).
    77	      01  WS-DATE				PIC 9(7).
    78	      01  WS-DATE-X REDEFINES WS-DATE		PIC X(7).
    79	      01  WS-LENGTH				PIC S9(4) COMP.
    80
    81
    82        01  WS-END                 PIC X(15) VALUE 'INVALID ACCESS'.
    83        01  WS-INVALID-USER         pic x(5) value 'block'.
    84	      77  WS-RETNCODE		  PIC S9(8) COMP.
    85
    86	     *NEW STORAGE
    87	      01  WS-IDD		 PIC X(08).
    88	      01  WS-RECB-LENGTH	 PIC S9(4) COMP VALUE +20.
    89	      01  WS-INDX		 PIC 9(02).
    90	      01  WS-RID.
    91		  05 WS-RID7		  PIC X(07) VALUE LOW-VALUES.
    92		  05 FILLER REDEFINES WS-RID7.
    93		     10 FILLER			PIC X(04).
    94		     10 WS-RID3 		PIC 9(03).
    95		  05 WS-RID1			PIC X(01) VALUE HIGH-VALUES.
    96
    97	      01  WS-REMAINDER		 PIC 9(01).
    98	      01  WS-FIRSTPAGE		 PIC X(01).
    99	      01  WS-PAGEDIFF		 PIC 9(02).
   100	      01  WS-TEST		 PIC X(07).
   101	      01  WS-SUB-HOLDER 	 PIC 9(02).
   102	      01  WS-PAGE-I		 PIC 9(02).
   103	      01  WS-PAGEI REDEFINES WS-PAGE-I PIC X(02).
   104
   105	      01  WS-REC.
   106		 05  WS-UID.
   107		      10 FILLER 	      PIC X(04).
   108		      10 WS-UID2	      PIC 9(03).
   109		      10 FILLER 	      PIC X.
   110		 05  WS-UID-REDEF REDEFINES WS-UID.
   111		      10  WS-USERID7	  PIC X(7).
   112		      10  FILLER	  PIC X(1).
   113		 05  WS-REQ		 PIC X(01).
   114		 05  WS-ADMN		 PIC X(01).
   115		 05  WS-APP		 PIC X(01).
   116		 05  WS-SP		 PIC X(01).
   117		 05  WS-UPBY		 PIC X(08).
   118
   119	     *GALING SA COMMAREA
   120       *01  W-ID              PIC X(07) VALUE 'ISCB124'.
   121
   122        01  WS-AADMIN          PIC X(01) VALUE 'Y'.
   123   124
   125	      COPY UA001S.
   127	     * SYMBOLIC MAP of UA001S Created by CACXBMS Version 6.0.27
   128	      01  UA001MI.
   129		  02  FILLER				     PIC X(12).
   130		  02  DATEL				     PIC S9(4) COMP.
   131		  02  DATEF				     PIC X.
   132		  02  FILLER REDEFINES DATEF.
   133		      03  DATEA 			     PIC X.
   134		  02  DATEI				     PIC X(010).
   135		  02  PAGEL				     PIC S9(4) COMP.
   136		  02  PAGEF				     PIC X.
   137		  02  FILLER REDEFINES PAGEF.
   138		      03  PAGEA 			     PIC X.
   139		  02  PAGEI				     PIC X(002).
   140		  02  TIMEL				     PIC S9(4) COMP.
   141		  02  TIMEF				     PIC X.
   142		  02  FILLER REDEFINES TIMEF.
   143		      03  TIMEA 			     PIC X.
   144		  02  TIMEI				     PIC X(008).
   145		  02  USERIDL				     PIC S9(4) COMP.
   146		  02  USERIDF				     PIC X.
   147		  02  FILLER REDEFINES USERIDF.
   148		      03  USERIDA			     PIC X.
   149		  02  USERIDI				     PIC X(008).
   150		  02  UD1L				     PIC S9(4) COMP.
   151		  02  UD1F				     PIC X.
   152		  02  FILLER REDEFINES UD1F.
   153		      03  UD1A				     PIC X.
   154		  02  UD1I				     PIC X(001).
   155		  02  UD2L				     PIC S9(4) COMP.
   156		  02  UD2F				     PIC X.
   157		  02  FILLER REDEFINES UD2F.
   158		      03  UD2A				     PIC X.
   159		  02  UD2I				     PIC X(001).
   160		  02  UD3L				     PIC S9(4) COMP.
   161		  02  UD3F				     PIC X.
   162		  02  FILLER REDEFINES UD3F.
   163		      03  UD3A				     PIC X.
   164		  02  UD3I				     PIC X(001).
   165		  02  UD4L				     PIC S9(4) COMP.
   166		  02  UD4F				     PIC X.
   167		  02  FILLER REDEFINES UD4F.
   168		      03  UD4A				     PIC X.
   169		  02  UD4I				     PIC X(001).
   170		  02  UD5L				     PIC S9(4) COMP.
   171		  02  UD5F				     PIC X.
   172		  02  FILLER REDEFINES UD5F.
   173		      03  UD5A				     PIC X.
   174		  02  UD5I				     PIC X(001).
   175		  02  UD6L				     PIC S9(4) COMP.
   176		  02  UD6F				     PIC X.
   177		  02  FILLER REDEFINES UD6F.
   178		      03  UD6A				     PIC X.
   179		  02  UD6I				     PIC X(001).
   180		  02  UD7L				     PIC S9(4) COMP.
   181		  02  UD7F				     PIC X.
   182		  02  FILLER REDEFINES UD7F.
   183		      03  UD7A				     PIC X.
   184		  02  UD7I				     PIC X(001).   185		  02  UD8L				     PIC S9(4) COMP.
   186		  02  UD8F				     PIC X.
   187		  02  FILLER REDEFINES UD8F.
   188		      03  UD8A				     PIC X.
   189		  02  UD8I				     PIC X(001).
   190		  02  UD9L				     PIC S9(4) COMP.
   191		  02  UD9F				     PIC X.
   192		  02  FILLER REDEFINES UD9F.
   193		      03  UD9A				     PIC X.
   194		  02  UD9I				     PIC X(001).
   195		  02  UD10L				     PIC S9(4) COMP.
   196		  02  UD10F				     PIC X.
   197		  02  FILLER REDEFINES UD10F.
   198		      03  UD10A 			     PIC X.
   199		  02  UD10I				     PIC X(001).
   200		  02  UD11L				     PIC S9(4) COMP.
   201		  02  UD11F				     PIC X.
   202		  02  FILLER REDEFINES UD11F.
   203		      03  UD11A 			     PIC X.
   204		  02  UD11I				     PIC X(001).
   205		  02  UID1L				     PIC S9(4) COMP.
   206		  02  UID1F				     PIC X.
   207		  02  FILLER REDEFINES UID1F.
   208		      03  UID1A 			     PIC X.
   209		  02  UID1I				     PIC X(008).
   210		  02  UID2L				     PIC S9(4) COMP.
   211		  02  UID2F				     PIC X.
   212		  02  FILLER REDEFINES UID2F.
   213		      03  UID2A 			     PIC X.
   214		  02  UID2I				     PIC X(008).
   215		  02  UID3L				     PIC S9(4) COMP.
   216		  02  UID3F				     PIC X.
   217		  02  FILLER REDEFINES UID3F.
   218		      03  UID3A 			     PIC X.
   219		  02  UID3I				     PIC X(008).
   220		  02  UID4L				     PIC S9(4) COMP.
   221		  02  UID4F				     PIC X.
   222		  02  FILLER REDEFINES UID4F.
   223		      03  UID4A 			     PIC X.
   224		  02  UID4I				     PIC X(008).
   225		  02  UID5L				     PIC S9(4) COMP.
   226		  02  UID5F				     PIC X.
   227		  02  FILLER REDEFINES UID5F.
   228		      03  UID5A 			     PIC X.
   229		  02  UID5I				     PIC X(008).
   230		  02  UID6L				     PIC S9(4) COMP.
   231		  02  UID6F				     PIC X.
   232		  02  FILLER REDEFINES UID6F.
   233		      03  UID6A 			     PIC X.
   234		  02  UID6I				     PIC X(008).
   235		  02  UID7L				     PIC S9(4) COMP.
   236		  02  UID7F				     PIC X.
   237		  02  FILLER REDEFINES UID7F.
   238		      03  UID7A 			     PIC X.
   239		  02  UID7I				     PIC X(008).
   240		  02  UID8L				     PIC S9(4) COMP.
   241		  02  UID8F				     PIC X.
   242		  02  FILLER REDEFINES UID8F.
   243		      03  UID8A 			     PIC X.
   244		  02  UID8I				     PIC X(008).   245		  02  UID9L				     PIC S9(4) COMP.
   246		  02  UID9F				     PIC X.
   247		  02  FILLER REDEFINES UID9F.
   248		      03  UID9A 			     PIC X.
   249		  02  UID9I				     PIC X(008).
   250		  02  UID10L				     PIC S9(4) COMP.
   251		  02  UID10F				     PIC X.
   252		  02  FILLER REDEFINES UID10F.
   253		      03  UID10A			     PIC X.
   254		  02  UID10I				     PIC X(008).
   255		  02  UID11L				     PIC S9(4) COMP.
   256		  02  UID11F				     PIC X.
   257		  02  FILLER REDEFINES UID11F.
   258		      03  UID11A			     PIC X.
   259		  02  UID11I				     PIC X(008).
   260		  02  REQ1L				     PIC S9(4) COMP.
   261		  02  REQ1F				     PIC X.
   262		  02  FILLER REDEFINES REQ1F.
   263		      03  REQ1A 			     PIC X.
   264		  02  REQ1I				     PIC X(001).
   265		  02  REQ2L				     PIC S9(4) COMP.
   266		  02  REQ2F				     PIC X.
   267		  02  FILLER REDEFINES REQ2F.
   268		      03  REQ2A 			     PIC X.
   269		  02  REQ2I				     PIC X(001).
   270		  02  REQ3L				     PIC S9(4) COMP.
   271		  02  REQ3F				     PIC X.
   272		  02  FILLER REDEFINES REQ3F.
   273		      03  REQ3A 			     PIC X.
   274		  02  REQ3I				     PIC X(001).
   275		  02  REQ4L				     PIC S9(4) COMP.
   276		  02  REQ4F				     PIC X.
   277		  02  FILLER REDEFINES REQ4F.
   278		      03  REQ4A 			     PIC X.
   279		  02  REQ4I				     PIC X(001).
   280		  02  REQ5L				     PIC S9(4) COMP.
   281		  02  REQ5F				     PIC X.
   282		  02  FILLER REDEFINES REQ5F.
   283		      03  REQ5A 			     PIC X.
   284		  02  REQ5I				     PIC X(001).
   285		  02  REQ6L				     PIC S9(4) COMP.
   286		  02  REQ6F				     PIC X.
   287		  02  FILLER REDEFINES REQ6F.
   288		      03  REQ6A 			     PIC X.
   289		  02  REQ6I				     PIC X(001).
   290		  02  REQ7L				     PIC S9(4) COMP.
   291		  02  REQ7F				     PIC X.
   292		  02  FILLER REDEFINES REQ7F.
   293		      03  REQ7A 			     PIC X.
   294		  02  REQ7I				     PIC X(001).
   295		  02  REQ8L				     PIC S9(4) COMP.
   296		  02  REQ8F				     PIC X.
   297		  02  FILLER REDEFINES REQ8F.
   298		      03  REQ8A 			     PIC X.
   299		  02  REQ8I				     PIC X(001).
   300		  02  REQ9L				     PIC S9(4) COMP.
   301		  02  REQ9F				     PIC X.
   302		  02  FILLER REDEFINES REQ9F.
   303		      03  REQ9A 			     PIC X.
   304		  02  REQ9I				     PIC X(001).   305		  02  REQ10L				     PIC S9(4) COMP.
   306		  02  REQ10F				     PIC X.
   307		  02  FILLER REDEFINES REQ10F.
   308		      03  REQ10A			     PIC X.
   309		  02  REQ10I				     PIC X(001).
   310		  02  REQ11L				     PIC S9(4) COMP.
   311		  02  REQ11F				     PIC X.
   312		  02  FILLER REDEFINES REQ11F.
   313		      03  REQ11A			     PIC X.
   314		  02  REQ11I				     PIC X(001).
   315		  02  ADMN1L				     PIC S9(4) COMP.
   316		  02  ADMN1F				     PIC X.
   317		  02  FILLER REDEFINES ADMN1F.
   318		      03  ADMN1A			     PIC X.
   319		  02  ADMN1I				     PIC X(001).
   320		  02  ADMN2L				     PIC S9(4) COMP.
   321		  02  ADMN2F				     PIC X.
   322		  02  FILLER REDEFINES ADMN2F.
   323		      03  ADMN2A			     PIC X.
   324		  02  ADMN2I				     PIC X(001).
   325		  02  ADMN3L				     PIC S9(4) COMP.
   326		  02  ADMN3F				     PIC X.
   327		  02  FILLER REDEFINES ADMN3F.
   328		      03  ADMN3A			     PIC X.
   329		  02  ADMN3I				     PIC X(001).
   330		  02  ADMN4L				     PIC S9(4) COMP.
   331		  02  ADMN4F				     PIC X.
   332		  02  FILLER REDEFINES ADMN4F.
   333		      03  ADMN4A			     PIC X.
   334		  02  ADMN4I				     PIC X(001).
   335		  02  ADMN5L				     PIC S9(4) COMP.
   336		  02  ADMN5F				     PIC X.
   337		  02  FILLER REDEFINES ADMN5F.
   338		      03  ADMN5A			     PIC X.
   339		  02  ADMN5I				     PIC X(001).
   340		  02  ADMN6L				     PIC S9(4) COMP.
   341		  02  ADMN6F				     PIC X.
   342		  02  FILLER REDEFINES ADMN6F.
   343		      03  ADMN6A			     PIC X.
   344		  02  ADMN6I				     PIC X(001).
   345		  02  ADMN7L				     PIC S9(4) COMP.
   346		  02  ADMN7F				     PIC X.
   347		  02  FILLER REDEFINES ADMN7F.
   348		      03  ADMN7A			     PIC X.
   349		  02  ADMN7I				     PIC X(001).
   350		  02  ADMN8L				     PIC S9(4) COMP.
   351		  02  ADMN8F				     PIC X.
   352		  02  FILLER REDEFINES ADMN8F.
   353		      03  ADMN8A			     PIC X.
   354		  02  ADMN8I				     PIC X(001).
   355		  02  ADMN9L				     PIC S9(4) COMP.
   356		  02  ADMN9F				     PIC X.
   357		  02  FILLER REDEFINES ADMN9F.
   358		      03  ADMN9A			     PIC X.
   359		  02  ADMN9I				     PIC X(001).
   360		  02  ADMN10L				     PIC S9(4) COMP.
   361		  02  ADMN10F				     PIC X.
   362		  02  FILLER REDEFINES ADMN10F.
   363		      03  ADMN10A			     PIC X.
   364		  02  ADMN10I				     PIC X(001).   365		  02  ADMN11L				     PIC S9(4) COMP.
   366		  02  ADMN11F				     PIC X.
   367		  02  FILLER REDEFINES ADMN11F.
   368		      03  ADMN11A			     PIC X.
   369		  02  ADMN11I				     PIC X(001).
   370		  02  APP1L				     PIC S9(4) COMP.
   371		  02  APP1F				     PIC X.
   372		  02  FILLER REDEFINES APP1F.
   373		      03  APP1A 			     PIC X.
   374		  02  APP1I				     PIC X(001).
   375		  02  APP2L				     PIC S9(4) COMP.
   376		  02  APP2F				     PIC X.
   377		  02  FILLER REDEFINES APP2F.
   378		      03  APP2A 			     PIC X.
   379		  02  APP2I				     PIC X(001).
   380		  02  APP3L				     PIC S9(4) COMP.
   381		  02  APP3F				     PIC X.
   382		  02  FILLER REDEFINES APP3F.
   383		      03  APP3A 			     PIC X.
   384		  02  APP3I				     PIC X(001).
   385		  02  APP4L				     PIC S9(4) COMP.
   386		  02  APP4F				     PIC X.
   387		  02  FILLER REDEFINES APP4F.
   388		      03  APP4A 			     PIC X.
   389		  02  APP4I				     PIC X(001).
   390		  02  APP5L				     PIC S9(4) COMP.
   391		  02  APP5F				     PIC X.
   392		  02  FILLER REDEFINES APP5F.
   393		      03  APP5A 			     PIC X.
   394		  02  APP5I				     PIC X(001).
   395		  02  APP6L				     PIC S9(4) COMP.
   396		  02  APP6F				     PIC X.
   397		  02  FILLER REDEFINES APP6F.
   398		      03  APP6A 			     PIC X.
   399		  02  APP6I				     PIC X(001).
   400		  02  APP7L				     PIC S9(4) COMP.
   401		  02  APP7F				     PIC X.
   402		  02  FILLER REDEFINES APP7F.
   403		      03  APP7A 			     PIC X.
   404		  02  APP7I				     PIC X(001).
   405		  02  APP8L				     PIC S9(4) COMP.
   406		  02  APP8F				     PIC X.
   407		  02  FILLER REDEFINES APP8F.
   408		      03  APP8A 			     PIC X.
   409		  02  APP8I				     PIC X(001).
   410		  02  APP9L				     PIC S9(4) COMP.
   411		  02  APP9F				     PIC X.
   412		  02  FILLER REDEFINES APP9F.
   413		      03  APP9A 			     PIC X.
   414		  02  APP9I				     PIC X(001).
   415		  02  APP10L				     PIC S9(4) COMP.
   416		  02  APP10F				     PIC X.
   417		  02  FILLER REDEFINES APP10F.
   418		      03  APP10A			     PIC X.
   419		  02  APP10I				     PIC X(001).
   420		  02  APP11L				     PIC S9(4) COMP.
   421		  02  APP11F				     PIC X.
   422		  02  FILLER REDEFINES APP11F.
   423		      03  APP11A			     PIC X.
   424		  02  APP11I				     PIC X(001).   425		  02  SP1L				     PIC S9(4) COMP.
   426		  02  SP1F				     PIC X.
   427		  02  FILLER REDEFINES SP1F.
   428		      03  SP1A				     PIC X.
   429		  02  SP1I				     PIC X(001).
   430		  02  SP2L				     PIC S9(4) COMP.
   431		  02  SP2F				     PIC X.
   432		  02  FILLER REDEFINES SP2F.
   433		      03  SP2A				     PIC X.
   434		  02  SP2I				     PIC X(001).
   435		  02  SP3L				     PIC S9(4) COMP.
   436		  02  SP3F				     PIC X.
   437		  02  FILLER REDEFINES SP3F.
   438		      03  SP3A				     PIC X.
   439		  02  SP3I				     PIC X(001).
   440		  02  SP4L				     PIC S9(4) COMP.
   441		  02  SP4F				     PIC X.
   442		  02  FILLER REDEFINES SP4F.
   443		      03  SP4A				     PIC X.
   444		  02  SP4I				     PIC X(001).
   445		  02  SP5L				     PIC S9(4) COMP.
   446		  02  SP5F				     PIC X.
   447		  02  FILLER REDEFINES SP5F.
   448		      03  SP5A				     PIC X.
   449		  02  SP5I				     PIC X(001).
   450		  02  SP6L				     PIC S9(4) COMP.
   451		  02  SP6F				     PIC X.
   452		  02  FILLER REDEFINES SP6F.
   453		      03  SP6A				     PIC X.
   454		  02  SP6I				     PIC X(001).
   455		  02  SP7L				     PIC S9(4) COMP.
   456		  02  SP7F				     PIC X.
   457		  02  FILLER REDEFINES SP7F.
   458		      03  SP7A				     PIC X.
   459		  02  SP7I				     PIC X(001).
   460		  02  SP8L				     PIC S9(4) COMP.
   461		  02  SP8F				     PIC X.
   462		  02  FILLER REDEFINES SP8F.
   463		      03  SP8A				     PIC X.
   464		  02  SP8I				     PIC X(001).
   465		  02  SP9L				     PIC S9(4) COMP.
   466		  02  SP9F				     PIC X.
   467		  02  FILLER REDEFINES SP9F.
   468		      03  SP9A				     PIC X.
   469		  02  SP9I				     PIC X(001).
   470		  02  SP10L				     PIC S9(4) COMP.
   471		  02  SP10F				     PIC X.
   472		  02  FILLER REDEFINES SP10F.
   473		      03  SP10A 			     PIC X.
   474		  02  SP10I				     PIC X(001).
   475		  02  SP11L				     PIC S9(4) COMP.
   476		  02  SP11F				     PIC X.
   477		  02  FILLER REDEFINES SP11F.
   478		      03  SP11A 			     PIC X.
   479		  02  SP11I				     PIC X(001).
   480		  02  MSGL				     PIC S9(4) COMP.
   481		  02  MSGF				     PIC X.
   482		  02  FILLER REDEFINES MSGF.
   483		      03  MSGA				     PIC X.
   484		  02  MSGI				     PIC X(060).   485		  02  ADDL				     PIC S9(4) COMP.
   486		  02  ADDF				     PIC X.
   487		  02  FILLER REDEFINES ADDF.
   488		      03  ADDA				     PIC X.
   489		  02  ADDI				     PIC X(009).
   490		  02  EXITL				     PIC S9(4) COMP.
   491		  02  EXITF				     PIC X.
   492		  02  FILLER REDEFINES EXITF.
   493		      03  EXITA 			     PIC X.
   494		  02  EXITI				     PIC X(010).
   495		  02  FINDL				     PIC S9(4) COMP.
   496		  02  FINDF				     PIC X.
   497		  02  FILLER REDEFINES FINDF.
   498		      03  FINDA 			     PIC X.
   499		  02  FINDI				     PIC X(010).
   500		  02  UPL				     PIC S9(4) COMP.
   501		  02  UPF				     PIC X.
   502		  02  FILLER REDEFINES UPF.
   503		      03  UPA				     PIC X.
   504		  02  UPI				     PIC X(008).
   505		  02  DOWNL				     PIC S9(4) COMP.
   506		  02  DOWNF				     PIC X.
   507		  02  FILLER REDEFINES DOWNF.
   508		      03  DOWNA 			     PIC X.
   509		  02  DOWNI				     PIC X(010).
   510		  02  RESETL				     PIC S9(4) COMP.
   511		  02  RESETF				     PIC X.
   512		  02  FILLER REDEFINES RESETF.
   513		      03  RESETA			     PIC X.
   514		  02  RESETI				     PIC X(012).
   515	      01  UA001MO REDEFINES UA001MI.
   516		  02  FILLER				     PIC X(12).
   517		  02  FILLER				     PIC XX.
   518		  02  FILLER				     PIC X.
   519		  02  DATEO				     PIC X(010).
   520		  02  FILLER				     PIC XX.
   521		  02  FILLER				     PIC X.
   522		  02  PAGEO				     PIC X(002).
   523		  02  FILLER				     PIC XX.
   524		  02  FILLER				     PIC X.
   525		  02  TIMEO				     PIC X(008).
   526		  02  FILLER				     PIC XX.
   527		  02  FILLER				     PIC X.
   528		  02  USERIDO				     PIC X(008).
   529		  02  FILLER				     PIC XX.
   530		  02  FILLER				     PIC X.
   531		  02  UD1O				     PIC X(001).
   532		  02  FILLER				     PIC XX.
   533		  02  FILLER				     PIC X.
   534		  02  UD2O				     PIC X(001).
   535		  02  FILLER				     PIC XX.
   536		  02  FILLER				     PIC X.
   537		  02  UD3O				     PIC X(001).
   538		  02  FILLER				     PIC XX.
   539		  02  FILLER				     PIC X.
   540		  02  UD4O				     PIC X(001).
   541		  02  FILLER				     PIC XX.
   542		  02  FILLER				     PIC X.
   543		  02  UD5O				     PIC X(001).
   544		  02  FILLER				     PIC XX.   545		  02  FILLER				     PIC X.
   546		  02  UD6O				     PIC X(001).
   547		  02  FILLER				     PIC XX.
   548		  02  FILLER				     PIC X.
   549		  02  UD7O				     PIC X(001).
   550		  02  FILLER				     PIC XX.
   551		  02  FILLER				     PIC X.
   552		  02  UD8O				     PIC X(001).
   553		  02  FILLER				     PIC XX.
   554		  02  FILLER				     PIC X.
   555		  02  UD9O				     PIC X(001).
   556		  02  FILLER				     PIC XX.
   557		  02  FILLER				     PIC X.
   558		  02  UD10O				     PIC X(001).
   559		  02  FILLER				     PIC XX.
   560		  02  FILLER				     PIC X.
   561		  02  UD11O				     PIC X(001).
   562		  02  FILLER				     PIC XX.
   563		  02  FILLER				     PIC X.
   564		  02  UID1O				     PIC X(008).
   565		  02  FILLER				     PIC XX.
   566		  02  FILLER				     PIC X.
   567		  02  UID2O				     PIC X(008).
   568		  02  FILLER				     PIC XX.
   569		  02  FILLER				     PIC X.
   570		  02  UID3O				     PIC X(008).
   571		  02  FILLER				     PIC XX.
   572		  02  FILLER				     PIC X.
   573		  02  UID4O				     PIC X(008).
   574		  02  FILLER				     PIC XX.
   575		  02  FILLER				     PIC X.
   576		  02  UID5O				     PIC X(008).
   577		  02  FILLER				     PIC XX.
   578		  02  FILLER				     PIC X.
   579		  02  UID6O				     PIC X(008).
   580		  02  FILLER				     PIC XX.
   581		  02  FILLER				     PIC X.
   582		  02  UID7O				     PIC X(008).
   583		  02  FILLER				     PIC XX.
   584		  02  FILLER				     PIC X.
   585		  02  UID8O				     PIC X(008).
   586		  02  FILLER				     PIC XX.
   587		  02  FILLER				     PIC X.
   588		  02  UID9O				     PIC X(008).
   589		  02  FILLER				     PIC XX.
   590		  02  FILLER				     PIC X.
   591		  02  UID10O				     PIC X(008).
   592		  02  FILLER				     PIC XX.
   593		  02  FILLER				     PIC X.
   594		  02  UID11O				     PIC X(008).
   595		  02  FILLER				     PIC XX.
   596		  02  FILLER				     PIC X.
   597		  02  REQ1O				     PIC X(001).
   598		  02  FILLER				     PIC XX.
   599		  02  FILLER				     PIC X.
   600		  02  REQ2O				     PIC X(001).
   601		  02  FILLER				     PIC XX.
   602		  02  FILLER				     PIC X.
   603		  02  REQ3O				     PIC X(001).
   604		  02  FILLER				     PIC XX.   605		  02  FILLER				     PIC X.
   606		  02  REQ4O				     PIC X(001).
   607		  02  FILLER				     PIC XX.
   608		  02  FILLER				     PIC X.
   609		  02  REQ5O				     PIC X(001).
   610		  02  FILLER				     PIC XX.
   611		  02  FILLER				     PIC X.
   612		  02  REQ6O				     PIC X(001).
   613		  02  FILLER				     PIC XX.
   614		  02  FILLER				     PIC X.
   615		  02  REQ7O				     PIC X(001).
   616		  02  FILLER				     PIC XX.
   617		  02  FILLER				     PIC X.
   618		  02  REQ8O				     PIC X(001).
   619		  02  FILLER				     PIC XX.
   620		  02  FILLER				     PIC X.
   621		  02  REQ9O				     PIC X(001).
   622		  02  FILLER				     PIC XX.
   623		  02  FILLER				     PIC X.
   624		  02  REQ10O				     PIC X(001).
   625		  02  FILLER				     PIC XX.
   626		  02  FILLER				     PIC X.
   627		  02  REQ11O				     PIC X(001).
   628		  02  FILLER				     PIC XX.
   629		  02  FILLER				     PIC X.
   630		  02  ADMN1O				     PIC X(001).
   631		  02  FILLER				     PIC XX.
   632		  02  FILLER				     PIC X.
   633		  02  ADMN2O				     PIC X(001).
   634		  02  FILLER				     PIC XX.
   635		  02  FILLER				     PIC X.
   636		  02  ADMN3O				     PIC X(001).
   637		  02  FILLER				     PIC XX.
   638		  02  FILLER				     PIC X.
   639		  02  ADMN4O				     PIC X(001).
   640		  02  FILLER				     PIC XX.
   641		  02  FILLER				     PIC X.
   642		  02  ADMN5O				     PIC X(001).
   643		  02  FILLER				     PIC XX.
   644		  02  FILLER				     PIC X.
   645		  02  ADMN6O				     PIC X(001).
   646		  02  FILLER				     PIC XX.
   647		  02  FILLER				     PIC X.
   648		  02  ADMN7O				     PIC X(001).
   649		  02  FILLER				     PIC XX.
   650		  02  FILLER				     PIC X.
   651		  02  ADMN8O				     PIC X(001).
   652		  02  FILLER				     PIC XX.
   653		  02  FILLER				     PIC X.
   654		  02  ADMN9O				     PIC X(001).
   655		  02  FILLER				     PIC XX.
   656		  02  FILLER				     PIC X.
   657		  02  ADMN10O				     PIC X(001).
   658		  02  FILLER				     PIC XX.
   659		  02  FILLER				     PIC X.
   660		  02  ADMN11O				     PIC X(001).
   661		  02  FILLER				     PIC XX.
   662		  02  FILLER				     PIC X.
   663		  02  APP1O				     PIC X(001).
   664		  02  FILLER				     PIC XX.   665		  02  FILLER				     PIC X.
   666		  02  APP2O				     PIC X(001).
   667		  02  FILLER				     PIC XX.
   668		  02  FILLER				     PIC X.
   669		  02  APP3O				     PIC X(001).
   670		  02  FILLER				     PIC XX.
   671		  02  FILLER				     PIC X.
   672		  02  APP4O				     PIC X(001).
   673		  02  FILLER				     PIC XX.
   674		  02  FILLER				     PIC X.
   675		  02  APP5O				     PIC X(001).
   676		  02  FILLER				     PIC XX.
   677		  02  FILLER				     PIC X.
   678		  02  APP6O				     PIC X(001).
   679		  02  FILLER				     PIC XX.
   680		  02  FILLER				     PIC X.
   681		  02  APP7O				     PIC X(001).
   682		  02  FILLER				     PIC XX.
   683		  02  FILLER				     PIC X.
   684		  02  APP8O				     PIC X(001).
   685		  02  FILLER				     PIC XX.
   686		  02  FILLER				     PIC X.
   687		  02  APP9O				     PIC X(001).
   688		  02  FILLER				     PIC XX.
   689		  02  FILLER				     PIC X.
   690		  02  APP10O				     PIC X(001).
   691		  02  FILLER				     PIC XX.
   692		  02  FILLER				     PIC X.
   693		  02  APP11O				     PIC X(001).
   694		  02  FILLER				     PIC XX.
   695		  02  FILLER				     PIC X.
   696		  02  SP1O				     PIC X(001).
   697		  02  FILLER				     PIC XX.
   698		  02  FILLER				     PIC X.
   699		  02  SP2O				     PIC X(001).
   700		  02  FILLER				     PIC XX.
   701		  02  FILLER				     PIC X.
   702		  02  SP3O				     PIC X(001).
   703		  02  FILLER				     PIC XX.
   704		  02  FILLER				     PIC X.
   705		  02  SP4O				     PIC X(001).
   706		  02  FILLER				     PIC XX.
   707		  02  FILLER				     PIC X.
   708		  02  SP5O				     PIC X(001).
   709		  02  FILLER				     PIC XX.
   710		  02  FILLER				     PIC X.
   711		  02  SP6O				     PIC X(001).
   712		  02  FILLER				     PIC XX.
   713		  02  FILLER				     PIC X.
   714		  02  SP7O				     PIC X(001).
   715		  02  FILLER				     PIC XX.
   716		  02  FILLER				     PIC X.
   717		  02  SP8O				     PIC X(001).
   718		  02  FILLER				     PIC XX.
   719		  02  FILLER				     PIC X.
   720		  02  SP9O				     PIC X(001).
   721		  02  FILLER				     PIC XX.
   722		  02  FILLER				     PIC X.
   723		  02  SP10O				     PIC X(001).
   724		  02  FILLER				     PIC XX.   725		  02  FILLER				     PIC X.
   726		  02  SP11O				     PIC X(001).
   727		  02  FILLER				     PIC XX.
   728		  02  FILLER				     PIC X.
   729		  02  MSGO				     PIC X(060).
   730		  02  FILLER				     PIC XX.
   731		  02  FILLER				     PIC X.
   732		  02  ADDO				     PIC X(009).
   733		  02  FILLER				     PIC XX.
   734		  02  FILLER				     PIC X.
   735		  02  EXITO				     PIC X(010).
   736		  02  FILLER				     PIC XX.
   737		  02  FILLER				     PIC X.
   738		  02  FINDO				     PIC X(010).
   739		  02  FILLER				     PIC XX.
   740		  02  FILLER				     PIC X.
   741		  02  UPO				     PIC X(008).
   742		  02  FILLER				     PIC XX.
   743		  02  FILLER				     PIC X.
   744		  02  DOWNO				     PIC X(010).
   745		  02  FILLER				     PIC XX.
   746		  02  FILLER				     PIC X.
   747		  02  RESETO				     PIC X(012).
   749
   750	       01  WS-UA001 REDEFINES UA001MI.
   751		  05  FILLER		      PIC X(52).
   752		  05  UD  OCCURS 11.
   753		      10  UDL		      PIC S9(4) COMP.
   754		      10  UDF		      PIC X.
   755		      10  FILLER REDEFINES UDF.
   756			  15  UDA	      PIC X.
   757		      10  UDI		      PIC X(001).
   758		  05  UID     OCCURS 11.
   759		      10  UIDL		      PIC S9(4) COMP.
   760		      10  UIDF		      PIC X.
   761		      10  FILLER REDEFINES UIDF.
   762			  15  UIDA	      PIC X.
   763		      10  UIDI.
   764			  15 FILLER	      PIC X(04).
   765			  15 WS-USERNUM       PIC 9(03).
   766			  15 FILLER	      PIC X.
   767		  05  REQ     OCCURS 11.
   768		      10  REQL		      PIC S9(4) COMP.
   769		      10  REQF		      PIC X.
   770		      10  FILLER REDEFINES REQF.
   771			  15 REQA	      PIC X.
   772		      10  REQI		      PIC X(001).
   773		  05  ADMN	OCCURS 11.
   774		      10  ADMNL 	      PIC S9(4) COMP.
   775		      10  ADMNF 	      PIC X.
   776		      10  FILLER REDEFINES ADMNF.
   777			  15  ADMNA	      PIC X.
   778		      10  ADMNI 	      PIC X(001).
   779		  05  APP     OCCURS 11.
   780		      10  APPL		      PIC S9(4) COMP.
   781		      10  APPF		      PIC X.
   782		      10  FILLER REDEFINES APPF.
   783			  15  APPA	      PIC X.
   784		      10  APPI		      PIC X(001).
   785		  05  SP	  OCCURS 11.   786		      10  SPL		      PIC S9(4) COMP.
   787		      10  SPF		      PIC X.
   788		      10  FILLER REDEFINES SPF.
   789			  15  SPA	      PIC X.
   790		      10  SPI		      PIC X(001).
   791
   792
   793	      COPY DFHAID.
   795	      01  DFHAID.
   796	     *
   797	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   798	     *
   799	     * Revision Information
   800	     * ^{File:dfhaid.cob  }
   801	     * ^{Timestamp:Thu May 15 14:02:52 1997}
   802	     * ^{Revision:2.0}
   803	     *
   804	     *This is the AID constants copy file
   805	     *
   806            05  DFHENTER                  PIC X VALUE ''''.
   807	     *					value APOST
   808            05  DFHCLEAR                  PIC X VALUE '_'.
   809            05  DFHPA1                    PIC X VALUE '%'.
   810            05  DFHPA2                    PIC X VALUE '>'.
   811            05  DFHPA3                    PIC X VALUE ','.
   812            05  DFHPF1                    PIC X VALUE '1'.
   813            05  DFHPF2                    PIC X VALUE '2'.
   814            05  DFHPF3                    PIC X VALUE '3'.
   815            05  DFHPF4                    PIC X VALUE '4'.
   816            05  DFHPF5                    PIC X VALUE '5'.
   817            05  DFHPF6                    PIC X VALUE '6'.
   818            05  DFHPF7                    PIC X VALUE '7'.
   819            05  DFHPF8                    PIC X VALUE '8'.
   820            05  DFHPF9                    PIC X VALUE '9'.
   821            05  DFHPF10                   PIC X VALUE ':'.
   822            05  DFHPF11                   PIC X VALUE '#'.
   823            05  DFHPF12                   PIC X VALUE '@'.
   824            05  DFHPF13                   PIC X VALUE 'A'.
   825            05  DFHPF14                   PIC X VALUE 'B'.
   826            05  DFHPF15                   PIC X VALUE 'C'.
   827            05  DFHPF16                   PIC X VALUE 'D'.
   828            05  DFHPF17                   PIC X VALUE 'E'.
   829            05  DFHPF18                   PIC X VALUE 'F'.
   830            05  DFHPF19                   PIC X VALUE 'G'.
   831            05  DFHPF20                   PIC X VALUE 'H'.
   832            05  DFHPF21                   PIC X VALUE 'I'.
   833            05  DFHPF22                   PIC X VALUE '›'.
   834       *                                  EBCDIC Cent sign x'4A'
   835       *                                  ASCII  Cent sign x'9B'
   836            05  DFHPF23                   PIC X VALUE '.'.
   837            05  DFHPF24                   PIC X VALUE '<'.
   838            05  DFHOPID                   PIC X VALUE 'W'.
   839            05  DFHMSRE                   PIC X VALUE 'X'.
   840            05  DFHTRIG                   PIC X VALUE '"'.
   841       *                                        value QUOTE  "
   842            05  DFHPEN                    PIC X VALUE '='.
   843            05  DFHCLRP                   PIC X VALUE 'Ý'.
   844       *                                  EBCDIC x'6A'
   845       *                                  ASCII  x'DD'
   846            05  DFHSTRF                   PIC X VALUE 'h'.   847	     *	  DFHQUIT is a CA-Realia CICS Extension
   848	     *	  It is set by using <Ctrl>+C or <Ctrl>+<Break> Keys
   849            05  DFHQUIT                   PIC X VALUE '!'.
   850		  05  DFHNULL			PIC X VALUE LOW-VALUE.
   852
   853	      COPY DFHBMSCA.
   855	      01  DFHBMSCA.
   856	     *
   857	     * CA-Realia CICS 6.0 Computer Associates International, Inc.
   858	     *
   859	     * Revision Information
   860	     * ^{File:dfhbmsca.cob}
   861	     * ^{Timestamp:Tue Oct 08 15:34:54 1996}
   862	     * ^{Revision:2.0}
   863	     *
   864	     *	Note:This FILE is provided with most values as quoted literals
   865	     *	     so that the file can be used for both ASCII and EBCDIC
   866	     *	     programs
   867	     *
   868	     *	     The only exceptions are some 3270 Data Stream Orders
   869	     *	     They use different Hexadecimal values for ASCII and
   870	     *	     EBCDIC and they cannot be expressed as quoted literals
   871	     *	     as the values are <Line Feed>, <Tab>, <End of File> etc.
   872	     *	     characters in ASCII
   873	     *
   874	     *	     They have their values set up to default to the EBCDIC
   875	     *	     values.
   876	     *
   877	     *	     3270 orders are only needed for EXEC CICS SEND and RECEIVE
   878	     *	     and SEND TEXT with imbedded format orders.
   879	     *	     If you use these values in ASCII programs the values
   880	     *	     must be changed.
   881	     *
   882	     *	     An alternative is to use REPLACING to change the values.
   883	     *
   884	     *	  i.e. COPY DFHBMSCA replacing
   885	     *			    ==005== BY ==009==	*> DFHPT
   886	     *			    ==021== BY ==010==	*> DFHNL
   887	     *			    ==040== BY ==021==	*> DFHSA
   888	     *			    ==041== BY ==031==	*> DFHSFE
   889	     *			    ==044== BY ==023==	*> DFHMF
   890	     *			    ==060== BY ==020==	*> DFHRA
   891	     *			    ==063== BY ==026==. *> DFHSUB
   892	     *
   893	     ******************************************************************
   894	     *BMS and Terminal Control - Order & Attributes constants	      *
   895	     ******************************************************************
   896	     *
   897	     *	  Field Attributes
   898	     *
   899            05  DFHBMASB                          PIC X VALUE '8'.
   900            05  DFHBMASF                          PIC X VALUE '1'.
   901            05  DFHBMASK                          PIC X VALUE '0'.
   902            05  DFHBMBRY                          PIC X VALUE 'H'.
   903            05  DFHBMDAR                          PIC X VALUE '<'.
   904            05  DFHBMFSE                          PIC X VALUE 'A'.
   905            05  DFHBMPRF                          PIC X VALUE '/'.
   906            05  DFHBMPRO                          PIC X VALUE '-'.
   907            05  DFHBMUNN                          PIC X VALUE '&'.
   908            05  DFHBMUNP                          PIC X VALUE ' '.   909            05  DFHUNNUM                          PIC X VALUE 'J'.
   910	     *
   911	     *	  partially supported
   912	     *
   913            05  DFHUNNOD                          PIC X VALUE '('.
   914            05  DFHUNIMD                          PIC X VALUE 'I'.
   915            05  DFHUNINT                          PIC X VALUE 'R'.
   916            05  DFHUNNON                          PIC X VALUE '('.
   917            05  DFHPROTI                          PIC X VALUE 'Y'.
   918            05  DFHPROTN                          PIC X VALUE '%'.
   919	     *
   920	     *	  These values are additions to mainframe constants
   921	     *
   922            05  DFHBMS-ASK-DARK                   PIC X VALUE '@'.
   923            05  DFHBMS-ASK-BRY-FSET               PIC X VALUE '9'.
   924            05  DFHBMS-ASK-DAR-FSET               PIC X VALUE ''''.
   925	     *						      VALUE APOST
   926            05  DFHBMS-PRO-BRY-FSET               PIC X VALUE 'Z'.
   927            05  DFHBMS-PRO-DAR-FSET               PIC X VALUE '_'.
   928            05  DFHBMS-NUM-BRY                    PIC X VALUE 'Q'.
   929            05  DFHBMS-NUM-DAR                    PIC X VALUE '*'.
   930            05  DFHBMS-NUM-DAR-FSET               PIC X VALUE ')'.
   931	     *
   932	     *	  Field Flag values
   933		  05  DFHBMEOF-VAL VALUE 128		PIC S9(4) COMP-4.
   934		  05  FILLER REDEFINES DFHBMEOF-VAL.
   935		      10  FILLER			PIC X.
   936		      10  DFHBMEOF			PIC X.
   937       *                                          x'80'.
   938		  05  DFHBMCUR-VAL VALUE 002		PIC S9(4) COMP-4.
   939		  05  FILLER REDEFINES DFHBMCUR-VAL.
   940		      10  FILLER			PIC X.
   941		      10  DFHBMCUR			PIC X.
   942       *                                          x'02'.
   943		  05  DFHBMMEC-VAL VALUE 130		PIC S9(4) COMP-4.
   944		  05  FILLER REDEFINES DFHBMMEC-VAL.
   945		      10  FILLER			PIC X.
   946		      10  DFHBMMEC			PIC X.
   947       *                                          x'82'.
   948       *                                          x'02'.
   949		  05  DFHBMFLG-VAL  VALUE 0		PIC S9(4) COMP-4.
   950		      88  DFHERASE			VALUES 128 130.
   951       *                                          x'80' X'82'
   952		      88  DFHCURSR			VALUES 002 130.
   953       *                                          x'02' X'82'
   954		  05  FILLER REDEFINES DFHBMFLG-VAL.
   955		      10  FILLER			PIC X.
   956		      10  DFHBMFLG			PIC X.
   957
   958		  05  DFHBMDUP-VAL VALUE 028		PIC S9(4) COMP-4.
   959		  05  FILLER REDEFINES DFHBMDUP-VAL.
   960		      10  FILLER			PIC X.
   961		      10  DFHBMDUP			PIC X.
   962       *                                              x'1C'
   963	     *
   964	     ******************************************************************
   965	     *	  supported 327X Extended Attributes
   966	     *
   967	     *	  Extended COLOR Attributes
   968	     *   969            05  DFHDFCOL                          PIC X VALUE '0'.
   970            05  DFHBLUE                           PIC X VALUE '1'.
   971            05  DFHRED                            PIC X VALUE '2'.
   972            05  DFHPINK                           PIC X VALUE '3'.
   973            05  DFHGREEN                          PIC X VALUE '4'.
   974            05  DFHTURQ                           PIC X VALUE '5'.
   975            05  DFHYELLO                          PIC X VALUE '6'.
   976            05  DFHNEUTR                          PIC X VALUE '7'.
   977	     *
   978	     *	  Extended HILIGHT Attributes
   979	     *
   980            05  DFHDFHI                           PIC X VALUE '0'.
   981            05  DFHBLINK                          PIC X VALUE '1'.
   982            05  DFHREVRS                          PIC X VALUE '2'.
   983            05  DFHUNDLN                          PIC X VALUE '4'.
   984	     *
   985	     ******************************************************************
   986	     *	  supported 327X Data Stream Orders
   987	     *
   988		  05  DFHSBA-VAL VALUE 017		 PIC S9(4) COMP-4.
   989		  05  FILLER REDEFINES DFHSBA-VAL.
   990		      10  FILLER			PIC X.
   991		      10  DFHSBA			PIC X.
   992       *                                              x'11'
   993		  05  DFHEUA-VAL VALUE 018		PIC S9(4) COMP-4.
   994		  05  FILLER REDEFINES DFHEUA-VAL.
   995		      10  FILLER			PIC X.
   996		      10  DFHEUA			PIC X.
   997       *                                              x'12'
   998		  05  DFHIC-VAL VALUE 019		PIC S9(4) COMP-4.
   999		  05  FILLER REDEFINES DFHIC-VAL.
  1000		      10  FILLER			PIC X.
  1001		      10  DFHIC 			PIC X.
  1002       *                                              X'13'.
  1003		  05  DFHSF-VAL VALUE 029		PIC S9(4) COMP-4.
  1004		  05  FILLER REDEFINES DFHSF-VAL.
  1005		      10  FILLER			PIC X.
  1006		      10  DFHSF 			PIC X.
  1007       *                                              X'1D'.
  1008		  05  DFHPT-VAL VALUE 005		PIC S9(4) COMP-4.
  1009		      88 DFHPT-VAL-EBCDIC		VALUE 5.
  1010		      88 DFHPT-VAL-ASCII		VALUE 9.
  1011		  05  FILLER REDEFINES DFHPT-VAL.
  1012		      10  FILLER			PIC X.
  1013		      10  DFHPT 			PIC X.
  1014       *                                              EBCDIC X'05'.
  1015       *                                              ASCII  X'09'.
  1016		  05  DFHRA-VAL VALUE 060		PIC S9(4) COMP-4.
  1017		      88 DFHRA-VAL-EBCDIC		VALUE 60.
  1018		      88 DFHRA-VAL-ASCII		VALUE 20.
  1019		  05  FILLER REDEFINES DFHRA-VAL.
  1020		      10  FILLER			PIC X.
  1021		      10  DFHRA 			PIC X.
  1022       *                                              EBCDIC x'3C'
  1023       *                                              ASCII  x'14'
  1024		  05  DFHSFE-VAL VALUE 041		PIC S9(4) COMP-4.
  1025		      88 DFHSFE-VAL-EBCDIC		VALUE 41.
  1026		      88 DFHSFE-VAL-ASCII		VALUE 31.
  1027		  05  FILLER REDEFINES DFHSFE-VAL.
  1028		      10  FILLER			PIC X.  1029		      10  DFHSFE			PIC X.
  1030       *                                              EBCDIC x'29'
  1031       *                                              ASCII  x'1F'
  1032		  05  DFHMF-VAL VALUE 044		PIC S9(4) COMP-4.
  1033		      88 DFHMF-VAL-EBCDIC		VALUE 44.
  1034		      88 DFHMF-VAL-ASCII		VALUE 23.
  1035		  05  FILLER REDEFINES DFHMF-VAL.
  1036		      10  FILLER			PIC X.
  1037		      10  DFHMF 			PIC X.
  1038       *                                              EBCDIC x'2C'
  1039       *                                              ASCII  x'17'
  1040	     *
  1041	     ******************************************************************
  1042	     *	  unsupported 327X Data Stream order codes
  1043	     *
  1044		  05  DFHSA-VAL VALUE 040		PIC S9(4) COMP-4.
  1045		      88 DFHSA-VAL-EBCDIC		VALUE 40.
  1046		      88 DFHSA-VAL-ASCII		VALUE 21.
  1047		  05  FILLER REDEFINES DFHSA-VAL.
  1048		      10  FILLER			PIC X.
  1049		      10  DFHSA 			PIC X.
  1050       *                                              EBCDIC x'28'
  1051       *                                              ASCII  x'15'
  1052		  05  DFHGE-VAL VALUE 008		PIC S9(4) COMP-4.
  1053		  05  FILLER REDEFINES DFHGE-VAL.
  1054		      10  FILLER			PIC X.
  1055		      10  DFHGE 			PIC X.
  1056       *                                              X'08'.
  1057	     *
  1058	     ******************************************************************
  1059	     *	  SFE and MF supported attribute types
  1060	     *
  1061            05  DFHCOLOR                          PIC X VALUE 'ƒ'.
  1062       *                                              EBCDIC x'42'
  1063       *                                              ASCII  x'83'
  1064            05  DFHHLT                            PIC X VALUE 'Ö'.
  1065       *                                              EBCDIC x'41'
  1066       *                                              ASCII  x'D6'
  1067            05  DFH3270                           PIC X VALUE '{'.
  1068	     *
  1069	     *	  supported for SEND TEXT command and printer terminal
  1070	     *
  1071		  05  DFHBMPNL-VAL VALUE 021		PIC S9(4) COMP-4.
  1072		      88 DFHBMPNL-VAL-EBCDIC		VALUE 21.
  1073		      88 DFHBMPNL-VAL-ASCII		VALUE 10.
  1074		  05  FILLER REDEFINES DFHBMPNL-VAL.
  1075		      10  FILLER			PIC X.
  1076		      10  DFHBMPNL			PIC X.
  1077       *                                              EBCDIC X'15'.
  1078       *                                              ASCII  X'0A'.
  1079	     *
  1080	     ******************************************************************
  1081	     *	  Printer terminal data stream only
  1082	     *
  1083		  05  DFHBMPFF-VAL VALUE 012		PIC S9(4) COMP-4.
  1084		  05  FILLER REDEFINES DFHBMPFF-VAL.
  1085		      10  FILLER			PIC X.
  1086		      10  DFHBMPFF			PIC X.
  1087       *                                              X'0C'.
  1088		  05  DFHBMPCR-VAL VALUE 013		PIC S9(4) COMP-4.  1089		  05  FILLER REDEFINES DFHBMPCR-VAL.
  1090		      10  FILLER			PIC X.
  1091		      10  DFHBMPCR			PIC X.
  1092       *                                              X'0D'.
  1093		  05  DFHBMPEM-VAL VALUE 025		PIC S9(4) COMP-4.
  1094		  05  FILLER REDEFINES DFHBMPEM-VAL.
  1095		      10  FILLER			PIC X.
  1096		      10  DFHBMPEM			PIC X.
  1097       *                                              X'19'.
  1098	     *
  1099	     ******************************************************************
  1100	     *	  unsupported Miscellaneous attributes and constants
  1101	     *
  1102		  05  DFHALL				PIC X VALUE LOW-VALUES.
  1103            05  DFHBASE                           PIC X VALUE '0'.
  1104		  05  DFHBMDET				PIC X VALUE LOW-VALUES.
  1105		  05  DFHBMPSOSI-VAL VALUE 3599 	PIC S9(4) COMP-4.
  1106		  05  FILLER REDEFINES DFHBMPSOSI-VAL.
  1107		      10  DFHBMPSO			PIC X.
  1108       *                                              X'0E'.
  1109		      10  DFHBMPSI			PIC X.
  1110       *                                              X'0F'.
  1111		  05  DFHDFT VALUE HIGH-VALUES		PIC X.
  1112            05  DFHERROR                          PIC X VALUE '¶'.
  1113       *                                              EBCDIC X'1A'.
  1114       *                                              ASCII  X'B6'.
  1115            05  DFHFIL                            PIC X VALUE '4'.
  1116            05  DFHMENT                           PIC X VALUE '2'.
  1117            05  DFHMET                            PIC X VALUE '3'.
  1118            05  DFHMFE                            PIC X VALUE '6'.
  1119            05  DFHMFET                           PIC X VALUE '7'.
  1120            05  DFHMFT                            PIC X VALUE '5'.
  1121            05  DFHMT                             PIC X VALUE '1'.
  1122            05  DFHOUTLN                          PIC X VALUE 'B'.
  1123            05  DFHPS                             PIC X VALUE '„'.
  1124       *                                              EBCDIC x'43'
  1125       *                                              ASCII  x'84'
  1126            05  DFHVAL                            PIC X VALUE 'A'.
  1127	     *
  1128		  05  DFHSUB-VAL   VALUE 063		PIC S9(4) COMP-4.
  1129		      88 DFHSUB-VAL-EBCDIC		VALUE 63.
  1130		      88 DFHSUB-VAL-ASCII		VALUE 26.
  1131		  05  FILLER REDEFINES DFHSUB-VAL.
  1132		      10  FILLER			PIC X.
  1133		      10  DFHSUB			PIC X.
  1134       *                                              EBCDIC X'3F'.
  1135       *                                              ASCII  X'1A'.
  1136	     *
  1137		  05  DFHFM-VAL    VALUE 030		PIC S9(4) COMP-4.
  1138		  05  FILLER REDEFINES DFHFM-VAL.
  1139		      10  FILLER			PIC X.
  1140		      10  DFHFM 			PIC X.
  1141       *                                              EBCDIC X'1E'.
  1142		  05  DFHEO VALUE HIGH-VALUE		PIC X.
  1144
  1145	      01  WS-COMMAREA.
  1146		  05 WS-PGMID				PIC X(06).
  1147		  05 WS-STATE				PIC X.
  1148		  05 WS-TICKET-PASSED			PIC X(07).
  1149		  05 USERID.  1150		     10  USERID7			PIC X(7).
  1151		     10  FILLER 			PIC X(1).
  1152		  05 USR-TYPE.
  1153		    15 USR-REQUESTOR			PIC X.
  1154		    15 USR-ADMIN			PIC X.
  1155		    15 USR-APPROVER			PIC X.
  1156		    15 USR-SERVICE			PIC X.
  1157		  05 WS-SM012-STATE			PIC X.
  1158		  05 WS-SM012-PGMID			PIC X(06).
  1159		  05 WS-FLAG				PIC X(01).
  1160		  05 WS-CTL.
  1161		     10  WS-PAGE			PIC 9(02).
  1162		     10  WS-QNAME			PIC X(08).
  1163		     10  WS-QITEM			PIC S9(4) COMP.
  1164		     10  WS-QITEM-START 		PIC S9(4) COMP.
  1165		     10  WS-QITEM-END			PIC S9(4) COMP.
  1166		     10  WS-QITEM-PAGE			PIC S9(4) COMP.
  1167		     10  WS-CNT-UP			PIC 9(02) VALUE 0.
  1168		     10  WS-PAGE-X			PIC 9(02).
  1169		     10  WS-LASTPAGE			PIC 9(02).
  1170		     10  WS-COUNT-DISPLAY		PIC 9(02).
  1171		     10  FLAG-SEARCH			PIC X(01).
  1172		     10  WS-FLAG-VALID			PIC X(01).
  1173		  05 WS-BACKUP OCCURS 11.
  1174			 10  WS-B-UD			    PIC X(01).
  1175			 10  WS-B-REQ			    PIC X(01).
  1176			 10  WS-B-ADMN			    PIC X(01).
  1177			 10  WS-B-APP			    PIC X(01).
  1178			 10  WS-B-SP			    PIC X(01).
  1179	     *----------------------------------------------------------------*
  1180	     *				LINKAGE SECTION 		      *
  1181	     *----------------------------------------------------------------*
  1182	      LINKAGE SECTION.
  1184	      01  DFHEIBLK.						       R
  1185		  05 EIBTIME  PIC S9(7) COMP-3. 			       R
  1186		  05 EIBDATE  PIC S9(7) COMP-3. 			       R
  1187		  05 EIBTRNID PIC X(4). 				       R
  1188		  05 EIBTASKN PIC S9(7) COMP-3. 			       R
  1189		  05 EIBTRMID PIC X(4). 				       R
  1190		  05 DFHEIGDI PIC S9(4) COMP-4. 			       R
  1191		  05 EIBCPOSN PIC S9(4) COMP-4. 			       R
  1192		  05 EIBCALEN PIC S9(4) COMP-4. 			       R
  1193		  05 EIBAID   PIC X.					       R
  1194		  05 EIBFN    PIC X(2). 				       R
  1195		  05 EIBRCODE PIC X(6). 				       R
  1196		  05 EIBDS    PIC X(8). 				       R
  1197		  05 EIBREQID PIC X(8). 				       R
  1198		  05 EIBRSRCE PIC X(8). 				       R
  1199		  05 EIBSYNC  PIC X.					       R
  1200		  05 EIBFREE  PIC X.					       R
  1201		  05 EIBRECV  PIC X.					       R
  1202		  05 EIBSEND  PIC X.					       R
  1203		  05 EIBATT   PIC X.					       R
  1204		  05 EIBEOC   PIC X.					       R
  1205		  05 EIBFMH   PIC X.					       R
  1206		  05 EIBCOMPL PIC X.					       R
  1207		  05 EIBSIG   PIC X.					       R
  1208		  05 EIBCONF  PIC X.					       R
  1209		  05 EIBERR   PIC X.					       R
  1210		  05 EIBERRCD PIC X(4). 				       R  1211		  05 EIBSYNRB PIC X.					       R
  1212		  05 EIBNODAT PIC X.					       R
  1213		  05 EIBRESP  PIC S9(8) COMP-4. 			       R
  1214		  05 EIBRESP2 PIC S9(8) COMP-4. 			       R
  1215		  05 EIBRLDBK PIC X.					       R
  1216		  05 EIBCARESERVED PIC X(32).				       R
  1218	      01  DFHCOMMAREA.
  1219		  05 DF-PGMID				PIC X(06).
  1220		  05 DF-STATE				PIC X.
  1221		  05 DF-TICKET-PASSED			PIC X(07).
  1222		  05 DF-USERID.
  1223		     10  DF-USERID7			PIC X(7).
  1224		     10  FILLER 			PIC X(1).
  1225		  05 DF-USR-TYPE.
  1226		    15 DF-USR-REQUESTOR 		PIC X.
  1227		    15 DF-USR-ADMIN			PIC X.
  1228		    15 DF-USR-APPROVER			PIC X.
  1229		    15 DF-USR-SERVICE			PIC X.
  1230		  05 DF-SM012-STATE			PIC X.
  1231		  05 DF-SM012-PGMID			PIC X(06).
  1232		  05 DF-FLAG				PIC X(01).
  1233		  05 DF-CTL.
  1234		     10  DF-PAGE			PIC 9(02).
  1235		     10  DF-QNAME			PIC X(08).
  1236		     10  DF-QITEM			PIC S9(4) COMP.
  1237		     10  DF-QITEM-START 		PIC S9(4) COMP.
  1238		     10  DF-QITEM-END			PIC S9(4) COMP.
  1239		     10  DF-QITEM-PAGE			PIC S9(4) COMP.
  1240		     10  DF-CNT-UP			PIC 9(02).
  1241		     10  DF-PAGE-X			PIC 9(02).
  1242		     10  DF-LASTPAGE			PIC 9(02).
  1243		     10  DF-COUNT-DISPLAY		PIC 9(02).
  1244		     10  DF-FLAG-SEARCH 		PIC X(01).
  1245		     10  DF-FLAG-VALID			PIC X(01).
  1246		  05 DF-BACKUP OCCURS 11.
  1247			 10  DF-B-UD			    PIC X(01).
  1248			 10  DF-B-REQ			    PIC X(01).
  1249			 10  DF-B-ADMN			    PIC X(01).
  1250			 10  DF-B-APP			    PIC X(01).
  1251			 10  DF-B-SP			    PIC X(01).
  1252
  1253	      PROCEDURE DIVISION					       R
  1255		  USING DFHEIBLK DFHCOMMAREA.				       R
  1280	      100-PROCESS SECTION.
  1282		  EXEC CICS IGNORE CONDITION
  1283			    ERROR
  1284		  END-EXEC
  1299		  MOVE DFHCOMMAREA  TO WS-COMMAREA
  1300		  MOVE LENGTH OF UA001MI TO WS-LENGTH
  1301		  STRING EIBTRMID DELIMITED BY SIZE
  1302                       'UA01' DELIMITED BY SIZE
  1303			 INTO WS-QNAME
  1304		  END-STRING
  1305
  1306            IF WS-STATE  = 'A' OR 'B' OR 'C' OR  SPACE
  1307		     CONTINUE
  1308		  ELSE
  1309		     MOVE SPACE TO WS-STATE
  1310		  END-IF
  1311  1312		  MOVE LENGTH OF UA001MI TO WS-LENGTH
  1313
  1314            IF WS-PGMID = 'SM000' OR WS-PGMID = 'UA001' OR
  1315               WS-PGMID = 'UA002'
  1316               IF USR-ADMIN = 'Y'
  1317			IF WS-STATE = LOW-VALUES OR SPACE
  1318                      MOVE 'N' TO FLAG-SEARCH
  1319			    MOVE 1 TO WS-PAGE
  1320			    MOVE WS-PAGE TO PAGEO
  1321                      MOVE 'N' TO WS-FLAG-VALID
  1322			END-IF
  1323
  1324			PERFORM 1100-RMAP
  1325			PERFORM 3000-CHECK-AID
  1326			EVALUATE TRUE
  1327			    WHEN WS-STATE = SPACE
  1328			       PERFORM 2000-READ-TRANSFER-FILE
  1329			       PERFORM 2100-TSQ-DISPLAY
  1330
  1331                      WHEN WS-STATE = 'A'
  1332				CONTINUE
  1333
  1334                      WHEN WS-STATE = 'B'
  1335				CONTINUE
  1336
  1337                      WHEN WS-STATE = 'C'
  1338				CONTINUE
  1339			END-EVALUATE
  1340
  1341			PERFORM 3100-MSG-AID
  1342			MOVE WS-PAGE TO WS-PAGE-X
  1343			PERFORM 1000-NEW-MAP
  1344		     ELSE
  1346			 EXEC CICS SEND TEXT
  1347			    FROM (WS-INVALID-USER)
  1348			    LENGTH (+5)
  1349			    ERASE
  1350			 END-EXEC
  1381			 EXEC CICS RETURN
  1382			 END-EXEC
  1395		  ELSE
  1396		      PERFORM 110-INVALID
  1397		  END-IF.
  1398	      100-EXIT. EXIT.
  1399
  1400	      110-INVALID.
  1402		  EXEC CICS SEND TEXT
  1403		     FROM (WS-END)
  1404		     LENGTH (+15)
  1405		     ERASE
  1406		  END-EXEC
  1437		  EXEC CICS RETURN
  1438		  END-EXEC.
  1452	      110-EXIT. EXIT.
  1453
  1454
  1455	      1000-NEW-MAP.
  1457		  EXEC CICS ASSIGN
  1458		      USERID(USERID)
  1459		  END-EXEC  1477
  1479		  EXEC CICS ASKTIME
  1480		      ABSTIME  (WS-TIME)
  1481		  END-EXEC
  1499
  1501		  EXEC CICS FORMATTIME
  1502		      ABSTIME  (WS-TIME)
  1503                DATESEP  ('/')
  1504		      DDMMYYYY	 (DATEO)
  1505                TIMESEP    (':')
  1506		      TIME	 (TIMEO)
  1507		  END-EXEC
  1547
  1549		  EXEC CICS
  1550                SEND MAP ('UA001M')
  1551                MAPSET ('UA001S')
  1552		      FROM (UA001MO)
  1553		      LENGTH(WS-LENGTH)
  1554		      ERASE
  1555		  END-EXEC
  1597
  1599		  EXEC CICS RETURN
  1600                TRANSID('UA01')
  1601		      COMMAREA(WS-COMMAREA)
  1602		  END-EXEC.
  1627
  1628	      1000-EXIT. EXIT.
  1629
  1630	      1100-RMAP.
  1632		  EXEC CICS
  1633              RECEIVE MAP('UA001M')
  1634              MAPSET('UA001S')
  1635		    INTO (UA001MI)
  1636		  END-EXEC.
  1670	      1100-EXIT. EXIT.
  1671
  1672	      2000-READ-TRANSFER-FILE.
  1673		  MOVE LOW-VALUES TO WS-RID
  1675		  EXEC CICS
  1676                STARTBR FILE('UAF001')
  1677		      RIDFLD (WS-RID)
  1678		      GTEQ
  1679		  END-EXEC
  1706
  1708		  EXEC CICS
  1709                READNEXT FILE('UAF001')
  1710		      INTO (WS-REC)
  1711		      RIDFLD (WS-RID)
  1712		  END-EXEC
  1741
  1743		  EXEC CICS WRITEQ TS
  1744		      QUEUE (WS-QNAME)
  1745		      FROM (WS-REC)
  1746		      LENGTH (WS-RECB-LENGTH)
  1747		      ITEM (WS-QITEM)
  1748		  END-EXEC
  1783
  1784		  MOVE	  WS-QITEM TO WS-QITEM-START
  1785
  1787		  PERFORM UNTIL EIBRESP NOT = DFHRESP (NORMAL)  1789		  PERFORM UNTIL EIBRESP NOT =	       000		       R
  1790		      MOVE WS-QITEM TO WS-QITEM-END
  1792		      EXEC CICS
  1793                    READNEXT FILE('UAF001')
  1794			  INTO (WS-REC)
  1795			  RIDFLD (WS-RID)
  1796		      END-EXEC
  1825
  1827		      IF EIBRESP = DFHRESP (NORMAL)
  1829		      IF EIBRESP =	    000 			       R
  1831			  EXEC CICS WRITEQ TS
  1832			      QUEUE (WS-QNAME)
  1833			      FROM (WS-REC)
  1834			      LENGTH (WS-RECB-LENGTH)
  1835			      ITEM (WS-QITEM)
  1836			  END-EXEC
  1871			  MOVE WS-USERID7 TO WS-RID7
  1872			  MOVE HIGH-VALUES TO WS-RID1
  1873
  1874
  1875		      END-IF
  1876		  END-PERFORM
  1877
  1879		  EXEC CICS
  1880                ENDBR FILE('UAF001')
  1881		  END-EXEC
  1900		  PERFORM 2001-SET-LASTPAGE
  1901		  MOVE WS-QITEM-START TO WS-QITEM-PAGE.
  1902	      2000-EXIT. EXIT.
  1903
  1904	      2001-SET-LASTPAGE.
  1905		  SUBTRACT WS-QITEM-START FROM WS-QITEM-END GIVING
  1906			   WS-SUB-HOLDER
  1907
  1908		  DIVIDE WS-SUB-HOLDER	 BY 11 GIVING WS-LASTPAGE
  1909			  REMAINDER WS-REMAINDER
  1910
  1911	     *	  IF WS-REMAINDER NOT = 0
  1912		      ADD 1 TO WS-LASTPAGE.
  1913	     *	  END-IF.
  1914
  1915	      2001-EXIT. EXIT.
  1916
  1917	      2100-TSQ-DISPLAY.
  1918		  MOVE 0 TO WS-COUNT-DISPLAY
  1919		  MOVE WS-QITEM-PAGE TO WS-QITEM
  1921		  EXEC CICS READQ TS
  1922		      QUEUE(WS-QNAME)
  1923		      INTO (WS-REC)
  1924		      LENGTH(WS-RECB-LENGTH)
  1925		      ITEM (WS-QITEM)
  1926		  END-EXEC
  1961
  1962		  MOVE 1 TO WS-INDX
  1963
  1964		  PERFORM UNTIL WS-INDX > 11
  1966		      IF EIBRESP = DFHRESP (NORMAL) AND
  1968		      IF EIBRESP =	    000     AND 		       R
  1969			 WS-QITEM <= WS-QITEM-END
  1970  1971			  MOVE WS-UID TO UIDI(WS-INDX)
  1972			  MOVE WS-REQ TO REQI(WS-INDX)
  1973			  MOVE WS-ADMN TO ADMNI(WS-INDX)
  1974			  MOVE WS-APP TO APPI(WS-INDX)
  1975			  MOVE WS-SP TO SPI(WS-INDX)
  1976
  1977			  ADD 1 TO WS-COUNT-DISPLAY
  1978			  ADD 1 TO WS-QITEM
  1979
  1981			  EXEC CICS READQ TS
  1982			      QUEUE(WS-QNAME)
  1983			      INTO (WS-REC)
  1984			      LENGTH(WS-RECB-LENGTH)
  1985			      ITEM (WS-QITEM)
  1986			  END-EXEC
  2021		      ELSE
  2022
  2023
  2024			 MOVE SPACES TO UDI(WS-INDX)
  2025			 MOVE SPACES TO UIDI(WS-INDX)
  2026			 MOVE SPACES TO REQI(WS-INDX)
  2027			 MOVE SPACES TO ADMNI(WS-INDX)
  2028			 MOVE SPACES TO APPI(WS-INDX)
  2029			 MOVE SPACES TO SPI(WS-INDX)
  2030                   MOVE 'THIS IS THE LAST PAGE'  TO MSGO
  2031
  2032			 MOVE DFHBMPRO TO UDA(WS-INDX)
  2033			 MOVE DFHBMPRO TO UDA(WS-INDX)
  2034			 MOVE DFHBMPRO TO UIDA(WS-INDX)
  2035			 MOVE DFHBMPRO TO REQA(WS-INDX)
  2036			 MOVE DFHBMPRO TO ADMNA(WS-INDX)
  2037			 MOVE DFHBMPRO TO APPA(WS-INDX)
  2038			 MOVE DFHBMPRO TO SPA(WS-INDX)
  2039		      END-IF
  2040		      ADD 1 TO WS-INDX
  2041		  END-PERFORM.
  2042
  2043	      2100-EXIT. EXIT.
  2044
  2045
  2046
  2047
  2048	      3000-CHECK-AID.
  2049
  2050
  2051		  EVALUATE TRUE
  2052
  2053		      WHEN EIBAID = DFHENTER
  2054                    IF WS-STATE =  'A' AND WS-FLAG = 'N'
  2055			  IF PAGEO IS NUMERIC
  2056			      IF PAGEO =  WS-PAGE-X
  2057                            MOVE 'K' TO WS-FLAG
  2058			      ELSE
  2059				  MOVE PAGEI TO WS-PAGEI
  2060				  IF WS-PAGE-I > WS-LASTPAGE
  2061                                MOVE 'X' TO WS-FLAG
  2062				  END-IF
  2063
  2064                            IF WS-PAGE-I >= 1 AND WS-FLAG  = 'N'
  2065  2066				      SUBTRACT 1 FROM WS-PAGE-I
  2067					  GIVING WS-SUB-HOLDER
  2068
  2069				      IF WS-SUB-HOLDER = 0
  2070					  MOVE WS-QITEM-START TO WS-QITEM-PAGE
  2071				      END-IF
  2072
  2073				      IF WS-SUB-HOLDER	>= 1
  2074					  COMPUTE WS-QITEM-PAGE =
  2075					  WS-QITEM-PAGE + (WS-SUB-HOLDER * 11)
  2076				      END-IF
  2077
  2078                                MOVE 'O' TO WS-FLAG
  2079				  END-IF
  2080			      END-IF
  2081
  2082			      ELSE
  2083                            MOVE '1' TO WS-FLAG
  2084			      END-IF
  2085			  END-IF
  2086
  2087                    IF WS-STATE = 'B' AND WS-FLAG = 'N'
  2088			      MOVE SPACE TO WS-STATE
  2089                        MOVE 'N' TO WS-FLAG-VALID
  2090                        MOVE 'N' TO FLAG-SEARCH
  2091			      PERFORM 7400-RESET
  2092			  END-IF
  2093
  2094                    IF WS-STATE = 'A' AND WS-FLAG = 'Y' AND
  2095                        FLAG-SEARCH = 'Y'
  2096			      PERFORM 7200-CHECK-EDIT
  2097                        IF WS-FLAG-VALID = 'Y'
  2098                            MOVE 'B' TO WS-STATE
  2099                            MOVE 'N' TO WS-FLAG
  2100			      ELSE
  2101                            MOVE 'D' TO WS-FLAG
  2102			      END-IF
  2103			  END-IF
  2104
  2105                    IF WS-STATE = 'A' AND WS-FLAG = 'Y' AND
  2106                        FLAG-SEARCH = 'N'
  2107			      MOVE 1 TO WS-INDX
  2108                        MOVE 'Y' TO WS-FLAG-VALID
  2109	     ****insert validation
  2110                        IF WS-FLAG-VALID = 'Y'
  2111                            MOVE 'B' TO WS-STATE
  2112                            MOVE 'N' TO WS-FLAG
  2113			      ELSE
  2114                            MOVE 'D' TO WS-FLAG
  2115			      END-IF
  2116			  END-IF
  2117
  2118
  2119			  IF WS-STATE = SPACE AND WS-FLAG = NULL
  2120                        MOVE 'N' TO WS-FLAG
  2121			  END-IF
  2122
  2123		      WHEN EIBAID = DFHPF2
  2124                     MOVE 'UA001' TO WS-PGMID
  2125			   MOVE LOW-VALUES TO WS-STATE  2126			   MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  2128			   EXEC CICS XCTL
  2129                          PROGRAM('UA002')
  2130				COMMAREA(WS-COMMAREA)
  2131			   END-EXEC
  2155
  2156		      WHEN EIBAID = DFHPF3
  2157                      IF WS-PGMID = 'UA001'
  2158                         MOVE 'UA001' TO WS-PGMID
  2159			       MOVE LOW-VALUES TO WS-STATE
  2160			       MOVE LENGTH OF WS-COMMAREA TO WS-LENGTH
  2162			       EXEC CICS
  2163				   SEND CONTROL
  2164				   ERASE
  2165			       END-EXEC
  2185			       EXEC CICS DELETEQ TS
  2186				    QUEUE(WS-QNAME)
  2187			       END-EXEC
  2207			       EXEC CICS XCTL
  2208                              PROGRAM('SM000')
  2209				    COMMAREA(WS-COMMAREA)
  2210			       END-EXEC
  2234			    END-IF
  2235                      MOVE 'UA001' TO WS-PGMID
  2236
  2237
  2238		      WHEN EIBAID = DFHPF5
  2239                    MOVE 'N' TO WS-FLAG
  2240                    MOVE 'A' TO WS-STATE
  2241			  PERFORM 7000-FIND-SEARCH
  2242
  2243		      WHEN EIBAID = DFHPF7
  2244			  CONTINUE
  2245
  2246		      WHEN EIBAID = DFHPF8
  2247			  CONTINUE
  2248
  2249
  2250		      WHEN EIBAID = DFHPF12
  2252			  EXEC CICS DELETEQ TS
  2253			   QUEUE(WS-QNAME)
  2254			  END-EXEC
  2273
  2274		      WHEN EIBAID = DFHCLEAR
  2275			  CONTINUE
  2276
  2277		      WHEN OTHER
  2278			  CONTINUE
  2279		  END-EVALUATE.
  2280
  2281
  2282	      3000-EXIT. EXIT.
  2283
  2284
  2285	      3100-MSG-AID.
  2286
  2287		  EVALUATE TRUE
  2288
  2289		      WHEN EIBAID = DFHENTER
  2290                    IF WS-STATE = 'A' AND WS-FLAG = '1'  2291			      PERFORM 2100-TSQ-DISPLAY
  2292                        MOVE 'PAGE NUMBER ERROR. NUMERIC ONLY ' TO MSGO
  2293                        MOVE 'N' TO WS-FLAG
  2294			  END-IF
  2295
  2296                    IF WS-STATE = 'A' AND WS-FLAG = 'K' AND
  2297                      FLAG-SEARCH = 'N'
  2298			      PERFORM 4000-CHECK-UPDATE
  2299			  END-IF
  2300
  2301                    IF WS-STATE = SPACE AND WS-FLAG = 'N'
  2302                        MOVE 'A' TO WS-STATE
  2303			      PERFORM 2100-TSQ-DISPLAY
  2304			  END-IF
  2305
  2306
  2307
  2308                    IF WS-STATE = 'A' AND WS-FLAG = 'X'
  2309			      PERFORM 2100-TSQ-DISPLAY
  2310                        MOVE 'PAGE NUMBER INPUT ERROR. THE LASTPAGE IS '
  2311				 TO MSGO(01:41)
  2312			      MOVE WS-LASTPAGE TO MSGO(42:02)
  2313                        MOVE 'N' TO WS-FLAG
  2314			  END-IF
  2315
  2316                     IF WS-STATE = 'A' AND WS-FLAG = 'O'
  2317
  2318			      PERFORM 2100-TSQ-DISPLAY
  2319			      MOVE WS-PAGE-I TO WS-PAGE
  2320                        MOVE 'N' TO WS-FLAG
  2321			   END-IF
  2322
  2323       *             IF WS-STATE = 'A' AND WS-FLAG = 'Q'
  2324       *                 MOVE 'HIGHLIGHTED IS REQUIRED/HAS INVALID VALUE'
  2325	     *			TO MSGO
  2326       *                 MOVE 'N' TO WS-FLAG
  2327	     *		   END-IF
  2328
  2329                    IF WS-STATE = 'A' AND WS-FLAG = 'D'
  2330                        MOVE 'ERROR NO CHANGES'
  2331			       TO MSGO
  2332                        MOVE 'N' TO WS-FLAG
  2333			  END-IF
  2334
  2335                    IF WS-STATE = 'A' AND WS-FLAG = 'K' AND
  2336                         FLAG-SEARCH = 'Y'
  2337			      PERFORM 7100-SINGLE-CONFIRM
  2338			  END-IF
  2339
  2340                    IF WS-STATE = 'A' AND WS-FLAG = 'Y' AND
  2341                        FLAG-SEARCH = 'N'
  2342			      PERFORM 7500-PROTECT-FIELD
  2343                        MOVE 'PRESS ENTER AGAIN TO CONFIRM UPDATE'
  2344			       TO MSGO
  2345			  END-IF
  2346
  2347
  2348                    IF WS-STATE = 'A' AND WS-FLAG = 'Y' AND
  2349                        FLAG-SEARCH = 'Y'
  2350  2351			      MOVE 1 TO WS-INDX
  2352			      MOVE DFHBMPRF TO UDA(WS-INDX)
  2353			      MOVE DFHBMPRF TO UDA(WS-INDX)
  2354			      MOVE DFHBMPRF TO UIDA(WS-INDX)
  2355			      MOVE DFHBMPRF TO REQA(WS-INDX)
  2356			      MOVE DFHBMPRF TO ADMNA(WS-INDX)
  2357			      MOVE DFHBMPRF TO APPA(WS-INDX)
  2358			      MOVE DFHBMPRF TO SPA(WS-INDX)
  2359
  2360                        MOVE 'PRESS ENTER AGAIN TO CONFIRM UPDATE'
  2361			       TO MSGO
  2362			  END-IF
  2363
  2364                    IF WS-STATE = 'A' AND WS-FLAG = 'Q'
  2365                        MOVE 'HIGHLIGHTED IS REQUIRED/HAS INVALID VALUE'
  2366			       TO MSGO
  2367                        MOVE 'N' TO WS-FLAG
  2368			  END-IF
  2369
  2370                      IF WS-STATE = 'B' AND WS-FLAG = 'N' AND
  2371                            FLAG-SEARCH = 'Y'
  2372			      PERFORM 7300-UPDATE
  2373                        MOVE 'UPDATES POSTED, PRESS ENTER'
  2374			       TO MSGO
  2375			      MOVE 1 TO WS-INDX
  2376			      MOVE DFHBMPRF TO UDA(WS-INDX)
  2377			      MOVE DFHBMPRF TO UDA(WS-INDX)
  2378			      MOVE DFHBMPRF TO UIDA(WS-INDX)
  2379			      MOVE DFHBMPRF TO REQA(WS-INDX)
  2380			      MOVE DFHBMPRF TO ADMNA(WS-INDX)
  2381			      MOVE DFHBMPRF TO APPA(WS-INDX)
  2382			      MOVE DFHBMPRF TO SPA(WS-INDX)
  2383			    END-IF
  2384
  2385                      IF WS-STATE = 'B' AND WS-FLAG = 'N' AND
  2386                            FLAG-SEARCH = 'N'
  2387			      MOVE 1 TO WS-INDX
  2388			      PERFORM 7310-UPDATE-MULTIPLE UNTIL
  2389				  WS-INDX > WS-CNT-UP
  2390                        MOVE 'UPDATES POSTED, PRESS ENTER'
  2391			       TO MSGO
  2392			    END-IF
  2393
  2394
  2395		      WHEN EIBAID = DFHPF5
  2396                IF WS-STATE = 'A' AND WS-FLAG = 'N' AND FLAG-SEARCH = 'Y'
  2397                    MOVE 'RECORD FOUND' TO MSGO
  2398		      END-IF
  2399
  2400                IF WS-STATE = 'A' AND WS-FLAG = 'N' AND FLAG-SEARCH = 'N'
  2401                    MOVE 'RECORD NOT FOUND' TO MSGO
  2402		      END-IF
  2403
  2404
  2405		      WHEN EIBAID = DFHPF7
  2406			  SUBTRACT 11 FROM WS-QITEM-PAGE
  2407			  IF WS-QITEM-START = WS-QITEM-PAGE OR
  2408			     WS-QITEM-START > WS-QITEM-PAGE
  2409                        MOVE 'THIS IS THE FIRST PAGE' TO MSGO
  2410			      MOVE WS-QITEM-START TO WS-QITEM-PAGE  2411			      MOVE 1 TO WS-PAGE
  2412			  ELSE
  2413			      SUBTRACT 1 FROM WS-PAGE
  2414			  END-IF
  2415			  MOVE WS-PAGE TO PAGEO
  2416			  PERFORM 2100-TSQ-DISPLAY
  2417
  2418
  2419		      WHEN EIBAID = DFHPF8
  2420			  ADD 11 TO WS-QITEM-PAGE
  2421			  IF WS-QITEM-PAGE  > WS-QITEM-END
  2422			      SUBTRACT 11 FROM WS-QITEM-PAGE
  2423                        MOVE 'THIS IS THE LAST PAGE' TO MSGO
  2424			  ELSE
  2425			      ADD 1 TO WS-PAGE
  2426			  PERFORM 2100-TSQ-DISPLAY
  2427			  END-IF
  2428			  MOVE WS-PAGE TO PAGEO
  2429
  2430
  2431		      WHEN EIBAID = DFHCLEAR
  2432			  MOVE WS-PAGE TO PAGEO
  2433                    IF WS-STATE = 'A' AND WS-FLAG = 'N'
  2434			      PERFORM 2100-TSQ-DISPLAY
  2435                        MOVE 'INVALID PFKEY PRESSED' TO MSGO
  2436			  END-IF
  2437
  2438		      WHEN OTHER
  2439                    MOVE 'INVALID PFKEY PRESSED' TO MSGO
  2440		  END-EVALUATE.
  2441
  2442
  2443	      3100-EXIT. EXIT.
  2444
  2445	      4000-CHECK-UPDATE.
  2446
  2447		  MOVE 1 TO WS-INDX
  2448		  MOVE 0 TO WS-CNT-UP
  2449            MOVE 'Y' TO WS-FLAG
  2450
  2451		  PERFORM UNTIL WS-INDX > WS-COUNT-DISPLAY
  2452
  2453		      MOVE UDI(WS-INDX)   TO WS-B-UD(WS-INDX)
  2454		      MOVE REQI(WS-INDX)  TO WS-B-REQ(WS-INDX)
  2455		      MOVE ADMNI(WS-INDX) TO WS-B-ADMN(WS-INDX)
  2456		      MOVE APPI(WS-INDX)  TO WS-B-APP(WS-INDX)
  2457		      MOVE SPI(WS-INDX)   TO WS-B-SP(WS-INDX)
  2458
  2459
  2460			  ADD 1 TO WS-CNT-UP
  2461
  2462			  EVALUATE UDI(WS-INDX)
  2463                    WHEN 'U'
  2464			      PERFORM 4200-CHECK-ROLE
  2465                    WHEN 'D'
  2466			      CONTINUE
  2467                    WHEN '_'
  2468			      CONTINUE
  2469			  WHEN OTHER
  2470                        MOVE 'Q' TO WS-FLAG  2471			      PERFORM 4200-CHECK-ROLE
  2472			      MOVE  DFHUNIMD TO UDA(WS-INDX)
  2473			  END-EVALUATE
  2474
  2475
  2476		      ADD 1 TO WS-INDX
  2477		  END-PERFORM.
  2478
  2479	      4000-EXIT. EXIT.
  2480
  2481	      4100-DISPLAY-BACKUP.
  2482		  MOVE 1 TO WS-INDX
  2483		  PERFORM UNTIL  WS-INDX > 11
  2484		      MOVE WS-B-UD(WS-INDX)   TO UDI(WS-INDX)
  2485		      MOVE WS-B-REQ(WS-INDX)  TO REQI(WS-INDX)
  2486		      MOVE WS-B-ADMN(WS-INDX) TO ADMNI(WS-INDX)
  2487		      MOVE WS-B-APP(WS-INDX)  TO APPI(WS-INDX)
  2488		      MOVE WS-B-SP(WS-INDX)   TO SPI(WS-INDX)
  2489
  2490		      ADD 1 TO WS-INDX
  2491		  END-PERFORM.
  2492	      4100-EXIT. EXIT.
  2493
  2494	      4200-CHECK-ROLE.
  2495            IF REQI(WS-INDX) = 'Y' OR 'N'
  2496		      CONTINUE
  2497		  ELSE
  2498		      MOVE  DFHUNIMD TO REQA(WS-INDX)
  2499                MOVE 'Q' TO WS-FLAG
  2500		  END-IF
  2501
  2502            IF ADMNI(WS-INDX)  = 'Y' OR 'N'
  2503		      CONTINUE
  2504		  ELSE
  2505		      MOVE  DFHUNIMD TO ADMNA(WS-INDX)
  2506                MOVE 'Q' TO WS-FLAG
  2507		  END-IF
  2508
  2509            IF APPI(WS-INDX) = 'Y' OR 'N'
  2510		      CONTINUE
  2511		  ELSE
  2512		      MOVE  DFHUNIMD TO APPA(WS-INDX)
  2513                MOVE 'Q' TO WS-FLAG
  2514		  END-IF
  2515
  2516            IF SPI(WS-INDX) = 'Y' OR 'N'
  2517		      CONTINUE
  2518		  ELSE
  2519		      MOVE  DFHUNIMD TO SPA(WS-INDX)
  2520                MOVE 'Q' TO WS-FLAG
  2521		  END-IF.
  2522
  2523
  2524
  2525	      4200-EXIT. EXIT.
  2526
  2527
  2528
  2529	      7000-FIND-SEARCH.
  2530  2531	     *	   USERIDI- user input
  2532            MOVE 'N' TO  FLAG-SEARCH
  2533		  MOVE WS-QITEM-START TO WS-QITEM
  2534		  MOVE USERIDI TO WS-TEST
  2535            PERFORM UNTIL WS-QITEM > WS-QITEM-END OR FLAG-SEARCH = 'Y'
  2536
  2538		      EXEC CICS READQ TS
  2539			  QUEUE(WS-QNAME)
  2540			  INTO (WS-REC)
  2541			  LENGTH(WS-RECB-LENGTH)
  2542			  ITEM (WS-QITEM)
  2543		      END-EXEC
  2578
  2579		      IF WS-TEST = WS-UID
  2580                    MOVE 'Y' TO FLAG-SEARCH
  2581		      END-IF
  2582
  2583		      ADD 1 TO WS-QITEM
  2584
  2585		  END-PERFORM
  2586
  2587                IF FLAG-SEARCH = 'Y'
  2588
  2589			  MOVE 1 TO WS-INDX
  2590
  2591       *             MOVE '_'    TO UDI(WS-INDX)
  2592			  MOVE WS-UID TO UIDI(WS-INDX)
  2593			  MOVE WS-REQ TO REQI(WS-INDX)
  2594			  MOVE WS-ADMN TO ADMNI(WS-INDX)
  2595			  MOVE WS-APP TO APPI(WS-INDX)
  2596			  MOVE WS-SP TO SPI(WS-INDX)
  2597
  2598			  MOVE UDI(WS-INDX)   TO WS-B-UD(WS-INDX)
  2599			  MOVE REQI(WS-INDX)  TO WS-B-REQ(WS-INDX)
  2600			  MOVE ADMNI(WS-INDX) TO WS-B-ADMN(WS-INDX)
  2601			  MOVE APPI(WS-INDX)  TO WS-B-APP(WS-INDX)
  2602			  MOVE SPI(WS-INDX)   TO WS-B-SP(WS-INDX)
  2603
  2604
  2605			  ADD 1 TO WS-INDX
  2606
  2607			  PERFORM UNTIL WS-INDX > 11
  2608
  2609			      MOVE SPACE TO UDI(WS-INDX)
  2610			      MOVE SPACE TO UIDI(WS-INDX)
  2611			      MOVE SPACE TO REQI(WS-INDX)
  2612			      MOVE SPACE TO ADMNI(WS-INDX)
  2613			      MOVE SPACE TO APPI(WS-INDX)
  2614			      MOVE SPACE TO SPI(WS-INDX)
  2615
  2616
  2617			      MOVE DFHBMPRO TO UDA(WS-INDX)
  2618			      MOVE DFHBMPRO TO UIDA(WS-INDX)
  2619			      MOVE DFHBMPRO TO REQA(WS-INDX)
  2620			      MOVE DFHBMPRO TO ADMNA(WS-INDX)
  2621			      MOVE DFHBMPRO TO APPA(WS-INDX)
  2622			      MOVE DFHBMPRO TO SPA(WS-INDX)
  2623
  2624			      ADD 1 TO WS-INDX
  2625			  END-PERFORM  2626		      END-IF.
  2627
  2628	      7000-EXIT. EXIT.
  2629
  2630	      7100-SINGLE-CONFIRM.
  2631
  2632            MOVE 'Y' TO WS-FLAG
  2633		  MOVE 1 TO WS-INDX
  2634
  2635		  EVALUATE UDI(WS-INDX)
  2636                    WHEN 'U'
  2637			      PERFORM 4200-CHECK-ROLE
  2638                    WHEN 'D'
  2639			      CONTINUE
  2640                    WHEN '_'
  2641                        MOVE 'Q' TO WS-FLAG
  2642			      MOVE  DFHUNIMD TO UDA(WS-INDX)
  2643			  WHEN OTHER
  2644                        MOVE 'Q' TO WS-FLAG
  2645			      MOVE  DFHUNIMD TO UDA(WS-INDX)
  2646		  END-EVALUATE.
  2647
  2648
  2649	      7100-EXIT. EXIT.
  2650
  2651	      7200-CHECK-EDIT.
  2652
  2653		  MOVE 1 TO WS-INDX
  2654            MOVE 'N' TO WS-FLAG-VALID
  2655
  2656		  IF REQI(WS-INDX) = WS-B-REQ(WS-INDX)
  2657		      CONTINUE
  2658		  ELSE
  2659                MOVE 'Y' TO WS-FLAG-VALID
  2660		  END-IF
  2661
  2662		  IF ADMNI(WS-INDX) = WS-B-ADMN(WS-INDX)
  2663		      CONTINUE
  2664		  ELSE
  2665                MOVE 'Y' TO WS-FLAG-VALID
  2666		  END-IF
  2667
  2668		  IF APPI(WS-INDX) = WS-B-APP(WS-INDX)
  2669		      CONTINUE
  2670		  ELSE
  2671                MOVE 'Y' TO WS-FLAG-VALID
  2672		  END-IF
  2673
  2674		  IF SPI(WS-INDX) = WS-B-SP(WS-INDX)
  2675		      CONTINUE
  2676		  ELSE
  2677               MOVE 'Y' TO WS-FLAG-VALID
  2678		  END-IF
  2679
  2680		  MOVE UIDI(WS-INDX) TO WS-IDD.
  2681
  2682	      7200-EXIT. EXIT.
  2683
  2684	      7210-CHECK-EDIT.
  2685  2686		  IF REQI(WS-INDX) = WS-B-REQ(WS-INDX)
  2687		      CONTINUE
  2688		  ELSE
  2689                MOVE 'Y' TO WS-FLAG-VALID
  2690		  END-IF
  2691
  2692		  IF ADMNI(WS-INDX) = WS-B-ADMN(WS-INDX)
  2693		      CONTINUE
  2694		  ELSE
  2695                MOVE 'Y' TO WS-FLAG-VALID
  2696		  END-IF
  2697
  2698		  IF APPI(WS-INDX) = WS-B-APP(WS-INDX)
  2699		      CONTINUE
  2700		  ELSE
  2701                MOVE 'Y' TO WS-FLAG-VALID
  2702		  END-IF
  2703
  2704		  IF SPI(WS-INDX) = WS-B-SP(WS-INDX)
  2705		      CONTINUE
  2706		  ELSE
  2707               MOVE 'Y' TO WS-FLAG-VALID
  2708		  END-IF
  2709
  2710		  MOVE UIDI(WS-INDX) TO WS-IDD.
  2711
  2712		  ADD 1 TO WS-INDX.
  2713	      7210-EXIT. EXIT.
  2714
  2715
  2716
  2717	      7300-UPDATE.
  2718
  2719		  EVALUATE UDI(WS-INDX)
  2720                    WHEN 'U'
  2722			      EXEC CICS
  2723                            READ FILE('UAF001')
  2724				  INTO (WS-REC)
  2725				  RIDFLD (WS-IDD)
  2726				  EQUAL
  2727				  UPDATE
  2728				  RESP(WS-RETNCODE)
  2729			      END-EXEC
  2770
  2771			      MOVE REQI(WS-INDX) TO WS-REQ
  2772				      MOVE ADMNI(WS-INDX) TO WS-ADMN
  2773				      MOVE APPI(WS-INDX) TO WS-APP
  2774				      MOVE SPI(WS-INDX) TO WS-SP
  2775			      MOVE USERID TO WS-UPBY
  2776
  2778			      EXEC CICS
  2779                                    REWRITE FILE ('UA001')
  2780					  FROM (WS-REC)
  2781				  RESP(WS-RETNCODE)
  2782				      END-EXEC
  2812
  2813
  2814                    WHEN 'D'
  2816			      EXEC CICS
  2817                            READ FILE('UA002')  2818				  INTO (WS-REC)
  2819				  RIDFLD (WS-IDD)
  2820						  EQUAL
  2821				  UPDATE
  2822			      END-EXEC
  2858			      EXEC CICS
  2859                                DELETE FILE('UA002')
  2860			      END-EXEC
  2879
  2880		  END-EVALUATE.
  2881
  2882
  2883	      7300-EXIT. EXIT.
  2884
  2885	      7310-UPDATE-MULTIPLE.
  2886
  2887		  MOVE UIDI(WS-INDX)  TO WS-IDD
  2888		  EVALUATE UDI(WS-INDX)
  2889                    WHEN 'U'
  2891			      EXEC CICS
  2892                            READ FILE('UAF001')
  2893				  INTO (WS-REC)
  2894				  RIDFLD (WS-IDD)
  2895				  EQUAL
  2896				  UPDATE
  2897				  RESP(WS-RETNCODE)
  2898			      END-EXEC
  2939
  2940			      MOVE REQI(WS-INDX) TO WS-REQ
  2941				      MOVE ADMNI(WS-INDX) TO WS-ADMN
  2942				      MOVE APPI(WS-INDX) TO WS-APP
  2943				      MOVE SPI(WS-INDX) TO WS-SP
  2944			      MOVE USERID TO WS-UPBY
  2945
  2947			      EXEC CICS
  2948                                    REWRITE FILE ('UA001')
  2949					  FROM (WS-REC)
  2950				  RESP(WS-RETNCODE)
  2951				      END-EXEC
  2981
  2982
  2983                    WHEN 'D'
  2985			      EXEC CICS
  2986                            READ FILE('UA002')
  2987				  INTO (WS-REC)
  2988				  RIDFLD (WS-IDD)
  2989						  EQUAL
  2990				  UPDATE
  2991			      END-EXEC
  3027			      EXEC CICS
  3028                                DELETE FILE('UA002')
  3029			      END-EXEC
  3048
  3049		  END-EVALUATE
  3050		      MOVE DFHBMPRF TO UDA(WS-INDX)
  3051		      MOVE DFHBMPRF TO UDA(WS-INDX)
  3052		      MOVE DFHBMPRF TO UIDA(WS-INDX)
  3053		      MOVE DFHBMPRF TO REQA(WS-INDX)
  3054		      MOVE DFHBMPRF TO ADMNA(WS-INDX)
  3055		      MOVE DFHBMPRF TO APPA(WS-INDX)  3056		      MOVE DFHBMPRF TO SPA(WS-INDX)
  3057
  3058		      ADD 1 TO WS-INDX.
  3059	      7310-EXIT. EXIT.
  3060
  3061	      7400-RESET.
  3062		  MOVE 1 TO WS-INDX
  3063		    MOVE SPACE TO  USERIDI
  3064		  PERFORM UNTIL WS-INDX > 11
  3065              MOVE '_' TO UDI(WS-INDX)
  3066			    MOVE NULL TO UDA(WS-INDX)
  3067				MOVE NULL TO REQA(WS-INDX)
  3068			MOVE NULL TO ADMNA(WS-INDX)
  3069			    MOVE NULL TO APPA(WS-INDX)
  3070				MOVE NULL TO SPA(WS-INDX)
  3071			    ADD 1 TO WS-INDX
  3072		  END-PERFORM.
  3073	      7400-EXIT. EXIT.
  3074
  3075	      7500-PROTECT-FIELD.
  3076
  3077		  MOVE 1 TO WS-INDX
  3078		  PERFORM UNTIL WS-INDX > WS-CNT-UP
  3079		      MOVE DFHBMPRF TO UDA(WS-INDX)
  3080		      MOVE DFHBMPRF TO UDA(WS-INDX)
  3081		      MOVE DFHBMPRF TO UIDA(WS-INDX)
  3082		      MOVE DFHBMPRF TO REQA(WS-INDX)
  3083		      MOVE DFHBMPRF TO ADMNA(WS-INDX)
  3084		      MOVE DFHBMPRF TO APPA(WS-INDX)
  3085		      MOVE DFHBMPRF TO SPA(WS-INDX)
  3086		      ADD 1 TO WS-INDX
  3087		  END-PERFORM.
  3088	      7500-EXIT. EXIT.CA-Realia COBOL Version 6.0.45	 D:\work\CAWB30-HO\UA001.cic	       PAGE   36



			Realia COBOL Compiler Version Information

			      Pass 1	 Version 6.072
			      Pass 1a	 Version 6.015
			      Pass 2	 Version 6.068
			      Pass 2a	 Version 6.020
			      Pass 3	 Version 6.094
			      Pass 4	 Version 6.007
			      Pass 5	 Version 6.022


			Compilation Directives in Effect

COMP-4		  DCHK		    OPT 	      NOCALL
NOSUBCHK	  STRCHK	    NOTRUNC	      NOSMALLCOMP
NODCALL 	  NODIVZERO	    NOEPDCALL	      APOST
EBCDIC		  STATABORT	    NOMOVELINK	      NOBLL4K
ARGCHK		  UPLOW 	    NOVERARG	      MDY
LP:   60	  PP		    FCREATE	      NOIEEE
NOLILIAN	  CURRENCY-SIGN=$   WRITEAFTER	      SOSI
NOCOPY68	  NOFLAG-COM	    NOFLAG-SEG	      NOFLAG-FIPS
DEBUGXREF	  DIALECT-VS2

			Error level limit: W

			Source lines compiled:	    3099
			Compilation time (mm:ss.ss):  0:00.06
			Compilation speed (lines/minute): 99000

			Compilation date (yy/mm/dd): 23/12/06
			     Time of day (hh:mm:ss): 22:23:55